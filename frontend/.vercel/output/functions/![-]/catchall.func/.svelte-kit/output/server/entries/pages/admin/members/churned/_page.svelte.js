import{s as h,k as W,at as T,c1 as k,a1 as V,c2 as z,bQ as w,r as m,J as S,e,b$ as A,bN as B,a4 as E,c as n,F as N,aX as H,d as G,a as g,f,ah as I,c0 as Q,aa as J,u as X}from"../../../../../chunks/vendor-svelte.js";import"@sveltejs/kit/internal";import"@sveltejs/kit/internal/server";import{c as o}from"../../../../../chunks/members.js";function Z(C,Y){C.component(t=>{var c;let b=h(c??={},"$churnedStore",o).members,v=h(c??={},"$churnedStore",o).stats,i=h(c??={},"$churnedStore",o).pagination,x=h(c??={},"$churnedStore",o).loading,D="",p="",d="",u=new Set;async function P(s){p=s,await o.setFilters({winback_potential:s})}async function F(s){d=s,await o.setFilters({churned_within_days:s?Number(s):void 0})}function _(s){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s)}function L(s){return s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-"}function M(s){return s.first_name&&s.last_name?`${s.first_name[0]}${s.last_name[0]}`.toUpperCase():s.name?.slice(0,2).toUpperCase()||"U"}function y(s){return s>=500?"high":s>=100?"medium":"low"}function U(s){return s>=500?"High Value":s>=100?"Medium Value":"Low Value"}if(W("1340tb4",t,s=>{s.title(a=>{a.push("<title>Win-Back Center | Revolution Trading Pros</title>")})}),t.push('<div class="churned-page svelte-1340tb4"><div class="page-header"><button class="back-btn svelte-1340tb4">'),T(t,{size:20}),t.push('<!----> Back to Members</button> <div class="header-content svelte-1340tb4"><div class="header-title svelte-1340tb4"><div class="title-icon svelte-1340tb4">'),k(t,{size:32}),t.push('<!----></div> <div><h1 class="svelte-1340tb4">Win-Back Center</h1> <p class="svelte-1340tb4">Re-engage past members with targeted campaigns</p></div></div> <button class="btn-refresh svelte-1340tb4">'),V(t,{size:18}),t.push('<!----> Refresh</button></div></div> <div class="campaign-actions svelte-1340tb4"><button class="campaign-card free-trial svelte-1340tb4"><div class="campaign-icon svelte-1340tb4">'),z(t,{size:28}),t.push('<!----></div> <div class="campaign-content svelte-1340tb4"><h3 class="svelte-1340tb4">30 Days Free</h3> <p class="svelte-1340tb4">Win back with a free trial offer</p></div> <span class="campaign-tag svelte-1340tb4">Popular</span></button> <button class="campaign-card promo svelte-1340tb4"><div class="campaign-icon svelte-1340tb4">'),w(t,{size:28}),t.push('<!----></div> <div class="campaign-content svelte-1340tb4"><h3 class="svelte-1340tb4">50% Discount</h3> <p class="svelte-1340tb4">Exclusive comeback offer</p></div></button> <button class="campaign-card winback svelte-1340tb4"><div class="campaign-icon svelte-1340tb4">'),m(t,{size:28}),t.push('<!----></div> <div class="campaign-content svelte-1340tb4"><h3 class="svelte-1340tb4">We Miss You</h3> <p class="svelte-1340tb4">Personal reconnection email</p></div></button></div> '),v?(t.push("<!--[-->"),t.push('<div class="stats-grid svelte-1340tb4"><div class="stat-card svelte-1340tb4"><div class="stat-header svelte-1340tb4">'),S(t,{size:24}),t.push(`<!----> <span class="stat-label svelte-1340tb4">Total Churned</span></div> <div class="stat-value svelte-1340tb4">${e(v.total_churned)}</div> <div class="stat-sublabel svelte-1340tb4">`),A(t,{size:14}),t.push(`<!----> ${e(v.churned_this_month)} this month</div></div> <div class="stat-card recovery svelte-1340tb4"><div class="stat-header svelte-1340tb4">`),w(t,{size:24}),t.push(`<!----> <span class="stat-label svelte-1340tb4">Recovery Potential</span></div> <div class="stat-value svelte-1340tb4">${e(_(v.potential_recovery_revenue))}</div> <div class="stat-sublabel svelte-1340tb4">`),B(t,{size:14}),t.push('<!----> Estimated monthly recovery</div></div> <div class="stat-card svelte-1340tb4"><div class="stat-header svelte-1340tb4">'),S(t,{size:24}),t.push(`<!----> <span class="stat-label svelte-1340tb4">Top Churn Reason</span></div> <div class="stat-value churn-reason svelte-1340tb4">${e(v.top_churn_reasons?.[0]?.reason?.replace(/"/g,"")||"Unknown")}</div> <div class="stat-sublabel svelte-1340tb4">${e(v.top_churn_reasons?.[0]?.count||0)} occurrences</div></div></div>`)):t.push("<!--[!-->"),t.push('<!--]--> <div class="toolbar svelte-1340tb4"><div class="search-box svelte-1340tb4">'),E(t,{size:18}),t.push(`<!----> <input id="search-churned-members" type="text" placeholder="Search churned members..."${n("value",D)} class="svelte-1340tb4"/></div> <div class="filters svelte-1340tb4"><div class="filter-group svelte-1340tb4">`),N(t,{size:16}),t.push("<!----> "),t.select({value:p,onchange:()=>P(p),class:""},s=>{s.option({value:""},a=>{a.push("All Value")}),s.option({value:"high"},a=>{a.push("High Value ($500+)")}),s.option({value:"medium"},a=>{a.push("Medium ($100-$500)")}),s.option({value:"low"},a=>{a.push("Low (&lt;$100)")})},"svelte-1340tb4"),t.push('</div> <div class="filter-group svelte-1340tb4">'),H(t,{size:16}),t.push("<!----> "),t.select({value:d,onchange:()=>F(d),class:""},s=>{s.option({value:""},a=>{a.push("Any Time")}),s.option({value:"7"},a=>{a.push("Last 7 days")}),s.option({value:"30"},a=>{a.push("Last 30 days")}),s.option({value:"90"},a=>{a.push("Last 90 days")}),s.option({value:"180"},a=>{a.push("Last 6 months")})},"svelte-1340tb4"),t.push("</div></div> "),u.size>0?(t.push("<!--[-->"),t.push('<button class="btn-email svelte-1340tb4">'),m(t,{size:18}),t.push(`<!----> Email Selected (${e(u.size)})</button>`)):t.push("<!--[!-->"),t.push('<!--]--></div> <div class="members-table-container svelte-1340tb4">'),x)t.push("<!--[-->"),t.push('<div class="loading-state svelte-1340tb4"><div class="loader svelte-1340tb4"></div> <p>Loading churned members...</p></div>');else{if(t.push("<!--[!-->"),b.length===0)t.push("<!--[-->"),t.push('<div class="empty-state svelte-1340tb4">'),k(t,{size:64,stroke:1}),t.push('<!----> <h3 class="svelte-1340tb4">No churned members</h3> <p>Great news! No members have churned matching your filters.</p></div>');else{t.push("<!--[!-->"),t.push(`<table class="members-table svelte-1340tb4"><thead class="svelte-1340tb4"><tr><th class="checkbox-col svelte-1340tb4"><input type="checkbox"${n("checked",u.size===b.length&&b.length>0,!0)} aria-label="Select all churned members" class="svelte-1340tb4"/></th><th class="svelte-1340tb4">Member</th><th class="svelte-1340tb4">Win-Back Potential</th><th class="svelte-1340tb4">Last Product</th><th class="svelte-1340tb4">Total Spent</th><th class="svelte-1340tb4">Churned</th><th class="svelte-1340tb4">Reason</th><th class="svelte-1340tb4">Actions</th></tr></thead><tbody class="svelte-1340tb4"><!--[-->`);const s=G(b);for(let a=0,R=s.length;a<R;a++){let l=s[a];t.push(`<tr${g("svelte-1340tb4",void 0,{selected:u.has(l.id)})}><td class="checkbox-col svelte-1340tb4"><input type="checkbox"${n("checked",u.has(l.id),!0)}${n("aria-label",`Select ${f(l.name)}`)} class="svelte-1340tb4"/></td><td class="svelte-1340tb4"><div class="member-info svelte-1340tb4"><div class="member-avatar churned svelte-1340tb4">${e(M(l))}</div> <div class="member-details"><div class="member-name svelte-1340tb4">${e(l.name)}</div> <div class="member-email svelte-1340tb4">${e(l.email)}</div></div></div></td><td class="svelte-1340tb4"><span${g(`potential-badge ${f(y(l.total_spent))}`,"svelte-1340tb4")}>${e(U(l.total_spent))}</span></td><td class="svelte-1340tb4"><span class="product-name svelte-1340tb4">${e(l.last_product||"-")}</span></td><td class="svelte-1340tb4"><span${g(`spending ${f(y(l.total_spent))}`,"svelte-1340tb4")}>${e(_(l.total_spent))}</span></td><td class="svelte-1340tb4"><div class="churn-date svelte-1340tb4"><span class="date svelte-1340tb4">${e(L(l.churned_at))}</span> `),l.days_since_churn?(t.push("<!--[-->"),t.push(`<span class="days-ago svelte-1340tb4">${e(l.days_since_churn)}d ago</span>`)):t.push("<!--[!-->"),t.push(`<!--]--></div></td><td class="svelte-1340tb4"><span class="churn-reason-text svelte-1340tb4">${e(l.churn_reason||"Unknown")}</span></td><td class="svelte-1340tb4"><div class="actions svelte-1340tb4"><button class="action-btn winback svelte-1340tb4" title="Start Win-Back">`),z(t,{size:16}),t.push('<!----></button> <button class="action-btn svelte-1340tb4" title="Send Email">'),m(t,{size:16}),t.push('<!----></button> <button class="action-btn svelte-1340tb4" title="View Details">'),I(t,{size:16}),t.push("<!----></button></div></td></tr>")}t.push("<!--]--></tbody></table> "),i?(t.push("<!--[-->"),t.push(`<div class="pagination svelte-1340tb4"><div class="pagination-info svelte-1340tb4">Showing ${e((i.current_page-1)*i.per_page+1)} to ${e(Math.min(i.current_page*i.per_page,i.total))} of ${e(i.total)}</div> <div class="pagination-controls svelte-1340tb4"><button class="page-btn svelte-1340tb4"${n("disabled",i.current_page===1,!0)}>`),Q(t,{size:18}),t.push(`<!----></button> <span class="page-indicator svelte-1340tb4">Page ${e(i.current_page)} of ${e(i.last_page)}</span> <button class="page-btn svelte-1340tb4"${n("disabled",i.current_page===i.last_page,!0)}>`),J(t,{size:18}),t.push("<!----></button></div></div>")):t.push("<!--[!-->"),t.push("<!--]-->")}t.push("<!--]-->")}t.push("<!--]--></div></div> "),t.push("<!--[!-->"),t.push("<!--]-->"),c&&X(c)})}export{Z as default};
