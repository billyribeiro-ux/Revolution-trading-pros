import{k as I,at as V,v as N,aX as Q,a1 as P,a0 as X,d,e as l,y as Z,w as q,a as u,f as n,au as M,b$ as x,bQ as H,af as U,b as C,c as y,aG as w}from"../../../../../chunks/vendor-svelte.js";import"@sveltejs/kit/internal";import"@sveltejs/kit/internal/server";function Y(E,J){E.component(s=>{let z=!0,r="30d",j=!1,R=null,A=!1,b={totalMembers:null,memberGrowth:null,mrr:null,mrrGrowth:null,churnRate:null,churnChange:null,avgLtv:null,ltvGrowth:null},_=[],D=[],o=[],S=[],T=[];async function B(){z=!0,R=null;try{const[a,i,h,p,g,f]=await Promise.allSettled([fetch(`/api/admin/members/analytics/metrics?range=${r}`),fetch(`/api/admin/members/analytics/growth?range=${r}`),fetch(`/api/admin/members/analytics/cohorts?range=${r}`),fetch(`/api/admin/members/analytics/revenue?range=${r}`),fetch(`/api/admin/members/analytics/churn-reasons?range=${r}`),fetch(`/api/admin/members/analytics/segments?range=${r}`)]);let v=!1;if(a.status==="fulfilled"&&a.value.ok){const e=await a.value.json();e&&typeof e.totalMembers=="number"&&(b=e,v=!0)}if(i.status==="fulfilled"&&i.value.ok){const e=await i.value.json();Array.isArray(e)&&e.length>0&&(_=e,v=!0)}if(h.status==="fulfilled"&&h.value.ok){const e=await h.value.json();Array.isArray(e)&&e.length>0&&(D=e,v=!0)}if(p.status==="fulfilled"&&p.value.ok){const e=await p.value.json();Array.isArray(e)&&e.length>0&&(o=e,v=!0)}if(g.status==="fulfilled"&&g.value.ok){const e=await g.value.json();Array.isArray(e)&&e.length>0&&(S=e,v=!0)}if(f.status==="fulfilled"&&f.value.ok){const e=await f.value.json();Array.isArray(e)&&e.length>0&&(T=e,v=!0)}j=v,A=v,v||(R="Member analytics data is not available. Ensure your analytics service is connected and configured.")}catch{j=!1,A=!1,R="Failed to connect to analytics service. Please check your connection settings."}finally{z=!1}}function G(a){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(a)}function F(a){return new Intl.NumberFormat("en-US").format(a)}function k(a){return a===0?"bg-slate-800/50":a>=90?"bg-emerald-500/60":a>=80?"bg-emerald-500/40":a>=70?"bg-yellow-500/40":a>=60?"bg-orange-500/40":"bg-red-500/40"}function L(a){return Math.max(...a)}if(I("1umk7bb",s,a=>{a.title(i=>{i.push("<title>Member Analytics | Revolution Trading Pros</title>")})}),s.push('<div class="analytics-page svelte-1umk7bb"><div class="page-header svelte-1umk7bb"><button class="back-btn svelte-1umk7bb">'),V(s,{size:20}),s.push('<!----> Back to Members</button> <div class="header-content svelte-1umk7bb"><div class="header-title svelte-1umk7bb"><div class="title-icon svelte-1umk7bb">'),N(s,{size:28}),s.push('<!----></div> <div class="svelte-1umk7bb"><h1 class="svelte-1umk7bb">Member Analytics</h1> <p class="subtitle svelte-1umk7bb">Comprehensive insights and metrics</p></div></div> <div class="header-actions svelte-1umk7bb"><div class="date-filter svelte-1umk7bb">'),Q(s,{size:18}),s.push("<!----> "),s.select({value:r,onchange:B,class:""},a=>{a.option({value:"7d",class:""},i=>{i.push("Last 7 days")},"svelte-1umk7bb"),a.option({value:"30d",class:""},i=>{i.push("Last 30 days")},"svelte-1umk7bb"),a.option({value:"90d",class:""},i=>{i.push("Last 90 days")},"svelte-1umk7bb"),a.option({value:"12m",class:""},i=>{i.push("Last 12 months")},"svelte-1umk7bb")},"svelte-1umk7bb"),s.push('</div> <button class="btn-secondary svelte-1umk7bb">'),P(s,{size:18}),s.push('<!----> Refresh</button> <button class="btn-primary svelte-1umk7bb">'),X(s,{size:18}),s.push("<!----> Export Report</button></div></div></div> "),z){s.push("<!--[-->"),s.push('<div class="loading-grid svelte-1umk7bb"><!--[-->');const a=d([1,2,3,4]);for(let i=0,h=a.length;i<h;i++)a[i],s.push('<div class="skeleton skeleton-metric svelte-1umk7bb"></div>');s.push('<!--]--></div> <div class="skeleton skeleton-chart svelte-1umk7bb"></div>')}else{if(s.push("<!--[!-->"),!A||R)s.push("<!--[-->"),s.push('<div class="not-connected-state svelte-1umk7bb"><div class="not-connected-card svelte-1umk7bb"><div class="not-connected-icon svelte-1umk7bb">'),N(s,{size:40}),s.push(`<!----></div> <h2 class="svelte-1umk7bb">Member Analytics Not Available</h2> <p class="svelte-1umk7bb">${l(R||"Connect your analytics service to view real member metrics, growth data, and churn analysis.")}</p> <div class="not-connected-actions svelte-1umk7bb"><a href="/admin/connections" class="btn-connect svelte-1umk7bb">`),Z(s,{size:18}),s.push('<!----> Connect Analytics</a> <button class="btn-retry svelte-1umk7bb">'),P(s,{size:18}),s.push('<!----> Retry</button></div> <div class="analytics-features svelte-1umk7bb"><h3 class="svelte-1umk7bb">Available when connected:</h3> <ul class="svelte-1umk7bb"><li class="svelte-1umk7bb">Real-time member metrics &amp; growth trends</li> <li class="svelte-1umk7bb">Monthly Recurring Revenue (MRR) tracking</li> <li class="svelte-1umk7bb">Cohort retention analysis</li> <li class="svelte-1umk7bb">Churn reason insights</li> <li class="svelte-1umk7bb">Segment performance breakdowns</li></ul></div></div></div>');else{s.push("<!--[!-->"),s.push('<div class="metrics-grid svelte-1umk7bb"><div class="metric-card svelte-1umk7bb"><div class="metric-header svelte-1umk7bb"><div class="metric-icon purple svelte-1umk7bb">'),q(s,{size:24}),s.push(`<!----></div> <div${u(`metric-trend ${n(b.memberGrowth>=0?"positive":"negative")}`,"svelte-1umk7bb")}>`),b.memberGrowth>=0?(s.push("<!--[-->"),M(s,{size:16})):(s.push("<!--[!-->"),x(s,{size:16})),s.push(`<!--]--> ${l(Math.abs(b.memberGrowth))}%</div></div> <div class="metric-value svelte-1umk7bb">${l(F(b.totalMembers))}</div> <div class="metric-label svelte-1umk7bb">Total Members</div></div> <div class="metric-card svelte-1umk7bb"><div class="metric-header svelte-1umk7bb"><div class="metric-icon emerald svelte-1umk7bb">`),H(s,{size:24}),s.push(`<!----></div> <div${u(`metric-trend ${n(b.mrrGrowth>=0?"positive":"negative")}`,"svelte-1umk7bb")}>`),b.mrrGrowth>=0?(s.push("<!--[-->"),M(s,{size:16})):(s.push("<!--[!-->"),x(s,{size:16})),s.push(`<!--]--> ${l(Math.abs(b.mrrGrowth))}%</div></div> <div class="metric-value svelte-1umk7bb">${l(G(b.mrr))}</div> <div class="metric-label svelte-1umk7bb">Monthly Recurring Revenue</div></div> <div class="metric-card svelte-1umk7bb"><div class="metric-header svelte-1umk7bb"><div${u(`metric-icon ${n(b.churnChange<=0?"emerald":"red")}`,"svelte-1umk7bb")}>`),U(s,{size:24}),s.push(`<!----></div> <div${u(`metric-trend ${n(b.churnChange<=0?"positive":"negative")}`,"svelte-1umk7bb")}>`),b.churnChange<=0?(s.push("<!--[-->"),x(s,{size:16})):(s.push("<!--[!-->"),M(s,{size:16})),s.push(`<!--]--> ${l(Math.abs(b.churnChange))}%</div></div> <div class="metric-value svelte-1umk7bb">${l(b.churnRate)}%</div> <div class="metric-label svelte-1umk7bb">Churn Rate</div></div> <div class="metric-card svelte-1umk7bb"><div class="metric-header svelte-1umk7bb"><div class="metric-icon blue svelte-1umk7bb">`),U(s,{size:24}),s.push(`<!----></div> <div${u(`metric-trend ${n(b.ltvGrowth>=0?"positive":"negative")}`,"svelte-1umk7bb")}>`),b.ltvGrowth>=0?(s.push("<!--[-->"),M(s,{size:16})):(s.push("<!--[!-->"),x(s,{size:16})),s.push(`<!--]--> ${l(Math.abs(b.ltvGrowth))}%</div></div> <div class="metric-value svelte-1umk7bb">${l(G(b.avgLtv))}</div> <div class="metric-label svelte-1umk7bb">Average LTV</div></div></div> <div class="charts-grid svelte-1umk7bb"><div class="chart-card svelte-1umk7bb"><div class="chart-header svelte-1umk7bb"><h3 class="svelte-1umk7bb">Member Growth</h3> <div class="chart-legend svelte-1umk7bb"><span class="legend-item svelte-1umk7bb"><span class="legend-dot purple svelte-1umk7bb"></span> Total</span> <span class="legend-item svelte-1umk7bb"><span class="legend-dot emerald svelte-1umk7bb"></span> New</span> <span class="legend-item svelte-1umk7bb"><span class="legend-dot red svelte-1umk7bb"></span> Churned</span></div></div> <div class="chart-body svelte-1umk7bb"><div class="bar-chart svelte-1umk7bb"><!--[-->`);const a=d(_);for(let e=0,c=a.length;e<c;e++){let t=a[e];s.push(`<div class="bar-group svelte-1umk7bb"><div class="bar-container svelte-1umk7bb"><div class="bar bar-members svelte-1umk7bb"${C(`height: ${n(t.members/L(_.map(m=>m.members))*100)}%`)}></div></div> <div class="bar-mini-group svelte-1umk7bb"><div class="bar bar-new svelte-1umk7bb"${C(`height: ${n(t.new/L(_.map(m=>m.new))*60)}px`)}></div> <div class="bar bar-churned svelte-1umk7bb"${C(`height: ${n(t.churned/L(_.map(m=>m.churned))*60)}px`)}></div></div> <span class="bar-label svelte-1umk7bb">${l(t.month)}</span></div>`)}s.push('<!--]--></div></div></div> <div class="chart-card svelte-1umk7bb"><div class="chart-header svelte-1umk7bb"><h3 class="svelte-1umk7bb">Revenue Trend</h3> <div class="chart-legend svelte-1umk7bb"><span class="legend-item svelte-1umk7bb"><span class="legend-dot emerald svelte-1umk7bb"></span> MRR</span></div></div> <div class="chart-body svelte-1umk7bb"><div class="line-chart svelte-1umk7bb"><svg viewBox="0 0 600 200" class="line-chart-svg svelte-1umk7bb"><!--[-->');const i=d([0,1,2,3,4]);for(let e=0,c=i.length;e<c;e++){let t=i[e];s.push(`<line x1="0"${y("y1",t*50)} x2="600"${y("y2",t*50)} stroke="rgba(148, 163, 184, 0.1)" stroke-dasharray="4" class="svelte-1umk7bb"></line>`)}s.push(`<!--]--><path${y("d",`M 0 200 ${n(o.map((e,c)=>{const t=c/(o.length-1)*600,m=200-e.mrr/1e5*180;return`L ${t} ${m}`}).join(" "))} L 600 200 Z`)} fill="url(#gradient)" opacity="0.3" class="svelte-1umk7bb"></path><path${y("d",`M ${n(o.map((e,c)=>{const t=c/(o.length-1)*600,m=200-e.mrr/1e5*180;return`${c===0?"M":"L"} ${t} ${m}`}).join(" "))}`)} fill="none" stroke="#34d399" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svelte-1umk7bb"></path><!--[-->`);const h=d(o);for(let e=0,c=h.length;e<c;e++){let t=h[e];s.push(`<circle${y("cx",e/(o.length-1)*600)}${y("cy",200-t.mrr/1e5*180)} r="5" fill="#34d399" class="svelte-1umk7bb"></circle>`)}s.push('<!--]--><defs class="svelte-1umk7bb"><linearGradient id="gradient" x1="0%" y1="0%" x2="0%" y2="100%" class="svelte-1umk7bb"><stop offset="0%" style="stop-color:#34d399;stop-opacity:0.4" class="svelte-1umk7bb"></stop><stop offset="100%" style="stop-color:#34d399;stop-opacity:0" class="svelte-1umk7bb"></stop></linearGradient></defs></svg> <div class="line-chart-labels svelte-1umk7bb"><!--[-->');const p=d(o);for(let e=0,c=p.length;e<c;e++){let t=p[e];s.push(`<span class="svelte-1umk7bb">${l(t.month)}</span>`)}s.push('<!--]--></div></div></div></div></div> <div class="chart-card full-width svelte-1umk7bb"><div class="chart-header svelte-1umk7bb"><h3 class="svelte-1umk7bb">Retention Cohort Analysis</h3> <p class="chart-subtitle svelte-1umk7bb">Monthly retention rates by signup cohort</p></div> <div class="chart-body svelte-1umk7bb"><div class="cohort-table svelte-1umk7bb"><table class="svelte-1umk7bb"><thead class="svelte-1umk7bb"><tr class="svelte-1umk7bb"><th class="svelte-1umk7bb">Cohort</th><th class="svelte-1umk7bb">Month 0</th><th class="svelte-1umk7bb">Month 1</th><th class="svelte-1umk7bb">Month 2</th><th class="svelte-1umk7bb">Month 3</th><th class="svelte-1umk7bb">Month 4</th><th class="svelte-1umk7bb">Month 5</th></tr></thead><tbody class="svelte-1umk7bb"><!--[-->');const g=d(D);for(let e=0,c=g.length;e<c;e++){let t=g[e];s.push(`<tr class="svelte-1umk7bb"><td class="cohort-name svelte-1umk7bb">${l(t.cohort)}</td><td${u(w(k(t.m0)),"svelte-1umk7bb")}>${l(t.m0)}%</td><td${u(w(k(t.m1)),"svelte-1umk7bb")}>${l(t.m1||"-")}%</td><td${u(w(k(t.m2)),"svelte-1umk7bb")}>${l(t.m2||"-")}%</td><td${u(w(k(t.m3)),"svelte-1umk7bb")}>${l(t.m3||"-")}%</td><td${u(w(k(t.m4)),"svelte-1umk7bb")}>${l(t.m4||"-")}%</td><td${u(w(k(t.m5)),"svelte-1umk7bb")}>${l(t.m5||"-")}%</td></tr>`)}s.push('<!--]--></tbody></table></div></div></div> <div class="bottom-grid svelte-1umk7bb"><div class="chart-card svelte-1umk7bb"><div class="chart-header svelte-1umk7bb"><h3 class="svelte-1umk7bb">Churn Reasons</h3></div> <div class="chart-body svelte-1umk7bb"><div class="reasons-list svelte-1umk7bb"><!--[-->');const f=d(S);for(let e=0,c=f.length;e<c;e++){let t=f[e];s.push(`<div class="reason-item svelte-1umk7bb"><div class="reason-info svelte-1umk7bb"><span class="reason-name svelte-1umk7bb">${l(t.reason)}</span> <span class="reason-count svelte-1umk7bb">${l(t.count)} members</span></div> <div class="reason-bar-container svelte-1umk7bb"><div class="reason-bar svelte-1umk7bb"${C(`width: ${n(t.percentage)}%`)}></div></div> <span class="reason-percentage svelte-1umk7bb">${l(t.percentage)}%</span></div>`)}s.push('<!--]--></div></div></div> <div class="chart-card svelte-1umk7bb"><div class="chart-header svelte-1umk7bb"><h3 class="svelte-1umk7bb">Segment Performance</h3></div> <div class="chart-body svelte-1umk7bb"><div class="segment-table svelte-1umk7bb"><table class="svelte-1umk7bb"><thead class="svelte-1umk7bb"><tr class="svelte-1umk7bb"><th class="svelte-1umk7bb">Segment</th><th class="svelte-1umk7bb">Members</th><th class="svelte-1umk7bb">Revenue</th><th class="svelte-1umk7bb">Churn</th></tr></thead><tbody class="svelte-1umk7bb"><!--[-->');const v=d(T);for(let e=0,c=v.length;e<c;e++){let t=v[e];s.push(`<tr class="svelte-1umk7bb"><td class="segment-name svelte-1umk7bb">${l(t.segment)}</td><td class="svelte-1umk7bb">${l(F(t.count))}</td><td class="revenue svelte-1umk7bb">${l(G(t.revenue))}</td><td${u(`churn-rate ${n(t.churnRate<=2?"low":t.churnRate<=5?"medium":"high")}`,"svelte-1umk7bb")}>${l(t.churnRate)}%</td></tr>`)}s.push("<!--]--></tbody></table></div></div></div></div>")}s.push("<!--]-->")}s.push("<!--]--></div>")})}export{Y as default};
