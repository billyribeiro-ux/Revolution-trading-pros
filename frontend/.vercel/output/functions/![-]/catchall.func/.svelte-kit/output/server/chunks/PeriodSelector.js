import{authStore as h}from"./auth.js";import{d as m,a as l,e as g,f as y,a8 as p}from"./vendor-svelte.js";const v={},T=v.VITE_API_BASE_URL||"http://localhost:8000/api";class q{getAuthHeaders(){const t=h.getToken(),e={"Content-Type":"application/json",Accept:"application/json"};return t&&(e.Authorization=`Bearer ${t}`),e}async request(t,e,a,i){let c=`${T}${e}`;if(i){const r=new URLSearchParams;Object.entries(i).forEach(([u,o])=>{o!=null&&r.append(u,String(o))});const s=r.toString();s&&(c+=`?${s}`)}const n=await fetch(c,{method:t,headers:this.getAuthHeaders(),body:a?JSON.stringify(a):void 0});if(!n.ok){const r=await n.json().catch(()=>({message:"Request failed"}));throw new Error(r.message||`HTTP ${n.status}`)}return n.json()}async trackEvent(t){return this.request("POST","/analytics/track",t)}async trackPageView(t){return this.request("POST","/analytics/pageview",t)}async trackBatch(t){return this.request("POST","/analytics/batch",{events:t})}async getDashboard(t="30d"){return this.request("GET","/admin/analytics/dashboard",void 0,{period:t})}async getKpiDefinitions(){return this.request("GET","/admin/analytics/kpis")}async getKpi(t,e="30d",a="daily"){return this.request("GET",`/admin/analytics/kpis/${t}`,void 0,{period:e,granularity:a})}async getFunnelAnalysis(t,e="30d"){return this.request("GET",`/admin/analytics/funnels/${t}`,void 0,{period:e})}async getFunnelDropOff(t,e="30d"){return this.request("GET",`/admin/analytics/funnels/${t}/dropoff`,void 0,{period:e})}async getFunnelBySegment(t,e,a="30d"){return this.request("GET",`/admin/analytics/funnels/${t}/segment`,void 0,{segment_field:e,period:a})}async getCohortMatrix(t,e="90d"){return this.request("GET",`/admin/analytics/cohorts/${t}/matrix`,void 0,{period:e})}async getCohortCurve(t,e="90d"){return this.request("GET",`/admin/analytics/cohorts/${t}/curve`,void 0,{period:e})}async getCohortLTV(t,e="90d"){return this.request("GET",`/admin/analytics/cohorts/${t}/ltv`,void 0,{period:e})}async getCampaignAttribution(t="linear",e="30d"){return this.request("GET","/admin/analytics/attribution/campaigns",void 0,{model:t,period:e})}async getConversionPaths(t="30d",e=20){return this.request("GET","/admin/analytics/attribution/paths",void 0,{period:t,limit:e})}async compareAttributionModels(t="30d"){return this.request("GET","/admin/analytics/attribution/compare",void 0,{period:t})}async getForecast(t,e=14,a="linear",i="daily"){return this.request("GET",`/admin/analytics/forecast/${t}`,void 0,{periods_ahead:e,model:a,granularity:i})}async getForecastAccuracy(t,e="daily"){return this.request("GET",`/admin/analytics/forecast/${t}/accuracy`,void 0,{granularity:e})}async getSegments(){return this.request("GET","/admin/analytics/segments")}async getSegment(t){return this.request("GET",`/admin/analytics/segments/${t}`)}async getEventTimeSeries(t,e="day",a="30d"){return this.request("GET","/admin/analytics/events/timeseries",void 0,{event_name:t,granularity:e,period:a})}async getEventBreakdown(t,e="30d"){return this.request("GET","/admin/analytics/events/breakdown",void 0,{dimension:t,period:e})}async getRealTimeMetrics(){return this.request("GET","/admin/analytics/realtime")}async getEvents(t){return this.request("GET","/admin/analytics/events",void 0,t)}async getFunnels(t){return this.request("GET","/admin/analytics/funnels",void 0,{period:t})}async createFunnel(t){return this.request("POST","/admin/analytics/funnels",t)}async getCohorts(t){return this.request("GET","/admin/analytics/cohorts",void 0,t)}async createCohort(t){return this.request("POST","/admin/analytics/cohorts",t)}async createSegment(t){return this.request("POST","/admin/analytics/segments",t)}async updateSegment(t,e){return this.request("PUT",`/admin/analytics/segments/${t}`,e)}async deleteSegment(t){return this.request("DELETE",`/admin/analytics/segments/${t}`)}async getChannelAttribution(t="linear",e="30d"){return this.request("GET","/admin/analytics/attribution/channels",void 0,{model:t,period:e})}async getReports(){return this.request("GET","/admin/analytics/reports")}async getReport(t){return this.request("GET",`/admin/analytics/reports/${t}`)}async createReport(t){return this.request("POST","/admin/analytics/reports",t)}async updateReport(t,e){return this.request("PUT",`/admin/analytics/reports/${t}`,e)}async deleteReport(t){return this.request("DELETE",`/admin/analytics/reports/${t}`)}async runReport(t){return this.request("POST",`/admin/analytics/reports/${t}/run`)}}const b=new q;function G(d,t){d.component(e=>{let{value:a="30d",showCustom:i=!0,onchange:c}=t;const n=[{value:"7d",label:"7 Days"},{value:"14d",label:"14 Days"},{value:"30d",label:"30 Days"},{value:"90d",label:"90 Days"},{value:"1y",label:"1 Year"}];e.push('<div class="flex items-center gap-1 bg-gray-100 rounded-lg p-1"><!--[-->');const r=m(n);for(let s=0,u=r.length;s<u;s++){let o=r[s];e.push(`<button${l(`px-3 py-1.5 text-sm font-medium rounded-md transition-all ${y(a===o.value?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900")}`)}>${g(o.label)}</button>`)}e.push("<!--]--> "),i?(e.push("<!--[-->"),e.push(`<button${l(`px-3 py-1.5 text-sm font-medium rounded-md transition-all ${y(n.find(s=>s.value===a)?"text-gray-600 hover:text-gray-900":"bg-white text-gray-900 shadow-sm")}`)}>Custom</button>`)):e.push("<!--[!-->"),e.push("<!--]--></div>"),p(t,{value:a})})}export{G as P,b as a};
