import{error as n,json as u}from"@sveltejs/kit";const o=new Map,c=async({params:r})=>{const{id:i}=r,s=o.get(i);if(!s)throw n(404,"Video not found");return s.view_count++,o.set(i,s),u({success:!0,data:s})},l=async({params:r,request:i})=>{const{id:s}=r,t=o.get(s);if(!t)throw n(404,"Video not found");try{const e=await i.json(),d={...t,title:e.title??t.title,description:e.description??t.description,thumbnail_url:e.thumbnail_url??t.thumbnail_url,video_url:e.video_url??t.video_url,duration:e.duration??t.duration,category_id:e.category_id??t.category_id,categories:e.categories??t.categories,tags:e.tags??t.tags,instructor:e.instructor??t.instructor,is_premium:e.is_premium??t.is_premium,is_published:e.is_published??t.is_published,updated_at:new Date().toISOString()};return e.title&&e.title!==t.title&&(d.slug=e.title.toLowerCase().replace(/[^a-z0-9]+/g,"-")),e.is_published&&!t.is_published&&(d.published_at=new Date().toISOString()),o.set(s,d),u({success:!0,data:d})}catch{throw n(400,"Invalid request body")}},_=async({params:r})=>{const{id:i}=r;if(!o.has(i))throw n(404,"Video not found");return o.delete(i),u({success:!0,message:"Video deleted successfully"})};export{_ as DELETE,c as GET,l as PUT};
