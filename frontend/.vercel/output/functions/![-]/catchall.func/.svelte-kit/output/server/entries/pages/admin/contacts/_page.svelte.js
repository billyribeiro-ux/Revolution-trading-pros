import{k as L,aM as A,e,d as z,c as f,f as u,r as B,bK as F,a as j}from"../../../../chunks/vendor-svelte.js";import{B as I,C as o}from"../../../../chunks/Card.js";import{I as M}from"../../../../chunks/Input.js";import{a as k,B as q}from"../../../../chunks/toast2.js";import{T as D}from"../../../../chunks/Table.js";import{S as N}from"../../../../chunks/Select.js";import"../../../../chunks/toast.js";import"../../../../chunks/BatchOperations.svelte_svelte_type_style_lang.js";import"../../../../chunks/AnimatedNumber.svelte_svelte_type_style_lang.js";import"../../../../chunks/OfflineIndicator.svelte_svelte_type_style_lang.js";import"isomorphic-dompurify";import"@sveltejs/kit/internal";import"@sveltejs/kit/internal/server";import"../../../../chunks/connections.js";import{c as E}from"../../../../chunks/crm.js";function st(y,J){y.component(x=>{let i=[],n=!0,h="",m="",c={current_page:1,last_page:1,total:0};const b=[{value:"",label:"All Statuses"},{value:"lead",label:"Lead"},{value:"prospect",label:"Prospect"},{value:"customer",label:"Customer"},{value:"churned",label:"Churned"},{value:"unqualified",label:"Unqualified"}];async function _(){try{n=!0;const t=await E.getContacts({search:h||void 0,status:m||void 0,per_page:25});i=t.data||[],t.meta&&(c={current_page:t.meta.current_page,last_page:t.meta.last_page,total:t.meta.total})}catch{k({type:"error",message:"Failed to load contacts"})}finally{n=!1}}function C(t){switch(t){case"customer":return"success";case"prospect":return"info";case"lead":return"warning";case"churned":return"default";default:return"default"}}let r;function w(){clearTimeout(r),r=setTimeout(()=>{_()},300)}let p=!0,d;function S(t){L("dszp7e",t,a=>{a.title(s=>{s.push("<title>Contacts | Revolution Admin</title>")})}),t.push('<div><div class="flex items-center justify-between mb-6"><div><h1 class="text-3xl font-bold text-gray-900">Contacts</h1> <p class="text-gray-600 mt-1">Manage your contact list and leads</p></div> '),I(t,{children:a=>{a.push('<a href="/admin/contacts/new" class="flex items-center gap-2">'),A(a,{size:20}),a.push("<!----> Add Contact</a>")}}),t.push('<!----></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">'),M(t,{placeholder:"Search contacts...",oninput:w,get value(){return h},set value(a){h=a,p=!1}}),t.push("<!----> "),N(t,{options:b,placeholder:"Filter by status",get value(){return m},set value(a){m=a,p=!1}}),t.push('<!----></div> <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">'),o(t,{children:a=>{a.push(`<p class="text-sm text-gray-600">Total Contacts</p> <p class="text-2xl font-bold mt-1">${e(c.total)}</p>`)}}),t.push("<!----> "),o(t,{children:a=>{a.push(`<p class="text-sm text-gray-600">Customers</p> <p class="text-2xl font-bold mt-1 text-green-600">${e(i.filter(s=>s.status==="customer").length)}</p>`)}}),t.push("<!----> "),o(t,{children:a=>{a.push(`<p class="text-sm text-gray-600">Prospects</p> <p class="text-2xl font-bold mt-1 text-blue-600">${e(i.filter(s=>s.status==="prospect").length)}</p>`)}}),t.push("<!----> "),o(t,{children:a=>{a.push(`<p class="text-sm text-gray-600">Leads</p> <p class="text-2xl font-bold mt-1 text-yellow-600">${e(i.filter(s=>s.status==="lead").length)}</p>`)}}),t.push("<!----></div> "),n?(t.push("<!--[-->"),o(t,{children:a=>{a.push('<div class="text-center py-12"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div> <p class="mt-4 text-gray-600">Loading contacts...</p></div>')}})):(t.push("<!--[!-->"),i.length===0?(t.push("<!--[-->"),o(t,{children:a=>{a.push('<div class="text-center py-12"><p class="text-gray-500">No contacts found.</p> <p class="text-sm text-gray-400 mt-2">Form submissions will automatically create contacts here.</p></div>')}})):(t.push("<!--[!-->"),o(t,{padding:!1,children:a=>{D(a,{headers:["Name","Email","Phone","Job Title","Status","Lead Score","Last Activity"],children:s=>{s.push("<!--[-->");const v=z(i);for(let g=0,T=v.length;g<T;g++){let l=v[g];s.push(`<tr><td><a${f("href",`/admin/contacts/${u(l.id)}`)} class="font-semibold text-blue-600 hover:text-blue-700">${e(l.full_name||`${l.first_name} ${l.last_name}`)}</a></td><td><a${f("href",`mailto:${u(l.email)}`)} class="flex items-center gap-2 text-gray-600 hover:text-blue-600">`),B(s,{size:16}),s.push(`<!----> ${e(l.email)}</a></td><td>`),l.phone?(s.push("<!--[-->"),s.push(`<a${f("href",`tel:${u(l.phone)}`)} class="flex items-center gap-2 text-gray-600 hover:text-blue-600">`),F(s,{size:16}),s.push(`<!----> ${e(l.phone)}</a>`)):(s.push("<!--[!-->"),s.push('<span class="text-gray-400">—</span>')),s.push(`<!--]--></td><td>${e(l.job_title||"—")}</td><td>`),q(s,{variant:C(l.status),children:P=>{P.push(`<!---->${e(l.status)}`)}}),s.push(`<!----></td><td><span${j(`font-medium ${u(l.lead_score>=70?"text-green-600":l.lead_score>=40?"text-yellow-600":"text-gray-500")}`)}>${e(l.lead_score||0)}</span></td><td class="text-gray-600">${e(l.last_activity_at?new Date(l.last_activity_at).toLocaleDateString():"—")}</td></tr>`)}s.push("<!--]-->")}})}}),t.push("<!----> "),c.last_page>1?(t.push("<!--[-->"),t.push(`<div class="flex justify-center gap-2 mt-4"><p class="text-sm text-gray-600">Page ${e(c.current_page)} of ${e(c.last_page)} (${e(c.total)} contacts)</p></div>`)):t.push("<!--[!-->"),t.push("<!--]-->")),t.push("<!--]-->")),t.push("<!--]--></div>")}do p=!0,d=x.copy(),S(d);while(!p);x.subsume(d)})}export{st as default};
