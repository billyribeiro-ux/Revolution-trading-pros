import{k as F,a0 as k,d as L,e as l,c as C,f,E as R}from"../../../../../chunks/vendor-svelte.js";import{B,C as n}from"../../../../../chunks/Card.js";import{a as m,B as O}from"../../../../../chunks/toast2.js";import{T as U}from"../../../../../chunks/Table.js";import{S as j}from"../../../../../chunks/Select.js";import"../../../../../chunks/toast.js";import"../../../../../chunks/BatchOperations.svelte_svelte_type_style_lang.js";import"../../../../../chunks/AnimatedNumber.svelte_svelte_type_style_lang.js";import"../../../../../chunks/OfflineIndicator.svelte_svelte_type_style_lang.js";import"isomorphic-dompurify";import"@sveltejs/kit/internal";import"@sveltejs/kit/internal/server";import"../../../../../chunks/connections.js";import{a as z,e as D}from"../../../../../chunks/forms.js";function Y(g,T){g.component(r=>{let b=[],o=[],e=null,c=!0;async function y(t){try{c=!0,o=((await z(t)).submissions||[]).map(a=>({id:a.id??0,form_id:a.form_id??t,data:a.data||{},created_at:a.created_at??""}))}catch{m({type:"error",message:"Failed to load entries"}),o=[]}finally{c=!1}}async function v(){e&&await y(e)}async function x(){if(e)try{const t=await D(e,"csv"),s=window.URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=`form-entries-${e}.csv`,a.click(),window.URL.revokeObjectURL(s),m({type:"success",message:"Entries exported successfully"})}catch{m({type:"error",message:"Failed to export entries"})}}let w=b.map(t=>({value:t.id,label:t.title})),p=!0,u;function _(t){F("1l9kf4z",t,s=>{s.title(a=>{a.push("<title>Form Entries | Revolution Admin</title>")})}),t.push('<div><div class="flex items-center justify-between mb-6"><div><h1 class="text-3xl font-bold text-gray-900">Form Entries</h1> <p class="text-gray-600 mt-1">View and manage form submissions</p></div> '),B(t,{onclick:x,disabled:!e||o.length===0,children:s=>{k(s,{size:20}),s.push("<!----> Export CSV")}}),t.push('<!----></div> <div class="mb-6 max-w-md">'),j(t,{label:"Select Form",options:w,onchange:v,placeholder:"Choose a form...",get value(){return e},set value(s){e=s,p=!1}}),t.push("<!----></div> "),c?(t.push("<!--[-->"),n(t,{children:s=>{s.push('<div class="text-center py-12"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div> <p class="mt-4 text-gray-600">Loading entries...</p></div>')}})):(t.push("<!--[!-->"),e?(t.push("<!--[!-->"),o.length===0?(t.push("<!--[-->"),n(t,{children:s=>{s.push('<div class="text-center py-12"><p class="text-gray-500">No entries found for this form</p></div>')}})):(t.push("<!--[!-->"),n(t,{padding:!1,children:s=>{U(s,{headers:["ID","Status","Submitted","Preview","Actions"],children:a=>{a.push("<!--[-->");const h=L(o);for(let d=0,E=h.length;d<E;d++){let i=h[d];a.push(`<tr><td class="font-mono">#${l(i.id)}</td><td>`),O(a,{variant:i.status==="complete"?"success":"warning",children:S=>{S.push(`<!---->${l(i.status)}`)}}),a.push(`<!----></td><td>${l(new Date(i.created_at).toLocaleString())}</td><td class="max-w-xs truncate text-gray-600">${l(JSON.stringify(i.data).substring(0,100))}...</td><td><button class="p-2 text-blue-600 hover:bg-blue-50 rounded transition-colors" title="View Entry"><a${C("href",`/admin/forms/${f(e)}/entries/${f(i.id)}`)}>`),R(a,{size:18}),a.push("<!----></a></button></td></tr>")}a.push("<!--]-->")}})}})),t.push("<!--]-->")):(t.push("<!--[-->"),n(t,{children:s=>{s.push('<div class="text-center py-12"><p class="text-gray-500">Please select a form to view entries</p></div>')}})),t.push("<!--]-->")),t.push("<!--]--></div>")}do p=!0,u=r.copy(),_(u);while(!p);r.subsume(u)})}export{Y as default};
