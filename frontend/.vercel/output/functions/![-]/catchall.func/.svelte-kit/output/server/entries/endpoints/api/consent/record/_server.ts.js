import{error as e,json as c}from"@sveltejs/kit";const a=new Map,d=async({request:o,getClientAddress:s})=>{try{const t=await o.json();if(!t.consents||typeof t.consents!="object")throw e(400,"Consents object is required");const n=`consent_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,r={id:n,consents:t.consents,timestamp:t.timestamp||new Date().toISOString(),user_agent:t.user_agent,ip_address:s()};return a.set(n,r),c({success:!0,data:{id:n,recorded_at:r.timestamp}},{status:201})}catch(t){throw t instanceof Error&&"status"in t?t:e(500,"Failed to record consent")}},u=async({url:o})=>{const s=o.searchParams.get("id");if(!s)throw e(400,"Consent ID is required");const t=a.get(s);if(!t)throw e(404,"Consent record not found");return c({success:!0,data:t})};export{u as GET,d as POST};
