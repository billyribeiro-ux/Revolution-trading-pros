import{z as Fe,p as He,a as Ve,A as qe,b as Me,f,q as s,e as r,Z as Xe,r as t,i as k,g as a,s as p,bH as Re,H as te,bI as Ze,cQ as We,w as F,x as c,D as Ye,bJ as Le,bG as Ne,h as n,j as Ae,c as o,o as $e,a9 as et,d as ne,ao as tt,N as Oe,as as at,at as st,Q as Pe,P as rt,bV as De,k as je,n as lt,b_ as ot,O as vt,dI as it,c5 as dt}from"../chunks/C_QN0JMx.js";var nt=f('<div class="error-message svelte-15qyakf"> </div>'),ct=f('<div class="modal-overlay svelte-15qyakf" role="presentation"><div class="modal svelte-15qyakf" role="dialog" aria-modal="true" tabindex="-1"><div class="modal-header svelte-15qyakf"><h2 class="svelte-15qyakf">Create Redirect from 404</h2> <button class="close-btn svelte-15qyakf" aria-label="Close modal"><!></button></div> <form><div class="modal-body svelte-15qyakf"><!> <div class="form-group svelte-15qyakf"><div class="field-label svelte-15qyakf">404 URL</div> <div class="readonly-field svelte-15qyakf"> </div></div> <div class="form-group svelte-15qyakf"><label for="destination-url" class="svelte-15qyakf">Redirect To <span class="required svelte-15qyakf">*</span></label> <input id="destination-url" type="text" placeholder="/new-page" required class="svelte-15qyakf"/> <div class="hint svelte-15qyakf">Enter the destination URL (e.g., /new-page or https://example.com)</div></div> <div class="form-group svelte-15qyakf"><label for="redirect-type" class="svelte-15qyakf">Redirect Type</label> <select id="redirect-type" class="svelte-15qyakf"><option>301 - Moved Permanently</option><option>302 - Found (Temporary)</option><option>307 - Temporary Redirect</option><option>308 - Permanent Redirect</option></select></div> <div class="form-group svelte-15qyakf"><label for="notes" class="svelte-15qyakf">Notes</label> <textarea id="notes" rows="2" class="svelte-15qyakf"></textarea></div></div> <div class="modal-footer svelte-15qyakf"><button type="button" class="btn-secondary svelte-15qyakf">Cancel</button> <button type="submit" class="btn-primary svelte-15qyakf"><!> </button></div></form></div></div>');function ft(ce,H){He(H,!0);let M=Ve(H,"url404",3,""),i=qe({destination_url:"",redirect_type:"301",notes:""});Me(()=>{i.notes=`Redirect created from 404: ${M()||""}`});let x=p(!1),u=p("");async function _(){o(u,""),o(x,!0);try{const e=await fetch("/api/seo/redirects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source_url:M(),destination_url:i.destination_url,redirect_type:i.redirect_type,is_active:!0,is_regex:!1,notes:i.notes})});if(e.ok)H.oncreated?.();else{const l=await e.json();o(u,l.message||"Failed to create redirect",!0)}}catch{o(u,"An error occurred while creating redirect")}finally{o(x,!1)}}function h(){H.oncancel?.()}function z(e){e.key==="Escape"&&h()}var O=ct();O.__click=h,O.__keydown=z;var w=s(O);w.__click=e=>e.stopPropagation(),w.__keydown=e=>e.stopPropagation();var y=s(w),q=r(s(y),2);q.__click=h;var fe=s(q);Xe(fe,{size:24}),t(q),t(y);var K=r(y,2),N=s(K),ae=s(N);{var _e=e=>{var l=nt(),d=s(l,!0);t(l),F(()=>c(d,a(u))),n(e,l)};k(ae,e=>{a(u)&&e(_e)})}var A=r(ae,2),V=r(s(A),2),X=s(V,!0);t(V),t(A);var E=r(A,2),se=r(s(E),2);Re(se),te(2),t(E);var P=r(E,2),D=r(s(P),2),I=s(D);I.value=I.__value="301";var U=r(I);U.value=U.__value="302";var R=r(U);R.value=R.__value="307";var re=r(R);re.value=re.__value="308",t(D),t(P);var le=r(P,2),Z=r(s(le),2);Ze(Z),t(le),t(N);var oe=r(N,2),ve=s(oe);ve.__click=h;var W=r(ve,2),ie=s(W);We(ie,{size:18});var me=r(ie);t(W),t(oe),t(K),t(w),t(O),F(()=>{c(X,M()),W.disabled=a(x),c(me,` ${a(x)?"Creating...":"Create Redirect"}`)}),Ye("submit",K,e=>{e.preventDefault(),_()}),Le(se,()=>i.destination_url,e=>i.destination_url=e),Ne(D,()=>i.redirect_type,e=>i.redirect_type=e),Le(Z,()=>i.notes,e=>i.notes=e),n(ce,O),Ae()}Fe(["click","keydown"]);var _t=f('<div class="stats-grid svelte-gfwm1m"><div class="stat-card warning svelte-gfwm1m"><!> <div class="stat-value svelte-gfwm1m"> </div> <div class="stat-label svelte-gfwm1m">Total 404s</div></div> <div class="stat-card svelte-gfwm1m"><div class="stat-value svelte-gfwm1m"> </div> <div class="stat-label svelte-gfwm1m">Unresolved</div></div> <div class="stat-card success svelte-gfwm1m"><div class="stat-value svelte-gfwm1m"> </div> <div class="stat-label svelte-gfwm1m">Resolved</div></div> <div class="stat-card svelte-gfwm1m"><div class="stat-value svelte-gfwm1m"> </div> <div class="stat-label svelte-gfwm1m">Total Hits</div></div></div>'),mt=f("<option> </option>"),ut=f('<button class="btn-danger svelte-gfwm1m"><!> </button>'),gt=f('<div class="loading svelte-gfwm1m">Loading 404 logs...</div>'),pt=f('<div class="empty-state svelte-gfwm1m"><h3 class="svelte-gfwm1m">No 404 errors found</h3> <p class="svelte-gfwm1m"> </p></div>'),ht=f('<span class="status-badge resolved svelte-gfwm1m">Resolved</span>'),wt=f('<span class="status-badge ignored svelte-gfwm1m">Ignored</span>'),yt=f('<span class="status-badge pending svelte-gfwm1m">Pending</span>'),bt=f('<button class="action-btn primary svelte-gfwm1m" title="Create Redirect"><!></button> <button class="action-btn svelte-gfwm1m" title="Ignore"><!></button>',1),kt=f('<tr class="svelte-gfwm1m"><td class="svelte-gfwm1m"><input type="checkbox"/></td><td class="svelte-gfwm1m"><div class="url-cell svelte-gfwm1m"> </div></td><td class="svelte-gfwm1m"><span> </span></td><td class="date-cell svelte-gfwm1m"> </td><td class="referer-cell svelte-gfwm1m"> </td><td class="svelte-gfwm1m"><!></td><td class="svelte-gfwm1m"><div class="actions svelte-gfwm1m"><!> <button class="action-btn danger svelte-gfwm1m" title="Delete"><!></button></div></td></tr>'),xt=f('<table class="svelte-gfwm1m"><thead><tr><th style="width: 40px" class="svelte-gfwm1m"><input type="checkbox"/></th><th class="svelte-gfwm1m">URL</th><th class="svelte-gfwm1m">Hits</th><th class="svelte-gfwm1m">Last Hit</th><th class="svelte-gfwm1m">Referer</th><th class="svelte-gfwm1m">Status</th><th style="width: 160px" class="svelte-gfwm1m">Actions</th></tr></thead><tbody class="svelte-gfwm1m"></tbody></table>'),qt=f('<div class="monitor-page svelte-gfwm1m"><header class="page-header svelte-gfwm1m"><div><h1 class="svelte-gfwm1m">404 Error Monitor</h1> <p class="svelte-gfwm1m">Track 404 errors and convert them to redirects</p></div></header> <!> <div class="controls-bar svelte-gfwm1m"><div class="search-box svelte-gfwm1m"><!> <input type="text" placeholder="Search URLs..." class="svelte-gfwm1m"/></div> <select class="sort-select svelte-gfwm1m"></select> <!></div> <div class="logs-table svelte-gfwm1m"><!></div></div> <!>',1);function Lt(ce,H){He(H,!0);let M=p(qe([])),i=p(null),x=p(!1),u=p(""),_=p(qe([])),h=p(!1),z=p(null);const O=[{value:"hits",label:"Most Hits"},{value:"latest",label:"Latest"},{value:"oldest",label:"Oldest"}];let w=p("hits");$e(()=>{y(),q()});async function y(){o(x,!0);try{const l=await(await fetch(`/api/seo/404-logs?sort=${a(w)}`)).json();o(M,l.data||[],!0)}catch{}finally{o(x,!1)}}async function q(){try{const e=await fetch("/api/seo/404-logs/stats");o(i,await e.json(),!0)}catch{}}function fe(e){o(z,e,!0),o(h,!0)}async function K(e){try{await fetch(`/api/seo/404-logs/${e}/ignore`,{method:"POST"}),y(),q()}catch{}}async function N(e){if(confirm(`Delete ${e.length} log(s)?`))try{await fetch("/api/seo/404-logs/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:e})}),o(_,[],!0),y(),q()}catch{}}function ae(e){a(_).includes(e)?o(_,a(_).filter(l=>l!==e),!0):o(_,[...a(_),e],!0)}function _e(){o(h,!1),o(z,null),y(),q()}Me(()=>{a(w)&&y()});let A=lt(()=>a(M).filter(e=>e.url.toLowerCase().includes(a(u).toLowerCase())||e.referer?.toLowerCase().includes(a(u).toLowerCase())));var V=qt();et("gfwm1m",e=>{at(()=>{st.title="404 Monitor | SEO"})});var X=ne(V),E=r(s(X),2);{var se=e=>{var l=_t(),d=s(l),L=s(d);rt(L,{size:32});var j=r(L,2),C=s(j,!0);t(j),te(2),t(d);var g=r(d,2),T=s(g),Y=s(T,!0);t(T),te(2),t(g);var v=r(g,2),J=s(v),$=s(J,!0);t(J),te(2),t(v);var Q=r(v,2),G=s(Q),de=s(G,!0);t(G),te(2),t(Q),t(l),F(ue=>{c(C,a(i).total),c(Y,a(i).unresolved),c($,a(i).resolved),c(de,ue)},[()=>a(i).total_hits?.toLocaleString()||0]),n(e,l)};k(E,e=>{a(i)&&e(se)})}var P=r(E,2),D=s(P),I=s(D);tt(I,{size:20});var U=r(I,2);Re(U),t(D);var R=r(D,2);Oe(R,21,()=>O,Pe,(e,l)=>{var d=mt(),L=s(d,!0);t(d);var j={};F(()=>{c(L,a(l).label),j!==(j=a(l).value)&&(d.value=(d.__value=a(l).value)??"")}),n(e,d)}),t(R);var re=r(R,2);{var le=e=>{var l=ut();l.__click=()=>N(a(_));var d=s(l);De(d,{size:18});var L=r(d);t(l),F(()=>c(L,` Delete (${a(_).length??""})`)),n(e,l)};k(re,e=>{a(_).length>0&&e(le)})}t(P);var Z=r(P,2),oe=s(Z);{var ve=e=>{var l=gt();n(e,l)},W=e=>{var l=je(),d=ne(l);{var L=C=>{var g=pt(),T=r(s(g),2),Y=s(T,!0);t(T),t(g),F(()=>c(Y,a(u)?"Try a different search":"Great! No 404 errors detected")),n(C,g)},j=C=>{var g=xt(),T=r(s(g));Oe(T,21,()=>a(A),Pe,(Y,v)=>{var J=kt(),$=s(J),Q=s($);Re(Q),Q.__change=()=>ae(a(v).id),t($);var G=r($),de=s(G),ue=s(de,!0);t(de),t(G);var ge=r(G),pe=s(ge);let Ce;var Ee=s(pe,!0);t(pe),t(ge);var he=r(ge),Ie=s(he,!0);t(he);var we=r(he),Ue=s(we,!0);t(we);var ye=r(we),Je=s(ye);{var Qe=m=>{var b=ht();n(m,b)},Ge=m=>{var b=je(),B=ne(b);{var ke=S=>{var xe=wt();n(S,xe)},ee=S=>{var xe=yt();n(S,xe)};k(B,S=>{a(v).is_ignored?S(ke):S(ee,!1)},!0)}n(m,b)};k(Je,m=>{a(v).is_resolved?m(Qe):m(Ge,!1)})}t(ye);var Te=r(ye),Se=s(Te),ze=s(Se);{var Be=m=>{var b=bt(),B=ne(b);B.__click=()=>fe(a(v));var ke=s(B);it(ke,{size:18}),t(B);var ee=r(B,2);ee.__click=()=>K(a(v).id);var S=s(ee);dt(S,{size:18}),t(ee),n(m,b)};k(ze,m=>{!a(v).is_resolved&&!a(v).is_ignored&&m(Be)})}var be=r(ze,2);be.__click=()=>N([a(v).id]);var Ke=s(be);De(Ke,{size:18}),t(be),t(Se),t(Te),t(J),F((m,b)=>{ot(Q,m),c(ue,a(v).url),Ce=vt(pe,1,"hits-badge svelte-gfwm1m",null,Ce,{high:a(v).hits>10}),c(Ee,a(v).hits),c(Ie,b),c(Ue,a(v).referer||"â€”")},[()=>a(_).includes(a(v).id),()=>new Date(a(v).last_hit_at).toLocaleDateString()]),n(Y,J)}),t(T),t(g),n(C,g)};k(d,C=>{a(A).length===0?C(L):C(j,!1)},!0)}n(e,l)};k(oe,e=>{a(x)?e(ve):e(W,!1)})}t(Z),t(X);var ie=r(X,2);{var me=e=>{ft(e,{get url404(){return a(z).url},oncreated:_e,oncancel:()=>{o(h,!1),o(z,null)}})};k(ie,e=>{a(h)&&a(z)&&e(me)})}Le(U,()=>a(u),e=>o(u,e)),Ne(R,()=>a(w),e=>o(w,e)),n(ce,V),Ae()}Fe(["click","change"]);export{Lt as component};
