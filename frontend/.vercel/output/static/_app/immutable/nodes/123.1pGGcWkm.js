import{z as Te,p as Le,o as Ee,a3 as Ge,f as c,a9 as He,aQ as Ie,w as $,e as s,q as a,i as R,N as ae,bG as Ke,g as r,h as d,j as Oe,E as Ue,c as fe,aP as me,as as We,dQ as u,B as S,at as Ye,r as t,H as Je,bK as Ve,Q as Xe,cY as A,x as o,O as Ze,k as be,d as ge,F as et}from"../chunks/C_QN0JMx.js";import{c as se}from"../chunks/L2eW2QSs.js";import{i as Q,e as T,p as ye,s as re,d as tt,b as at}from"../chunks/CQFACQS9.js";var st=c('<div class="mb-6 grid gap-4 md:grid-cols-4"><div class="rounded-2xl border border-slate-800 bg-slate-900/70 p-4 text-xs"><p class="text-[11px] uppercase tracking-wide text-slate-500">Commit</p> <p class="mt-2 flex items-center gap-1 text-lg font-semibold text-emerald-300"><!> </p></div> <div class="rounded-2xl border border-slate-800 bg-slate-900/70 p-4 text-xs"><p class="text-[11px] uppercase tracking-wide text-slate-500">Best Case</p> <p class="mt-2 flex items-center gap-1 text-lg font-semibold text-sky-300"><!> </p></div> <div class="rounded-2xl border border-slate-800 bg-slate-900/70 p-4 text-xs"><p class="text-[11px] uppercase tracking-wide text-slate-500">Pipeline</p> <p class="mt-2 flex items-center gap-1 text-lg font-semibold text-slate-100"><!> </p></div> <div class="rounded-2xl border border-slate-800 bg-slate-900/70 p-4 text-xs"><p class="text-[11px] uppercase tracking-wide text-slate-500">Worst Case</p> <p class="mt-2 flex items-center gap-1 text-lg font-semibold text-amber-300"><!> </p></div></div>'),rt=c("<button> </button>"),it=c('<div class="mb-4 rounded-xl border border-rose-700/60 bg-rose-950/40 px-4 py-3 text-sm text-rose-200"> </div>'),lt=c('<div class="flex-1 py-16 text-center text-sm text-slate-500">No pipelines configured.</div>'),ot=c('<p class="py-4 text-center text-[11px] text-slate-500">No deals in this stage.</p>'),nt=c('<button type="button" class="w-full cursor-pointer rounded-xl border border-slate-800/80 bg-slate-900/90 p-3 text-left hover:border-sky-500/70 focus:outline-none focus:ring-2 focus:ring-sky-500/60"><p class="text-[13px] font-medium text-slate-100"> </p> <p class="mt-0.5 text-[11px] text-slate-400"> </p> <div class="mt-2 flex items-center justify-between text-[11px] text-slate-400"><span> </span> <span> </span></div></button>'),dt=c('<div class="min-w-[260px] flex-1 rounded-2xl border border-slate-800/80 bg-slate-900/70 p-3"><div class="mb-3 flex items-center justify-between gap-2 text-xs"><div><p class="font-medium text-slate-100"> </p> <p class="text-[11px] text-slate-500"> </p></div> <span class="rounded-full bg-slate-800/80 px-2 py-1 text-[11px] text-slate-300"> </span></div> <div class="space-y-2 text-xs"><!></div></div>'),pt=c('<div class="min-h-screen bg-slate-950/95 text-slate-50"><div class="mx-auto max-w-7xl px-6 py-8"><div class="mb-6 flex flex-wrap items-center justify-between gap-4"><div class="flex items-center gap-3"><div class="flex h-10 w-10 items-center justify-center rounded-xl bg-sky-500/20 text-sky-400"><!></div> <div><h1 class="text-2xl font-semibold tracking-tight">Deals Pipeline</h1> <p class="text-sm text-slate-400">RevolutionCRM-L8-System · Forecast-ready sales pipeline</p></div></div> <div class="flex items-center gap-2 text-xs text-slate-400"><span>Forecast period:</span> <select class="rounded-lg border border-slate-800 bg-slate-900/80 px-2 py-1 text-xs"><option>This month</option><option>Next month</option><option>This quarter</option><option>Next quarter</option></select></div></div> <!> <div class="mb-4 flex flex-wrap items-center gap-2 text-xs"></div> <!> <div class="flex gap-3 overflow-x-auto pb-4"><!></div></div></div>');function _t(he,$e){Le($e,!1);const ie=()=>S(T,"$error",D),x=()=>S(re,"$selectedPipeline",D),we=()=>S(ye,"$pipelines",D),L=()=>S(at,"$dealsByStage",D),[D,ke]=Ue();let z=me("this_month"),f=me(null);Ee(async()=>{await Pe(),await E()});async function Pe(){u(Q,!0),u(T,null);try{const e=await se.getPipelines();ye.set(e),e.length&&!x()&&re.set(e[0]),await le()}catch{u(T,"Failed to load deals. Please try again.")}finally{u(Q,!1)}}async function le(){if(x())try{u(Q,!0);const e=await se.getDeals({pipeline_id:x().id,per_page:500});tt.set(e.data)}catch{u(T,"Failed to load deals. Please try again.")}finally{u(Q,!1)}}async function E(){try{fe(f,await se.getDealForecast(r(z)))}catch{}}function Fe(e){re.set(e),le(),E()}function Ce(e){et(`/crm/deals/${e.id}`)}function m(e){return e?e>=1e6?`$${(e/1e6).toFixed(1)}M`:e>=1e3?`$${(e/1e3).toFixed(1)}k`:`$${e.toFixed(0)}`:"$0"}Ge();var G=pt();He("lb8s6n",e=>{We(()=>{Ye.title="CRM Deals | Revolution Trading Pros"})});var oe=a(G),H=a(oe),I=a(H),ne=a(I),De=a(ne);Ie(De,{size:22}),t(ne),Je(2),t(I);var de=s(I,2),j=s(a(de),2);$(()=>{r(z),Ve(()=>{})}),j.__change=E;var K=a(j);K.value=K.__value="this_month";var O=s(K);O.value=O.__value="next_month";var U=s(O);U.value=U.__value="this_quarter";var pe=s(U);pe.value=pe.__value="next_quarter",t(j),t(de),t(H);var ve=s(H,2);{var ze=e=>{var i=st(),l=a(i),v=s(a(l),2),p=a(v);A(p,{size:18});var w=s(p);t(v),t(l);var _=s(l,2),b=s(a(_),2),g=a(b);A(g,{size:18});var Y=s(g);t(b),t(_);var y=s(_,2),q=s(a(y),2),k=a(q);A(k,{size:18});var J=s(k);t(q),t(y);var P=s(y,2),B=s(a(P),2),N=a(B);A(N,{size:18});var V=s(N);t(B),t(P),t(i),$((n,h,X,F)=>{o(w,` ${n??""}`),o(Y,` ${h??""}`),o(J,` ${X??""}`),o(V,` ${F??""}`)},[()=>m(r(f).commit),()=>m(r(f).best_case),()=>m(r(f).pipeline),()=>m(r(f).worst_case)]),d(e,i)};R(ve,e=>{r(f)&&e(ze)})}var W=s(ve,2);ae(W,5,we,Xe,(e,i)=>{var l=rt();l.__click=()=>Fe(r(i));var v=a(l,!0);t(l),$(()=>{Ze(l,1,`rounded-full border px-3 py-1 ${x()&&x().id===r(i).id?"border-sky-500 bg-sky-500/15 text-sky-200":"border-slate-800 bg-slate-900/80 text-slate-300 hover:border-slate-700"}`),o(v,r(i).name)}),d(e,l)}),t(W);var ce=s(W,2);{var je=e=>{var i=it(),l=a(i,!0);t(i),$(()=>o(l,ie())),d(e,i)};R(ce,e=>{ie()&&e(je)})}var xe=s(ce,2),qe=a(xe);{var Be=e=>{var i=lt();d(e,i)},Ne=e=>{var i=be(),l=ge(i);ae(l,1,()=>x().stages,v=>v.id,(v,p)=>{var w=dt(),_=a(w),b=a(_),g=a(b),Y=a(g,!0);t(g);var y=s(g,2),q=a(y);t(y),t(b);var k=s(b,2),J=a(k,!0);t(k),t(_);var P=s(_,2),B=a(P);{var N=n=>{var h=ot();d(n,h)},V=n=>{var h=be(),X=ge(h);ae(X,1,()=>L()[r(p).id],F=>F.id,(F,C)=>{var M=nt();M.__click=()=>Ce(r(C));var Z=a(M),Me=a(Z,!0);t(Z);var ee=s(Z,2),Re=a(ee,!0);t(ee);var _e=s(ee,2),te=a(_e),Se=a(te,!0);t(te);var ue=s(te,2),Ae=a(ue);t(ue),t(_e),t(M),$(Qe=>{o(Me,r(C).name),o(Re,r(C).contact?.full_name??"Unassigned contact"),o(Se,Qe),o(Ae,`${r(C).probability??""}%`)},[()=>m(r(C).amount)]),d(F,M)}),d(n,h)};R(B,n=>{L()[r(p).id]?.length?n(V,!1):n(N)})}t(P),t(w),$(n=>{o(Y,r(p).name),o(q,`${r(p).probability??""}% · ${L()[r(p).id]?.length??0??""} deals`),o(J,n)},[()=>m(r(p).total_value??0)]),d(v,w)}),d(e,i)};R(qe,e=>{x()?e(Ne,!1):e(Be)})}t(xe),t(oe),t(G),Ke(j,()=>r(z),e=>fe(z,e)),d(he,G),Oe(),ke()}Te(["change","click"]);export{_t as component};
