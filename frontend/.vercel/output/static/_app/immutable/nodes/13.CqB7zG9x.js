import{z as Ve,p as Xe,s as M,A as De,o as Ze,f as b,a9 as et,d as Z,e as r,q as a,c as s,i as z,bG as be,g as e,h as n,j as tt,as as rt,at,r as t,k as Me,bH as xe,bI as ot,K as it,w as q,bJ as ie,x as v,N as lt,O as st,Q as dt,n as nt}from"../chunks/C_QN0JMx.js";import{a as ze}from"../chunks/CCQSfPwG.js";import{C as vt}from"../chunks/B0a-D82g.js";import{P as ct}from"../chunks/gQRjaVS-.js";var ut=b('<div class="flex items-center justify-center py-20"><div class="w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"></div></div>'),gt=b('<div class="bg-red-50 border border-red-200 rounded-xl p-6 text-center"><p class="text-red-600"> </p> <button class="mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">Retry</button></div>'),pt=b('<div class="bg-white rounded-xl border border-gray-200 p-12 text-center"><div class="text-4xl mb-4">ðŸ‘¥</div> <h3 class="text-lg font-medium text-gray-900 mb-2">No Cohorts Yet</h3> <p class="text-gray-500 mb-6">Create your first cohort to analyze user retention</p> <button class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 inline-block">Create Your First Cohort</button></div>'),_t=b("<button> </button>"),bt=b('<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8"><div class="bg-white rounded-xl border border-gray-200 p-6"><div class="text-sm text-gray-500 mb-1"> </div> <div class="text-3xl font-bold text-gray-900"> </div></div> <div class="bg-white rounded-xl border border-gray-200 p-6"><div class="text-sm text-gray-500 mb-1"> </div> <div class="text-3xl font-bold text-gray-900"> </div></div> <div class="bg-white rounded-xl border border-gray-200 p-6"><div class="text-sm text-gray-500 mb-1"> </div> <div class="text-3xl font-bold text-gray-900"> </div></div></div>'),xt=b('<div class="mt-4 pt-4 border-t border-gray-100"><div class="text-xs font-medium text-gray-400 uppercase mb-1">Description</div> <p class="text-sm text-gray-600"> </p></div>'),yt=b('<!> <!> <div class="mt-8 bg-white rounded-xl border border-gray-200 p-6"><h3 class="text-lg font-semibold text-gray-900 mb-4">Cohort Details</h3> <div class="grid grid-cols-2 md:grid-cols-4 gap-6"><div><div class="text-xs font-medium text-gray-400 uppercase mb-1">Type</div> <div class="text-sm text-gray-900 capitalize"> </div></div> <div><div class="text-xs font-medium text-gray-400 uppercase mb-1">Granularity</div> <div class="text-sm text-gray-900 capitalize"> </div></div> <div><div class="text-xs font-medium text-gray-400 uppercase mb-1">Total Cohorts</div> <div class="text-sm text-gray-900"> </div></div> <div><div class="text-xs font-medium text-gray-400 uppercase mb-1">Total Users</div> <div class="text-sm text-gray-900"> </div></div></div> <!></div>',1),mt=b('<div class="flex gap-2 mb-8 overflow-x-auto pb-2"></div> <!>',1),ft=b('<div class="grid grid-cols-2 gap-4"><div><label for="cohort-start-event" class="block text-sm font-medium text-gray-700 mb-1">Start Event</label> <input id="cohort-start-event" type="text" placeholder="e.g., signup" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"/></div> <div><label for="cohort-return-event" class="block text-sm font-medium text-gray-700 mb-1">Return Event</label> <input id="cohort-return-event" type="text" placeholder="e.g., login" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"/></div></div>'),ht=b('<div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"><div class="bg-white rounded-2xl w-full max-w-lg"><div class="p-6 border-b border-gray-100"><div class="flex items-center justify-between"><h2 class="text-xl font-bold text-gray-900">Create Cohort</h2> <button class="text-gray-400 hover:text-gray-600 text-2xl">âœ•</button></div></div> <div class="p-6 space-y-4"><div><label for="cohort-name" class="block text-sm font-medium text-gray-700 mb-1">Name</label> <input id="cohort-name" type="text" placeholder="e.g., Weekly Signup Retention" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"/></div> <div><label for="cohort-description" class="block text-sm font-medium text-gray-700 mb-1">Description</label> <textarea id="cohort-description" placeholder="Describe this cohort..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"></textarea></div> <div class="grid grid-cols-2 gap-4"><div><label for="cohort-type" class="block text-sm font-medium text-gray-700 mb-1">Type</label> <select id="cohort-type" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"><option>Signup Date</option><option>First Purchase</option><option>Custom Event</option></select></div> <div><label for="cohort-granularity" class="block text-sm font-medium text-gray-700 mb-1">Granularity</label> <select id="cohort-granularity" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"><option>Daily</option><option>Weekly</option><option>Monthly</option></select></div></div> <!></div> <div class="p-6 border-t border-gray-100 flex justify-end gap-3"><button class="px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50">Cancel</button> <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50">Create Cohort</button></div></div></div>'),wt=b('<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="flex items-center justify-between mb-8"><div><h1 class="text-2xl font-bold text-gray-900">Cohort Analysis</h1> <p class="text-sm text-gray-500 mt-1">Analyze user retention patterns over time</p></div> <div class="flex items-center gap-4"><!> <select class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500"><option>Daily</option><option>Weekly</option><option>Monthly</option></select> <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium">Create Cohort</button></div></div> <!></div> <!>',1);function Mt(Ae,Fe){Xe(Fe,!0);let H=M(De([])),le=M(!0),ee=M(null),se=M("90d"),f=M("weekly"),l=M(null),j=M(!1),i=M(De({name:"",description:"",type:"signup",granularity:"weekly",start_event:"",return_event:""}));async function J(){s(le,!0),s(ee,null);try{const o=await ze.getCohorts({period:e(se),granularity:e(f)});s(H,o.cohorts||[],!0),e(H).length>0&&!e(l)&&s(l,e(H)[0],!0)}catch(o){s(ee,o instanceof Error?o.message:"Failed to load cohorts",!0)}finally{s(le,!1)}}function Re(o){s(se,o,!0),J()}function je(){J()}async function Ee(){try{await ze.createCohort({name:e(i).name,description:e(i).description,type:e(i).type,granularity:e(i).granularity,start_event:e(i).start_event||void 0,return_event:e(i).return_event||void 0}),s(j,!1),s(i,{name:"",description:"",type:"signup",granularity:"weekly",start_event:"",return_event:""},!0),J()}catch(o){alert(o instanceof Error?o.message:"Failed to create cohort")}}Ze(()=>{J()});const te=nt(()=>e(l)?{avgWeek1:de(e(l).retention_matrix,0),avgWeek4:de(e(l).retention_matrix,3),avgWeek8:de(e(l).retention_matrix,7)}:null);function de(o,c){const W=o.filter(u=>u.periods[c]!==void 0).map(u=>u.periods[c]);return W.length===0?0:W.reduce((u,E)=>u+E,0)/W.length}var ye=wt();et("1vpcc3i",o=>{rt(()=>{at.title="Cohort Analysis | Analytics"})});var ne=Z(ye),ve=a(ne),me=r(a(ve),2),fe=a(me);ct(fe,{get value(){return e(se)},onchange:Re});var K=r(fe,2);K.__change=je;var ce=a(K);ce.value=ce.__value="daily";var ue=r(ce);ue.value=ue.__value="weekly";var he=r(ue);he.value=he.__value="monthly",t(K);var Ge=r(K,2);Ge.__click=()=>s(j,!0),t(me),t(ve);var Pe=r(ve,2);{var Se=o=>{var c=ut();n(o,c)},Te=o=>{var c=Me(),W=Z(c);{var u=D=>{var x=gt(),h=a(x),G=a(h,!0);t(h);var A=r(h,2);A.__click=J,t(x),q(()=>v(G,e(ee))),n(D,x)},E=D=>{var x=Me(),h=Z(x);{var G=y=>{var m=pt(),w=r(a(m),6);w.__click=()=>s(j,!0),t(m),n(y,m)},A=y=>{var m=mt(),w=Z(m);lt(w,21,()=>e(H),dt,(k,C)=>{var g=_t();g.__click=()=>s(l,e(C),!0);var F=a(g,!0);t(g),q(()=>{st(g,1,`px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-all
						${e(l)?.key===e(C).key?"bg-blue-600 text-white":"bg-white border border-gray-200 text-gray-700 hover:bg-gray-50"}`),v(F,e(C).name)}),n(k,g)}),t(w);var L=r(w,2);{var O=k=>{var C=yt(),g=Z(C);{var F=p=>{var _=bt(),Y=a(_),X=a(Y),He=a(X);t(X);var we=r(X,2),Je=a(we);t(we),t(Y);var ge=r(Y,2),pe=a(ge),Ke=a(pe);t(pe);var ke=r(pe,2),Le=a(ke);t(ke),t(ge);var Ce=r(ge,2),_e=a(Ce),Oe=a(_e);t(_e);var We=r(_e,2),Qe=a(We);t(We),t(Ce),t(_),q((Ue,Be,Ie)=>{v(He,`${e(f)==="weekly"?"Week 1":e(f)==="monthly"?"Month 1":"Day 1"} Retention`),v(Je,`${Ue??""}%`),v(Ke,`${e(f)==="weekly"?"Week 4":e(f)==="monthly"?"Month 4":"Day 4"} Retention`),v(Le,`${Be??""}%`),v(Oe,`${e(f)==="weekly"?"Week 8":e(f)==="monthly"?"Month 8":"Day 8"} Retention`),v(Qe,`${Ie??""}%`)},[()=>e(te).avgWeek1.toFixed(1),()=>e(te).avgWeek4.toFixed(1),()=>e(te).avgWeek8.toFixed(1)]),n(p,_)};z(g,p=>{e(te)&&p(F)})}var P=r(g,2);vt(P,{get data(){return e(l).retention_matrix},get title(){return e(l).name}});var S=r(P,2),T=r(a(S),2),Q=a(T),re=r(a(Q),2),ae=a(re,!0);t(re),t(Q);var $=r(Q,2),U=r(a($),2),d=a(U,!0);t(U),t($);var R=r($,2),N=r(a(R),2),oe=a(N,!0);t(N),t(R);var B=r(R,2),I=r(a(B),2),V=a(I,!0);t(I),t(B),t(T);var Ye=r(T,2);{var qe=p=>{var _=xt(),Y=r(a(_),2),X=a(Y,!0);t(Y),t(_),q(()=>v(X,e(l).description)),n(p,_)};z(Ye,p=>{e(l).description&&p(qe)})}t(S),q((p,_)=>{v(ae,p),v(d,e(l).granularity),v(oe,e(l).retention_matrix.length),v(V,_)},[()=>e(l).type.replace("_"," "),()=>e(l).retention_matrix.reduce((p,_)=>p+_.size,0).toLocaleString()]),n(k,C)};z(L,k=>{e(l)&&k(O)})}n(y,m)};z(h,y=>{e(H).length===0?y(G):y(A,!1)},!0)}n(D,x)};z(W,D=>{e(ee)?D(u):D(E,!1)},!0)}n(o,c)};z(Pe,o=>{e(le)?o(Se):o(Te,!1)})}t(ne);var $e=r(ne,2);{var Ne=o=>{var c=ht(),W=a(c),u=a(W),E=a(u),D=r(a(E),2);D.__click=()=>s(j,!1),t(E),t(u);var x=r(u,2),h=a(x),G=r(a(h),2);xe(G),t(h);var A=r(h,2),y=r(a(A),2);ot(y),it(y,"rows",2),t(A);var m=r(A,2),w=a(m),L=r(a(w),2),O=a(L);O.value=O.__value="signup";var k=r(O);k.value=k.__value="first_purchase";var C=r(k);C.value=C.__value="custom",t(L),t(w);var g=r(w,2),F=r(a(g),2),P=a(F);P.value=P.__value="daily";var S=r(P);S.value=S.__value="weekly";var T=r(S);T.value=T.__value="monthly",t(F),t(g),t(m);var Q=r(m,2);{var re=d=>{var R=ft(),N=a(R),oe=r(a(N),2);xe(oe),t(N);var B=r(N,2),I=r(a(B),2);xe(I),t(B),t(R),ie(oe,()=>e(i).start_event,V=>e(i).start_event=V),ie(I,()=>e(i).return_event,V=>e(i).return_event=V),n(d,R)};z(Q,d=>{e(i).type==="custom"&&d(re)})}t(x);var ae=r(x,2),$=a(ae);$.__click=()=>s(j,!1);var U=r($,2);U.__click=Ee,t(ae),t(W),t(c),q(()=>U.disabled=!e(i).name),ie(G,()=>e(i).name,d=>e(i).name=d),ie(y,()=>e(i).description,d=>e(i).description=d),be(L,()=>e(i).type,d=>e(i).type=d),be(F,()=>e(i).granularity,d=>e(i).granularity=d),n(o,c)};z($e,o=>{e(j)&&o(Ne)})}be(K,()=>e(f),o=>s(f,o)),n(Ae,ye),tt()}Ve(["change","click"]);export{Mt as component};
