import{z as ma,p as ja,s as w,A as I,o as fa,f as h,a9 as ha,d as rt,U as Pt,q as e,bC as ga,c as d,e as i,bT as ya,db as Bt,al as fe,Z as Nt,M as wa,ao as Sa,R as xa,i as C,w as T,bJ as J,g as a,bG as ka,h as p,j as za,as as Aa,x as u,at as Ua,r as t,H as f,bH as M,bV as he,k as ge,N as ye,Q as we,b_ as Se,O as La,_ as Da,n as Ea}from"../chunks/C_QN0JMx.js";import{a as j}from"../chunks/ByEkyPua.js";import{getAuthToken as xe}from"../chunks/D3S43Cfl.js";import{e as q}from"../chunks/DVwXZJLr.js";var $a=h('<div class="bulk-actions svelte-7t4ij7"><span> </span> <button class="btn-danger small svelte-7t4ij7"><!> Delete</button></div>'),Fa=h('<div class="loading-state svelte-7t4ij7"><div class="spinner svelte-7t4ij7"></div> <p>Loading subscribers...</p></div>'),Ca=h('<div class="empty-state svelte-7t4ij7"><!> <h3 class="svelte-7t4ij7">No subscribers found</h3> <p class="svelte-7t4ij7">Add your first subscriber or import from a CSV file</p> <button class="btn-primary svelte-7t4ij7"><!> Add Subscriber</button></div>'),Ra=h('<span class="tag svelte-7t4ij7"> </span>'),Ta=h('<span class="tag more svelte-7t4ij7"> </span>'),Ma=h('<button class="btn-icon small svelte-7t4ij7" title="Unsubscribe"><!></button>'),Pa=h('<button class="btn-icon small svelte-7t4ij7" title="Resubscribe"><!></button>'),Ba=h('<tr class="svelte-7t4ij7"><td class="checkbox-col svelte-7t4ij7"><input type="checkbox"/></td><td class="svelte-7t4ij7"><div class="subscriber-info svelte-7t4ij7"><div class="subscriber-avatar svelte-7t4ij7"> </div> <div><div class="subscriber-name svelte-7t4ij7"> </div> <div class="subscriber-email svelte-7t4ij7"> </div></div></div></td><td class="svelte-7t4ij7"><span> </span></td><td class="svelte-7t4ij7"><div class="tags-list svelte-7t4ij7"><!> <!></div></td><td class="svelte-7t4ij7"><div class="score-bar svelte-7t4ij7"><div class="score-fill svelte-7t4ij7"></div> <span class="svelte-7t4ij7"> </span></div></td><td class="svelte-7t4ij7"> </td><td class="svelte-7t4ij7"> </td><td class="svelte-7t4ij7"><div class="row-actions svelte-7t4ij7"><!> <button class="btn-icon small danger svelte-7t4ij7" title="Delete"><!></button></div></td></tr>'),Na=h('<div class="pagination svelte-7t4ij7"><button class="btn-secondary small svelte-7t4ij7">Previous</button> <span class="page-info svelte-7t4ij7"> </span> <button class="btn-secondary small svelte-7t4ij7">Next</button></div>'),Oa=h('<table class="subscribers-table svelte-7t4ij7"><thead><tr><th class="checkbox-col svelte-7t4ij7"><input type="checkbox"/></th><th class="svelte-7t4ij7">Subscriber</th><th class="svelte-7t4ij7">Status</th><th class="svelte-7t4ij7">Tags</th><th class="svelte-7t4ij7">Email Score</th><th class="svelte-7t4ij7">Subscribed</th><th class="svelte-7t4ij7">Last Activity</th><th class="svelte-7t4ij7"></th></tr></thead><tbody class="svelte-7t4ij7"></tbody></table> <!>',1),Ia=h('<div class="modal-overlay svelte-7t4ij7" role="button" tabindex="0" aria-label="Close modal"><div class="modal-content svelte-7t4ij7" role="dialog" aria-modal="true" tabindex="-1"><div class="modal-header svelte-7t4ij7"><h2 class="svelte-7t4ij7">Add Subscriber</h2> <button class="close-btn svelte-7t4ij7"><!></button></div> <div class="modal-body svelte-7t4ij7"><div class="form-group svelte-7t4ij7"><label for="email" class="svelte-7t4ij7">Email Address *</label> <input id="email" type="email" placeholder="subscriber@example.com" class="svelte-7t4ij7"/></div> <div class="form-row svelte-7t4ij7"><div class="form-group svelte-7t4ij7"><label for="first_name" class="svelte-7t4ij7">First Name</label> <input id="first_name" type="text" class="svelte-7t4ij7"/></div> <div class="form-group svelte-7t4ij7"><label for="last_name" class="svelte-7t4ij7">Last Name</label> <input id="last_name" type="text" class="svelte-7t4ij7"/></div></div> <div class="form-group svelte-7t4ij7"><label for="tags" class="svelte-7t4ij7">Tags (comma-separated)</label> <input id="tags" type="text" placeholder="newsletter, vip" class="svelte-7t4ij7"/></div></div> <div class="modal-footer svelte-7t4ij7"><button class="btn-secondary svelte-7t4ij7">Cancel</button> <button class="btn-primary svelte-7t4ij7"><!> Add Subscriber</button></div></div></div>'),qa=h('<div class="subscribers-page svelte-7t4ij7"><div class="page-header svelte-7t4ij7"><div class="header-content svelte-7t4ij7"><div class="header-title svelte-7t4ij7"><div class="title-icon svelte-7t4ij7"><!></div> <div><h1 class="svelte-7t4ij7">Email Subscribers</h1> <p class="subtitle svelte-7t4ij7">Manage your email audience and subscriber lists</p></div></div> <div class="header-actions svelte-7t4ij7"><button class="btn-secondary svelte-7t4ij7"><!> Export</button> <button class="btn-secondary svelte-7t4ij7"><!> Import</button> <button class="btn-primary svelte-7t4ij7"><!> Add Subscriber</button></div></div></div> <div class="stats-grid svelte-7t4ij7"><div class="stat-card svelte-7t4ij7"><div class="stat-icon blue svelte-7t4ij7"><!></div> <div class="stat-content svelte-7t4ij7"><div class="stat-value svelte-7t4ij7"> </div> <div class="stat-label svelte-7t4ij7">Total Subscribers</div></div></div> <div class="stat-card svelte-7t4ij7"><div class="stat-icon emerald svelte-7t4ij7"><!></div> <div class="stat-content svelte-7t4ij7"><div class="stat-value svelte-7t4ij7"> </div> <div class="stat-label svelte-7t4ij7">Active</div></div></div> <div class="stat-card svelte-7t4ij7"><div class="stat-icon slate svelte-7t4ij7"><!></div> <div class="stat-content svelte-7t4ij7"><div class="stat-value svelte-7t4ij7"> </div> <div class="stat-label svelte-7t4ij7">Unsubscribed</div></div></div> <div class="stat-card svelte-7t4ij7"><div class="stat-icon red svelte-7t4ij7"><!></div> <div class="stat-content svelte-7t4ij7"><div class="stat-value svelte-7t4ij7"> </div> <div class="stat-label svelte-7t4ij7">Bounced</div></div></div></div> <div class="filters-bar svelte-7t4ij7"><div class="search-box svelte-7t4ij7"><!> <input type="text" placeholder="Search by email or name..." class="svelte-7t4ij7"/></div> <div class="filter-group svelte-7t4ij7"><select class="svelte-7t4ij7"><option>All Status</option><option>Subscribed</option><option>Unsubscribed</option><option>Bounced</option><option>Complained</option></select></div> <button class="btn-icon svelte-7t4ij7"><!></button> <!></div> <div class="table-container svelte-7t4ij7"><!></div></div> <!>',1);function Ja(ke,ze){ja(ze,!0);let lt=w(!0),P=w(I([])),vt=w(0),D=w(1),Ot=25,X=w(""),Z=w("all"),It=I([]),o=w(I(new Set)),E=w(!1),Ae=w(!1),_=w(I({email:"",first_name:"",last_name:"",tags:""})),H=w(I({total:0,subscribed:0,unsubscribed:0,bounced:0}));I(["vip","newsletter","trial","customer","lead","inactive"]),fa(async()=>{await U(),await B()});async function U(){d(lt,!0);try{const s={page:a(D),per_page:Ot};a(X)&&(s.search=a(X)),a(Z)!=="all"&&(s.status=a(Z)),It.length>0&&(s.tags=It);const r=await q.getSubscribers(s);d(P,r.subscribers,!0),d(vt,r.total,!0)}catch{j.error("Failed to load subscribers")}finally{d(lt,!1)}}async function B(){try{const s=await fetch("/api/admin/email/subscribers/stats",{headers:{Authorization:`Bearer ${xe()}`}});if(s.ok){const r=await s.json();d(H,r.data||r,!0)}}catch{}}async function Ue(){if(!a(_).email){j.error("Email is required");return}try{const s=a(_).tags.split(",").map(r=>r.trim()).filter(Boolean);await q.createSubscriber({email:a(_).email,first_name:a(_).first_name||void 0,last_name:a(_).last_name||void 0,tags:s}),j.success("Subscriber added successfully"),d(E,!1),d(_,{email:"",first_name:"",last_name:"",tags:""},!0),await U(),await B()}catch(s){j.error(s.message||"Failed to add subscriber")}}async function Le(s){if(confirm("Are you sure you want to delete this subscriber?"))try{await q.deleteSubscriber(s),j.success("Subscriber deleted"),await U(),await B()}catch(r){j.error(r.message||"Failed to delete subscriber")}}async function De(s){try{await q.unsubscribe(s),j.success("Subscriber unsubscribed"),await U(),await B()}catch(r){j.error(r.message||"Failed to unsubscribe")}}async function Ee(s){try{await q.resubscribe(s),j.success("Subscriber resubscribed"),await U(),await B()}catch(r){j.error(r.message||"Failed to resubscribe")}}async function $e(){if(a(o).size!==0&&confirm(`Delete ${a(o).size} selected subscribers?`))try{for(const s of a(o))await q.deleteSubscriber(s);j.success(`Deleted ${a(o).size} subscribers`),d(o,new Set,!0),await U(),await B()}catch(s){j.error(s.message||"Failed to delete subscribers")}}async function Fe(){try{const r=await(await fetch("/api/admin/email/subscribers/export",{headers:{Authorization:`Bearer ${xe()}`}})).blob(),c=window.URL.createObjectURL(r),m=document.createElement("a");m.href=c,m.download=`subscribers-${new Date().toISOString().split("T")[0]}.csv`,m.click(),window.URL.revokeObjectURL(c)}catch{j.error("Failed to export subscribers")}}function Ce(s){a(o).has(s)?a(o).delete(s):a(o).add(s),d(o,a(o),!0)}function Re(){a(o).size===a(P).length?d(o,new Set,!0):d(o,new Set(a(P).map(s=>s.id)),!0)}function Te(s){switch(s){case"subscribed":return"bg-emerald-500/20 text-emerald-400";case"unsubscribed":return"bg-slate-500/20 text-slate-400";case"bounced":return"bg-red-500/20 text-red-400";case"complained":return"bg-yellow-500/20 text-yellow-400";default:return"bg-slate-500/20 text-slate-400"}}function qt(s){return s?new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"-"}function Ht(){d(D,1),U()}function Qt(s){d(D,s,!0),U()}let dt=Ea(()=>Math.ceil(a(vt)/Ot));var Vt=qa();ha("7t4ij7",s=>{Aa(()=>{Ua.title="Email Subscribers | Admin"})});var ot=rt(Vt),ct=e(ot),Gt=e(ct),nt=e(Gt),Jt=e(nt),Me=e(Jt);Pt(Me,{size:28}),t(Jt),f(2),t(nt);var Xt=i(nt,2),K=e(Xt);K.__click=Fe;var Pe=e(K);ga(Pe,{size:18}),f(),t(K);var W=i(K,2);W.__click=()=>d(Ae,!0);var Be=e(W);ya(Be,{size:18}),f(),t(W);var ut=i(W,2);ut.__click=()=>d(E,!0);var Ne=e(ut);Bt(Ne,{size:18}),f(),t(ut),t(Xt),t(Gt),t(ct);var _t=i(ct,2),bt=e(_t),pt=e(bt),Oe=e(pt);Pt(Oe,{size:24}),t(pt);var Zt=i(pt,2),Kt=e(Zt),Ie=e(Kt,!0);t(Kt),f(2),t(Zt),t(bt);var mt=i(bt,2),jt=e(mt),qe=e(jt);fe(qe,{size:24}),t(jt);var Wt=i(jt,2),Yt=e(Wt),He=e(Yt,!0);t(Yt),f(2),t(Wt),t(mt);var ft=i(mt,2),ht=e(ft),Qe=e(ht);Nt(Qe,{size:24}),t(ht);var te=i(ht,2),ee=e(te),Ve=e(ee,!0);t(ee),f(2),t(te),t(ft);var ae=i(ft,2),gt=e(ae),Ge=e(gt);wa(Ge,{size:24}),t(gt);var se=i(gt,2),ie=e(se),Je=e(ie,!0);t(ie),f(2),t(se),t(ae),t(_t);var yt=i(_t,2),wt=e(yt),re=e(wt);Sa(re,{size:18});var St=i(re,2);M(St),St.__keydown=s=>s.key==="Enter"&&Ht(),t(wt);var xt=i(wt,2),Y=e(xt);Y.__change=Ht;var kt=e(Y);kt.value=kt.__value="all";var zt=i(kt);zt.value=zt.__value="subscribed";var At=i(zt);At.value=At.__value="unsubscribed";var Ut=i(At);Ut.value=Ut.__value="bounced";var le=i(Ut);le.value=le.__value="complained",t(Y),t(xt);var tt=i(xt,2);tt.__click=U;var Xe=e(tt);xa(Xe,{size:18}),t(tt);var Ze=i(tt,2);{var Ke=s=>{var r=$a(),c=e(r),m=e(c);t(c);var L=i(c,2);L.__click=$e;var S=e(L);he(S,{size:16}),f(),t(L),t(r),T(()=>u(m,`${a(o).size??""} selected`)),p(s,r)};C(Ze,s=>{a(o).size>0&&s(Ke)})}t(yt);var ve=i(yt,2),We=e(ve);{var Ye=s=>{var r=Fa();p(s,r)},ta=s=>{var r=ge(),c=rt(r);{var m=S=>{var x=Ca(),k=e(x);Pt(k,{size:48,stroke:1});var z=i(k,6);z.__click=()=>d(E,!0);var $=e(z);Bt($,{size:18}),f(),t(z),t(x),p(S,x)},L=S=>{var x=Oa(),k=rt(x),z=e(k),$=e(z),N=e($),O=e(N);M(O),O.__change=Re,t(N),f(7),t($),t(z);var Q=i(z);ye(Q,21,()=>a(P),we,(F,l)=>{var A=Ba(),g=e(A),R=e(g);M(R),R.__change=()=>Ce(a(l).id),t(g);var v=i(g),st=e(v),Lt=e(st),sa=e(Lt,!0);t(Lt);var de=i(Lt,2),Dt=e(de),ia=e(Dt);t(Dt);var oe=i(Dt,2),ra=e(oe,!0);t(oe),t(de),t(st),t(v);var Et=i(v),$t=e(Et),la=e($t,!0);t($t),t(Et);var Ft=i(Et),ce=e(Ft),ne=e(ce);ye(ne,17,()=>a(l).tags.slice(0,3),we,(b,n)=>{var y=Ra(),V=e(y,!0);t(y),T(()=>u(V,a(n))),p(b,y)});var va=i(ne,2);{var da=b=>{var n=Ta(),y=e(n);t(n),T(()=>u(y,`+${a(l).tags.length-3}`)),p(b,n)};C(va,b=>{a(l).tags.length>3&&b(da)})}t(ce),t(Ft);var Ct=i(Ft),ue=e(Ct),_e=e(ue),be=i(_e,2),oa=e(be,!0);t(be),t(ue),t(Ct);var Rt=i(Ct),ca=e(Rt,!0);t(Rt);var Tt=i(Rt),na=e(Tt,!0);t(Tt);var pe=i(Tt),me=e(pe),je=e(me);{var ua=b=>{var n=Ma();n.__click=()=>De(a(l).id);var y=e(n);Nt(y,{size:16}),t(n),p(b,n)},_a=b=>{var n=ge(),y=rt(n);{var V=G=>{var it=Pa();it.__click=()=>Ee(a(l).id);var pa=e(it);fe(pa,{size:16}),t(it),p(G,it)};C(y,G=>{a(l).status==="unsubscribed"&&G(V)},!0)}p(b,n)};C(je,b=>{a(l).status==="subscribed"?b(ua):b(_a,!1)})}var Mt=i(je,2);Mt.__click=()=>Le(a(l).id);var ba=e(Mt);he(ba,{size:16}),t(Mt),t(me),t(pe),t(A),T((b,n,y,V,G)=>{Se(R,b),u(sa,n),u(ia,`${(a(l).first_name||"")??""} ${(a(l).last_name||"")??""}`),u(ra,a(l).email),La($t,1,`status-badge ${y??""}`,"svelte-7t4ij7"),u(la,a(l).status),Da(_e,`width: ${a(l).email_score??""}%`),u(oa,a(l).email_score),u(ca,V),u(na,G)},[()=>a(o).has(a(l).id),()=>(a(l).first_name?.[0]||a(l).email[0]).toUpperCase(),()=>Te(a(l).status),()=>qt(a(l).subscribed_at),()=>qt(a(l).last_opened_at||a(l).last_clicked_at)]),p(F,A)}),t(Q),t(k);var et=i(k,2);{var at=F=>{var l=Na(),A=e(l);A.__click=()=>Qt(a(D)-1);var g=i(A,2),R=e(g);t(g);var v=i(g,2);v.__click=()=>Qt(a(D)+1),t(l),T(st=>{A.disabled=a(D)===1,u(R,`Page ${a(D)??""} of ${a(dt)??""} (${st??""} total)`),v.disabled=a(D)===a(dt)},[()=>a(vt).toLocaleString()]),p(F,l)};C(et,F=>{a(dt)>1&&F(at)})}T(()=>Se(O,a(o).size===a(P).length)),p(S,x)};C(c,S=>{a(P).length===0?S(m):S(L,!1)},!0)}p(s,r)};C(We,s=>{a(lt)?s(Ye):s(ta,!1)})}t(ve),t(ot);var ea=i(ot,2);{var aa=s=>{var r=Ia();r.__click=()=>d(E,!1),r.__keydown=v=>{(v.key==="Escape"||v.key==="Enter"||v.key===" ")&&d(E,!1)};var c=e(r);c.__click=v=>v.stopPropagation(),c.__keydown=v=>v.stopPropagation();var m=e(c),L=i(e(m),2);L.__click=()=>d(E,!1);var S=e(L);Nt(S,{size:20}),t(L),t(m);var x=i(m,2),k=e(x),z=i(e(k),2);M(z),t(k);var $=i(k,2),N=e($),O=i(e(N),2);M(O),t(N);var Q=i(N,2),et=i(e(Q),2);M(et),t(Q),t($);var at=i($,2),F=i(e(at),2);M(F),t(at),t(x);var l=i(x,2),A=e(l);A.__click=()=>d(E,!1);var g=i(A,2);g.__click=Ue;var R=e(g);Bt(R,{size:18}),f(),t(g),t(l),t(c),t(r),J(z,()=>a(_).email,v=>a(_).email=v),J(O,()=>a(_).first_name,v=>a(_).first_name=v),J(et,()=>a(_).last_name,v=>a(_).last_name=v),J(F,()=>a(_).tags,v=>a(_).tags=v),p(s,r)};C(ea,s=>{a(E)&&s(aa)})}T((s,r,c,m)=>{u(Ie,s),u(He,r),u(Ve,c),u(Je,m)},[()=>a(H).total.toLocaleString(),()=>a(H).subscribed.toLocaleString(),()=>a(H).unsubscribed.toLocaleString(),()=>a(H).bounced.toLocaleString()]),J(St,()=>a(X),s=>d(X,s)),ka(Y,()=>a(Z),s=>d(Z,s)),p(ke,Vt),za()}ma(["click","keydown","change"]);export{Ja as component};
