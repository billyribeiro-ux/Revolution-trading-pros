import{z as Bs,p as Gs,s as f,A as Vt,o as Ls,f as $,a9 as Ns,d as ee,F as Is,q as a,aM as Js,a2 as Xt,e as s,R as Hs,i as D,h as z,j as qs,c as i,as as Zs,at as Ks,H as g,r as e,g as t,k as Qs,Z as Vs,M as qe,aZ as Yt,cX as Xs,U as Ys,aF as Pa,w as te,x as r,O as ae,al as Wt,cY as Ws,aH as ev,bx as tv,cZ as Ze,bA as av,c_ as sv,ao as vv,bH as se,ay as iv,n as ea,_ as Ke,bJ as we,bG as rv,bI as cv,K as nv,N as lv,b_ as Da,Q as dv,c$ as ov}from"../chunks/C_QN0JMx.js";import{authStore as pv}from"../chunks/D3S43Cfl.js";import{a as xe}from"../chunks/ByEkyPua.js";const H="/api/admin/abandoned-carts";async function q(){const p=pv.getToken(),y={"Content-Type":"application/json",Accept:"application/json"};return p&&(y.Authorization=`Bearer ${p}`),y}async function _v(){const p=await fetch(`${H}/dashboard`,{method:"GET",headers:await q(),credentials:"include"});if(!p.ok)throw new Error("Failed to fetch dashboard stats");return p.json()}async function uv(p=1,y=20,o={}){const l=new URLSearchParams({page:p.toString(),per_page:y.toString()});o.status&&l.append("status",o.status),o.search&&l.append("search",o.search),o.min_value&&l.append("min_value",o.min_value.toString()),o.abandoned_after&&l.append("abandoned_after",o.abandoned_after),o.abandoned_before&&l.append("abandoned_before",o.abandoned_before);const h=await fetch(`${H}?${l}`,{method:"GET",headers:await q(),credentials:"include"});if(!h.ok)throw new Error("Failed to fetch abandoned carts");return h.json()}async function yv(p){const y=await fetch(`${H}/${p}`,{method:"GET",headers:await q(),credentials:"include"});if(!y.ok)throw new Error("Failed to fetch abandoned cart");return y.json()}async function kv(){const p=await fetch(`${H}/templates`,{method:"GET",headers:await q(),credentials:"include"});if(!p.ok)throw new Error("Failed to fetch recovery templates");return p.json()}async function mv(p,y={template:"reminder_1"}){const o=await fetch(`${H}/${p}/send-recovery`,{method:"POST",headers:await q(),credentials:"include",body:JSON.stringify(y)});if(!o.ok){const l=await o.json().catch(()=>({message:"Failed to send recovery email"}));throw new Error(l.message||"Failed to send recovery email")}return o.json()}async function bv(p,y={template:"reminder_1"}){const o=await fetch(`${H}/bulk-recovery`,{method:"POST",headers:await q(),credentials:"include",body:JSON.stringify({cart_ids:p,...y})});if(!o.ok){const l=await o.json().catch(()=>({message:"Failed to send bulk recovery"}));throw new Error(l.message||"Failed to send bulk recovery")}return o.json()}async function gv(p,y){const o=await fetch(`${H}/${p}/mark-recovered`,{method:"POST",headers:await q(),credentials:"include",body:JSON.stringify({notes:y})});if(!o.ok)throw new Error("Failed to mark cart as recovered");return o.json()}async function hv(p){const y=await fetch("/api/cart/abandoned",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify(p)});if(!y.ok)throw new Error("Failed to report abandoned cart");return y.json()}const Ma={pending:"Pending",email_sent:"Email Sent",clicked:"Clicked",recovered:"Recovered",expired:"Expired",unsubscribed:"Unsubscribed"},fv={pending:"warning",email_sent:"info",clicked:"primary",recovered:"success",expired:"neutral",unsubscribed:"neutral"},Se={getDashboardStats:_v,getAbandonedCarts:uv,getAbandonedCart:yv,getRecoveryTemplates:kv,sendRecoveryEmail:mv,sendBulkRecovery:bv,markAsRecovered:gv,reportAbandonedCart:hv,STATUS_LABELS:Ma,STATUS_COLORS:fv};var wv=$('<div class="loading-state svelte-1kypvce"><div class="loader svelte-1kypvce"></div> <p>Loading recovery dashboard...</p></div>'),xv=$('<button class="btn-selected svelte-1kypvce"><!> </button>'),Sv=$('<div class="empty-state svelte-1kypvce"><!> <h3 class="svelte-1kypvce">No abandoned carts</h3> <p>Great! No abandoned carts matching your filters.</p></div>'),zv=$('<button class="action-btn send svelte-1kypvce" title="Send Recovery Email"><!></button> <button class="action-btn recover svelte-1kypvce" title="Mark as Recovered"><!></button>',1),Cv=$('<tr><td class="checkbox-col svelte-1kypvce"><input type="checkbox" class="svelte-1kypvce"/></td><td class="svelte-1kypvce"><div class="customer-info svelte-1kypvce"><div class="customer-avatar svelte-1kypvce"> </div> <div class="customer-details"><div class="customer-name svelte-1kypvce"> </div> <div class="customer-email svelte-1kypvce"> </div></div></div></td><td class="svelte-1kypvce"><span class="cart-value svelte-1kypvce"> </span></td><td class="svelte-1kypvce"><span class="item-count svelte-1kypvce"> </span></td><td class="svelte-1kypvce"><span> </span></td><td class="svelte-1kypvce"><div class="abandoned-info svelte-1kypvce"><span class="time-ago svelte-1kypvce"> </span> <span class="date-full svelte-1kypvce"> </span></div></td><td class="svelte-1kypvce"><span class="attempts-badge svelte-1kypvce"> </span></td><td class="svelte-1kypvce"><div class="actions svelte-1kypvce"><!></div></td></tr>'),$v=$('<table class="carts-table svelte-1kypvce"><thead class="svelte-1kypvce"><tr><th class="checkbox-col svelte-1kypvce"><input type="checkbox" class="svelte-1kypvce"/></th><th class="svelte-1kypvce">Customer</th><th class="svelte-1kypvce">Cart Value</th><th class="svelte-1kypvce">Items</th><th class="svelte-1kypvce">Status</th><th class="svelte-1kypvce">Abandoned</th><th class="svelte-1kypvce">Attempts</th><th class="svelte-1kypvce">Actions</th></tr></thead><tbody class="svelte-1kypvce"></tbody></table> <div class="pagination svelte-1kypvce"><div class="pagination-info svelte-1kypvce"> </div> <div class="pagination-controls svelte-1kypvce"><button class="page-btn svelte-1kypvce"><!></button> <span class="page-indicator svelte-1kypvce"> </span> <button class="page-btn svelte-1kypvce"><!></button></div></div>',1),Ev=$('<div class="metrics-grid svelte-1kypvce"><div class="metric-card total svelte-1kypvce"><div class="metric-icon svelte-1kypvce"><!></div> <div class="metric-content"><div class="metric-label svelte-1kypvce">Total Abandoned</div> <div class="metric-value svelte-1kypvce"> </div> <div class="metric-secondary svelte-1kypvce"> </div></div></div> <div class="metric-card recovered svelte-1kypvce"><div class="metric-icon svelte-1kypvce"><!></div> <div class="metric-content"><div class="metric-label svelte-1kypvce">Recovered</div> <div class="metric-value svelte-1kypvce"> </div> <div class="metric-secondary svelte-1kypvce"> </div></div> <div class="metric-badge success svelte-1kypvce"> </div></div> <div class="metric-card pending svelte-1kypvce"><div class="metric-icon svelte-1kypvce"><!></div> <div class="metric-content"><div class="metric-label svelte-1kypvce">Pending Recovery</div> <div class="metric-value svelte-1kypvce"> </div> <div class="metric-secondary svelte-1kypvce">Awaiting action</div></div></div> <div class="metric-card average svelte-1kypvce"><div class="metric-icon svelte-1kypvce"><!></div> <div class="metric-content"><div class="metric-label svelte-1kypvce">Avg Cart Value</div> <div class="metric-value svelte-1kypvce"> </div> <div class="metric-secondary svelte-1kypvce">Per abandoned cart</div></div></div></div> <div class="pipeline-section svelte-1kypvce"><div class="section-header svelte-1kypvce"><!> <h3 class="svelte-1kypvce">Recovery Pipeline</h3></div> <div class="pipeline-stages svelte-1kypvce"><div class="pipeline-stage svelte-1kypvce"><div class="stage-icon pending svelte-1kypvce"><!></div> <div class="stage-info svelte-1kypvce"><div class="stage-count svelte-1kypvce"> </div> <div class="stage-label svelte-1kypvce">Pending</div></div> <div class="stage-bar svelte-1kypvce"><div class="stage-fill pending svelte-1kypvce"></div></div></div> <div class="pipeline-connector svelte-1kypvce"><!></div> <div class="pipeline-stage svelte-1kypvce"><div class="stage-icon sent svelte-1kypvce"><!></div> <div class="stage-info svelte-1kypvce"><div class="stage-count svelte-1kypvce"> </div> <div class="stage-label svelte-1kypvce">Email Sent</div></div> <div class="stage-bar svelte-1kypvce"><div class="stage-fill sent svelte-1kypvce"></div></div></div> <div class="pipeline-connector svelte-1kypvce"><!></div> <div class="pipeline-stage svelte-1kypvce"><div class="stage-icon clicked svelte-1kypvce"><!></div> <div class="stage-info svelte-1kypvce"><div class="stage-count svelte-1kypvce"> </div> <div class="stage-label svelte-1kypvce">Clicked</div></div> <div class="stage-bar svelte-1kypvce"><div class="stage-fill clicked svelte-1kypvce"></div></div></div> <div class="pipeline-connector svelte-1kypvce"><!></div> <div class="pipeline-stage svelte-1kypvce"><div class="stage-icon recovered svelte-1kypvce"><!></div> <div class="stage-info svelte-1kypvce"><div class="stage-count svelte-1kypvce"> </div> <div class="stage-label svelte-1kypvce">Recovered</div></div> <div class="stage-bar svelte-1kypvce"><div class="stage-fill recovered svelte-1kypvce"></div></div></div></div></div> <div class="quick-actions svelte-1kypvce"><button class="action-card reminder svelte-1kypvce"><div class="action-icon svelte-1kypvce"><!></div> <div class="action-content svelte-1kypvce"><h4 class="svelte-1kypvce">Send First Reminder</h4> <p class="svelte-1kypvce">Gentle nudge to pending carts</p></div> <div class="action-count svelte-1kypvce"> </div></button> <button class="action-card urgency svelte-1kypvce"><div class="action-icon svelte-1kypvce"><!></div> <div class="action-content svelte-1kypvce"><h4 class="svelte-1kypvce">Send Urgency Email</h4> <p class="svelte-1kypvce">Follow up with sent carts</p></div> <div class="action-count svelte-1kypvce"> </div></button> <button class="action-card discount svelte-1kypvce"><div class="action-icon svelte-1kypvce"><!></div> <div class="action-content svelte-1kypvce"><h4 class="svelte-1kypvce">Final Discount Offer</h4> <p class="svelte-1kypvce">Last chance with special pricing</p></div> <div class="action-count svelte-1kypvce"> </div></button></div> <div class="toolbar svelte-1kypvce"><div class="search-box svelte-1kypvce"><!> <input type="text" placeholder="Search by email..." class="svelte-1kypvce"/></div> <div class="filter-group svelte-1kypvce"><!> <select class="svelte-1kypvce"><option>All Status</option><option>Pending</option><option>Email Sent</option><option>Clicked</option><option>Recovered</option><option>Expired</option></select></div> <!></div> <div class="carts-table-container svelte-1kypvce"><!></div>',1),Av=$('<div class="discount-settings svelte-1kypvce"><div class="form-group svelte-1kypvce"><label for="discount-percent" class="svelte-1kypvce">Discount Percentage</label> <div class="discount-slider svelte-1kypvce"><input id="discount-percent" type="range" min="5" max="30" step="5" class="svelte-1kypvce"/> <span class="discount-value svelte-1kypvce"> </span></div></div> <div class="form-group svelte-1kypvce"><label for="discount-code" class="svelte-1kypvce">Discount Code</label> <input id="discount-code" type="text" placeholder="e.g., COMEBACK15" class="svelte-1kypvce"/></div></div>'),Rv=$('<div class="form-group svelte-1kypvce"><label for="custom-subject" class="svelte-1kypvce">Subject Line</label> <input id="custom-subject" type="text" placeholder="Enter email subject..." class="svelte-1kypvce"/></div> <div class="form-group svelte-1kypvce"><label for="custom-body" class="svelte-1kypvce">Email Body</label> <textarea id="custom-body" rows="8" class="svelte-1kypvce"></textarea></div>',1),Fv=$('<div class="modal-overlay svelte-1kypvce" role="button" tabindex="0" aria-label="Close modal"><div class="modal-content svelte-1kypvce" role="dialog" aria-modal="true" tabindex="-1"><div class="modal-header svelte-1kypvce"><div><h2 class="svelte-1kypvce">Send Recovery Email</h2> <p class="svelte-1kypvce"> </p></div> <button class="close-btn svelte-1kypvce"><!></button></div> <div class="modal-body svelte-1kypvce"><div class="template-selector svelte-1kypvce"><span class="selector-label svelte-1kypvce">Choose Email Type</span> <div class="template-grid svelte-1kypvce"><button><!> <span class="template-name svelte-1kypvce">First Reminder</span> <span class="template-timing svelte-1kypvce">1 hour</span></button> <button><!> <span class="template-name svelte-1kypvce">Urgency</span> <span class="template-timing svelte-1kypvce">24 hours</span></button> <button><!> <span class="template-name svelte-1kypvce">Final Discount</span> <span class="template-timing svelte-1kypvce">72 hours</span></button> <button><!> <span class="template-name svelte-1kypvce">Custom</span> <span class="template-timing svelte-1kypvce">Anytime</span></button></div></div> <div class="template-preview svelte-1kypvce"><div class="preview-header svelte-1kypvce">Template Info</div> <div class="preview-name svelte-1kypvce"> </div> <div class="preview-desc svelte-1kypvce"> </div> <div class="preview-timing svelte-1kypvce"> </div></div> <!> <!></div> <div class="modal-footer svelte-1kypvce"><button class="btn-secondary svelte-1kypvce">Cancel</button> <button class="btn-primary svelte-1kypvce"><!> </button></div></div></div>'),Tv=$('<div class="abandoned-cart-page svelte-1kypvce"><div class="page-header"><button class="back-btn svelte-1kypvce"><!> Back to Dashboard</button> <div class="header-content svelte-1kypvce"><div class="header-title svelte-1kypvce"><div class="title-icon svelte-1kypvce"><!></div> <div><h1 class="svelte-1kypvce">Cart Recovery Center</h1> <p class="svelte-1kypvce">Recover lost revenue with automated email sequences</p></div></div> <button class="btn-refresh svelte-1kypvce"><!> Refresh</button></div></div> <!></div> <!>',1);function Mv(p,y){Gs(y,!0);let o=f(!0),l=f(null),h=f(Vt([])),m=f(Vt({current_page:1,last_page:1,per_page:20,total:0})),ze=f(""),Z=f(""),c=f(Vt(new Set)),C=f(!1),_=f("reminder_1"),ve=f(""),ie=f(""),Ce=f(""),$e=f(15),Ee=f(!1);Ls(async()=>{await Ae()});async function Ae(){i(o,!0);try{const[v,d]=await Promise.all([Se.getDashboardStats(),Se.getAbandonedCarts()]);i(l,v,!0),i(h,d.data,!0),i(m,{current_page:d.current_page,last_page:d.last_page,per_page:d.per_page,total:d.total},!0)}catch{xe.error("Failed to load abandoned carts data")}finally{i(o,!1)}}async function Re(v=1){try{const d={};t(Z)&&(d.status=t(Z)),t(ze)&&(d.search=t(ze));const b=await Se.getAbandonedCarts(v,t(m).per_page,d);i(h,b.data,!0),i(m,{current_page:b.current_page,last_page:b.last_page,per_page:b.per_page,total:b.total},!0)}catch{}}async function Oa(){await Re()}async function Ua(v){i(Z,v,!0),await Re()}function Ba(v){t(c).has(v)?t(c).delete(v):t(c).add(v),i(c,t(c),!0)}function Ga(){t(c).size===t(h).length?t(c).clear():t(h).forEach(v=>t(c).add(v.id)),i(c,t(c),!0)}async function La(){if(t(c).size!==0){i(Ee,!0);try{const v={template:t(_)};t(_)==="custom"&&t(ve)&&(v.custom_subject=t(ve)),t(_)==="custom"&&t(ie)&&(v.custom_body=t(ie)),t(_)==="final_discount"&&t(Ce)&&(v.discount_code=t(Ce)),t(_)==="final_discount"&&(v.discount_percent=t($e));const d=await Se.sendBulkRecovery(Array.from(t(c)),v);xe.success(d.message),i(C,!1),t(c).clear(),i(c,t(c),!0),await Ae()}catch(v){xe.error(v instanceof Error?v.message:"Failed to send recovery emails")}finally{i(Ee,!1)}}}async function Na(v){try{await Se.markAsRecovered(v),xe.success("Cart marked as recovered"),await Ae()}catch{xe.error("Failed to mark as recovered")}}function Fe(v){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2}).format(v)}function Ia(v){return v?new Date(v).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}function Ja(v){const d=Date.now()-new Date(v).getTime(),b=Math.floor(d/(1e3*60*60)),j=Math.floor(b/24);return j>0?`${j}d ago`:b>0?`${b}h ago`:"Just now"}function Ha(v){return{pending:"status-warning",email_sent:"status-info",clicked:"status-primary",recovered:"status-success",expired:"status-neutral",unsubscribed:"status-neutral"}[v]||"status-neutral"}function Qe(v){switch(v){case"reminder_1":return{name:"First Reminder",description:"Gentle nudge about items left behind",timing:"Best sent 1 hour after abandonment"};case"reminder_2":return{name:"Second Reminder",description:"Highlight product benefits and urgency",timing:"Best sent 24 hours after abandonment"};case"final_discount":return{name:"Final Discount",description:"Last chance offer with exclusive discount",timing:"Best sent 72 hours after abandonment"};default:return{name:"Custom Email",description:"Your personalized recovery message",timing:"Send anytime"}}}let Ve=ea(()=>t(l)?.by_status?.pending||0),Te=ea(()=>t(l)?.by_status?.email_sent||0),Xe=ea(()=>t(l)?.by_status?.clicked||0);var ta=Tv();Ns("1kypvce",v=>{Zs(()=>{Ks.title="Abandoned Cart Recovery | Revolution Trading Pros"})});var Ye=ee(ta),We=a(Ye),je=a(We);je.__click=()=>Is("/admin/dashboard");var qa=a(je);Js(qa,{size:20}),g(),e(je);var aa=s(je,2),et=a(aa),sa=a(et),Za=a(sa);Xt(Za,{size:32}),e(sa),g(2),e(et);var tt=s(et,2);tt.__click=Ae;var Ka=a(tt);Hs(Ka,{size:18}),g(),e(tt),e(aa),e(We);var Qa=s(We,2);{var Va=v=>{var d=wv();z(v,d)},Xa=v=>{var d=Qs(),b=ee(d);{var j=M=>{var re=Ev(),ce=ee(re),O=a(ce),ne=a(O),le=a(ne);Xt(le,{size:28}),e(ne);var K=s(ne,2),Q=s(a(K),2),U=a(Q,!0);e(Q);var de=s(Q,2),at=a(de);e(de),e(K),e(O);var R=s(O,2),V=a(R),st=a(V);Wt(st,{size:28}),e(V);var F=s(V,2),X=s(a(F),2),vt=a(X,!0);e(X);var B=s(X,2),Pe=a(B);e(B),e(F);var De=s(F,2),oe=a(De);e(De),e(R);var G=s(R,2),pe=a(G),_e=a(pe);Yt(_e,{size:28}),e(pe);var Me=s(pe,2),ue=s(a(Me),2),it=a(ue,!0);e(ue),g(2),e(Me),e(G);var ye=s(G,2),ke=a(ye),rt=a(ke);Ws(rt,{size:28}),e(ke);var Oe=s(ke,2),me=s(a(Oe),2),Ue=a(me,!0);e(me),g(2),e(Oe),e(ye),e(ce);var P=s(ce,2),Y=a(P),ct=a(Y);ev(ct,{size:20}),g(2),e(Y);var u=s(Y,2),S=a(u),w=a(S),L=a(w);tv(L,{size:24}),e(w);var E=s(w,2),T=a(E),N=a(T,!0);e(T),g(2),e(E);var be=s(E,2),Be=a(be);e(be),e(S);var I=s(S,2),es=a(I);Ze(es,{size:20}),e(I);var nt=s(I,2),lt=a(nt),ts=a(lt);qe(ts,{size:24}),e(lt);var dt=s(lt,2),va=a(dt),as=a(va,!0);e(va),g(2),e(dt);var ia=s(dt,2),ss=a(ia);e(ia),e(nt);var ot=s(nt,2),vs=a(ot);Ze(vs,{size:20}),e(ot);var pt=s(ot,2),_t=a(pt),is=a(_t);av(is,{size:24}),e(_t);var ut=s(_t,2),ra=a(ut),rs=a(ra,!0);e(ra),g(2),e(ut);var ca=s(ut,2),cs=a(ca);e(ca),e(pt);var yt=s(pt,2),ns=a(yt);Ze(ns,{size:20}),e(yt);var na=s(yt,2),kt=a(na),ls=a(kt);Wt(ls,{size:24}),e(kt);var mt=s(kt,2),la=a(mt),ds=a(la,!0);e(la),g(2),e(mt);var da=s(mt,2),os=a(da);e(da),e(na),e(u),e(P);var bt=s(P,2),Ge=a(bt);Ge.__click=()=>{i(_,"reminder_1"),i(c,new Set(t(h).filter(n=>n.status==="pending").map(n=>n.id)),!0),i(C,!0)};var gt=a(Ge),ps=a(gt);qe(ps,{size:24}),e(gt);var oa=s(gt,4),_s=a(oa);e(oa),e(Ge);var Le=s(Ge,2);Le.__click=()=>{i(_,"reminder_2"),i(c,new Set(t(h).filter(n=>n.status==="email_sent").map(n=>n.id)),!0),i(C,!0)};var ht=a(Le),us=a(ht);Yt(us,{size:24}),e(ht);var pa=s(ht,4),ys=a(pa);e(pa),e(Le);var ft=s(Le,2);ft.__click=()=>{i(_,"final_discount"),i(c,new Set(t(h).filter(n=>n.status==="email_sent"||n.status==="clicked").map(n=>n.id)),!0),i(C,!0)};var wt=a(ft),ks=a(wt);sv(ks,{size:24}),e(wt);var _a=s(wt,4),ms=a(_a);e(_a),e(ft),e(bt);var xt=s(bt,2),St=a(xt),ua=a(St);vv(ua,{size:18});var zt=s(ua,2);se(zt),zt.__keydown=n=>n.key==="Enter"&&Oa(),e(St);var Ct=s(St,2),ya=a(Ct);iv(ya,{size:16});var Ne=s(ya,2);Ne.__change=()=>Ua(t(Z));var $t=a(Ne);$t.value=$t.__value="";var Et=s($t);Et.value=Et.__value="pending";var At=s(Et);At.value=At.__value="email_sent";var Rt=s(At);Rt.value=Rt.__value="clicked";var Ft=s(Rt);Ft.value=Ft.__value="recovered";var ka=s(Ft);ka.value=ka.__value="expired",e(Ne),e(Ct);var bs=s(Ct,2);{var gs=n=>{var x=xv();x.__click=()=>i(C,!0);var A=a(x);Pa(A,{size:18});var J=s(A);e(x),te(()=>r(J,` Send Recovery (${t(c).size??""})`)),z(n,x)};D(bs,n=>{t(c).size>0&&n(gs)})}e(xt);var ma=s(xt,2),hs=a(ma);{var fs=n=>{var x=Sv(),A=a(x);Xt(A,{size:64,stroke:1}),g(4),e(x),z(n,x)},ws=n=>{var x=$v(),A=ee(x),J=a(A),ba=a(J),ga=a(ba),Tt=a(ga);se(Tt),Tt.__change=Ga,e(ga),g(7),e(ba),e(J);var ha=s(J);lv(ha,21,()=>t(h),dv,(Dt,k)=>{var Je=Cv();let xa;var Mt=a(Je),Ot=a(Mt);se(Ot),Ot.__change=()=>Ba(t(k).id),e(Mt);var Ut=s(Mt),Sa=a(Ut),Bt=a(Sa),$s=a(Bt,!0);e(Bt);var za=s(Bt,2),Gt=a(za),Es=a(Gt,!0);e(Gt);var Ca=s(Gt,2),As=a(Ca,!0);e(Ca),e(za),e(Sa),e(Ut);var Lt=s(Ut),$a=a(Lt),Rs=a($a,!0);e($a),e(Lt);var Nt=s(Lt),Ea=a(Nt),Fs=a(Ea);e(Ea),e(Nt);var It=s(Nt),Jt=a(It),Ts=a(Jt,!0);e(Jt),e(It);var Ht=s(It),Aa=a(Ht),qt=a(Aa),js=a(qt,!0);e(qt);var Ra=s(qt,2),Ps=a(Ra,!0);e(Ra),e(Aa),e(Ht);var Zt=s(Ht),Fa=a(Zt),Ds=a(Fa,!0);e(Fa),e(Zt);var Ta=s(Zt),ja=a(Ta),Ms=a(ja);{var Os=he=>{var He=zv(),W=ee(He);W.__click=()=>{t(c).clear(),t(c).add(t(k).id),i(c,t(c),!0),i(C,!0)};var Kt=a(W);qe(Kt,{size:16}),e(W);var fe=s(W,2);fe.__click=()=>Na(t(k).id);var Qt=a(fe);Wt(Qt,{size:16}),e(fe),z(he,He)};D(Ms,he=>{t(k).status!=="recovered"&&he(Os)})}e(ja),e(Ta),e(Je),te((he,He,W,Kt,fe,Qt,Us)=>{xa=ae(Je,1,"svelte-1kypvce",null,xa,he),Da(Ot,He),r($s,W),r(Es,t(k).user_name||"Guest"),r(As,t(k).user_email||"No email"),r(Rs,Kt),r(Fs,`${(t(k).cart_data?.items?.length||0)??""} items`),ae(Jt,1,`status-badge ${fe??""}`,"svelte-1kypvce"),r(Ts,Ma[t(k).status]),r(js,Qt),r(Ps,Us),r(Ds,t(k).recovery_attempts)},[()=>({selected:t(c).has(t(k).id)}),()=>t(c).has(t(k).id),()=>t(k).user_email?t(k).user_email.slice(0,2).toUpperCase():"G",()=>Fe(t(k).cart_value),()=>Ha(t(k).status),()=>Ja(t(k).abandoned_at),()=>Ia(t(k).abandoned_at)]),z(Dt,Je)}),e(ha),e(A);var fa=s(A,2),jt=a(fa),xs=a(jt);e(jt);var wa=s(jt,2),ge=a(wa);ge.__click=()=>Re(t(m).current_page-1);var Ss=a(ge);ov(Ss,{size:18}),e(ge);var Pt=s(ge,2),zs=a(Pt);e(Pt);var Ie=s(Pt,2);Ie.__click=()=>Re(t(m).current_page+1);var Cs=a(Ie);Ze(Cs,{size:18}),e(Ie),e(wa),e(fa),te(Dt=>{Da(Tt,t(c).size===t(h).length&&t(h).length>0),r(xs,`Showing ${(t(m).current_page-1)*t(m).per_page+1} to ${Dt??""} of ${t(m).total??""}`),ge.disabled=t(m).current_page===1,r(zs,`Page ${t(m).current_page??""} of ${t(m).last_page??""}`),Ie.disabled=t(m).current_page===t(m).last_page},[()=>Math.min(t(m).current_page*t(m).per_page,t(m).total)]),z(n,x)};D(hs,n=>{t(h).length===0?n(fs):n(ws,!1)})}e(ma),te((n,x,A,J)=>{r(U,t(l).total_abandoned),r(at,`${n??""} value`),r(vt,t(l).recovered_count),r(Pe,`${x??""} recovered`),r(oe,`${A??""}%`),r(it,t(l).pending_recovery),r(Ue,J),r(N,t(Ve)),Ke(Be,`--width: ${t(Ve)/t(l).total_abandoned*100}%`),r(as,t(Te)),Ke(ss,`--width: ${t(Te)/t(l).total_abandoned*100}%`),r(rs,t(Xe)),Ke(cs,`--width: ${t(Xe)/t(l).total_abandoned*100}%`),r(ds,t(l).recovered_count),Ke(os,`--width: ${t(l).recovered_count/t(l).total_abandoned*100}%`),r(_s,`${t(Ve)??""} carts`),r(ys,`${t(Te)??""} carts`),r(ms,`${t(Te)+t(Xe)} carts`)},[()=>Fe(t(l).total_value),()=>Fe(t(l).recovered_value),()=>t(l).recovery_rate.toFixed(1),()=>Fe(t(l).avg_cart_value)]),we(zt,()=>t(ze),n=>i(ze,n)),rv(Ne,()=>t(Z),n=>i(Z,n)),z(M,re)};D(b,M=>{t(l)&&M(j)},!0)}z(v,d)};D(Qa,v=>{t(o)?v(Va):v(Xa,!1)})}e(Ye);var Ya=s(Ye,2);{var Wa=v=>{var d=Fv();d.__click=()=>i(C,!1),d.__keydown=u=>{(u.key==="Escape"||u.key==="Enter"||u.key===" ")&&i(C,!1)};var b=a(d);b.__click=u=>u.stopPropagation(),b.__keydown=u=>u.stopPropagation();var j=a(b),M=a(j),re=s(a(M),2),ce=a(re);e(re),e(M);var O=s(M,2);O.__click=()=>i(C,!1);var ne=a(O);Vs(ne,{size:20}),e(O),e(j);var le=s(j,2),K=a(le),Q=s(a(K),2),U=a(Q);let de;U.__click=()=>i(_,"reminder_1");var at=a(U);qe(at,{size:24}),g(4),e(U);var R=s(U,2);let V;R.__click=()=>i(_,"reminder_2");var st=a(R);Yt(st,{size:24}),g(4),e(R);var F=s(R,2);let X;F.__click=()=>i(_,"final_discount");var vt=a(F);Xs(vt,{size:24}),g(4),e(F);var B=s(F,2);let Pe;B.__click=()=>i(_,"custom");var De=a(B);Ys(De,{size:24}),g(4),e(B),e(Q),e(K);var oe=s(K,2),G=s(a(oe),2),pe=a(G,!0);e(G);var _e=s(G,2),Me=a(_e,!0);e(_e);var ue=s(_e,2),it=a(ue,!0);e(ue),e(oe);var ye=s(oe,2);{var ke=u=>{var S=Av(),w=a(S),L=s(a(w),2),E=a(L);se(E);var T=s(E,2),N=a(T);e(T),e(L),e(w);var be=s(w,2),Be=s(a(be),2);se(Be),e(be),e(S),te(()=>r(N,`${t($e)??""}%`)),we(E,()=>t($e),I=>i($e,I)),we(Be,()=>t(Ce),I=>i(Ce,I)),z(u,S)};D(ye,u=>{t(_)==="final_discount"&&u(ke)})}var rt=s(ye,2);{var Oe=u=>{var S=Rv(),w=ee(S),L=s(a(w),2);se(L),e(w);var E=s(w,2),T=s(a(E),2);cv(T),nv(T,"placeholder","Enter email body... Use {{name}}, {{cart_items}}, {{cart_total}} for personalization"),e(E),we(L,()=>t(ve),N=>i(ve,N)),we(T,()=>t(ie),N=>i(ie,N)),z(u,S)};D(rt,u=>{t(_)==="custom"&&u(Oe)})}e(le);var me=s(le,2),Ue=a(me);Ue.__click=()=>i(C,!1);var P=s(Ue,2);P.__click=La;var Y=a(P);Pa(Y,{size:18});var ct=s(Y);e(P),e(me),e(b),e(d),te((u,S,w)=>{r(ce,`Sending to ${t(c).size??""} abandoned cart${t(c).size>1?"s":""}`),de=ae(U,1,"template-option svelte-1kypvce",null,de,{active:t(_)==="reminder_1"}),V=ae(R,1,"template-option svelte-1kypvce",null,V,{active:t(_)==="reminder_2"}),X=ae(F,1,"template-option svelte-1kypvce",null,X,{active:t(_)==="final_discount"}),Pe=ae(B,1,"template-option svelte-1kypvce",null,Pe,{active:t(_)==="custom"}),r(pe,u),r(Me,S),r(it,w),P.disabled=t(Ee)||t(_)==="custom"&&(!t(ve)||!t(ie)),r(ct,` ${t(Ee)?"Sending...":`Send to ${t(c).size} Cart${t(c).size>1?"s":""}`}`)},[()=>Qe(t(_)).name,()=>Qe(t(_)).description,()=>Qe(t(_)).timing]),z(v,d)};D(Ya,v=>{t(C)&&v(Wa)})}z(p,ta),qs()}Bs(["click","keydown","change"]);export{Mv as component};
