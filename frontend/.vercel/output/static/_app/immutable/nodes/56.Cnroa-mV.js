import{p as gt,s as x,A as Q,o as ht,f as p,a9 as xt,i as N,h as d,j as $t,g as t,as as bt,e as n,q as o,d as $,bC as yt,n as T,c as l,at as wt,H as G,r as i,k as V,N as Ft,v as St,w as W,x as b,J as Et,K as Pt,Q as kt}from"../chunks/C_QN0JMx.js";import{B as Ct,S as Lt,a as y,C as w}from"../chunks/ButKoJq5.js";import{B as Rt}from"../chunks/COvxyfnH.js";import{T as jt}from"../chunks/CX5HRabs.js";import"../chunks/l0sNRNKZ.js";import"../chunks/Div_5PT3.js";import{k as Bt,e as Ot,g as Ut}from"../chunks/C9E1rr7k.js";var zt=p("<!> Export CSV",1),At=p('<div class="text-center py-12"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div> <p class="mt-4 text-gray-600">Loading entries...</p></div>'),Dt=p('<div class="text-center py-12"><p class="text-gray-500">Please select a form to view entries</p></div>'),Nt=p('<div class="text-center py-12"><p class="text-gray-500">No entries found for this form</p></div>'),Tt=p('<tr><td class="font-mono"> </td><td><!></td><td> </td><td class="max-w-xs truncate text-gray-600"> </td><td><button class="p-2 text-blue-600 hover:bg-blue-50 rounded transition-colors" title="View Entry"><a><!></a></button></td></tr>'),Vt=p('<div><div class="flex items-center justify-between mb-6"><div><h1 class="text-3xl font-bold text-gray-900">Form Entries</h1> <p class="text-gray-600 mt-1">View and manage form submissions</p></div> <!></div> <div class="mb-6 max-w-md"><!></div> <!></div>');function Xt(X,Y){gt(Y,!0);let c=x(Q([])),_=x(Q([])),s=x(null),g=x(!0);ht(async()=>{await Z()});async function Z(){try{const e=await Ut();l(c,e.forms||[],!0),t(c).length>0&&t(c)[0].id&&(l(s,t(c)[0].id,!0),await J(t(c)[0].id))}catch{y({type:"error",message:"Failed to load forms"})}finally{l(g,!1)}}async function J(e){try{l(g,!0);const a=await Ot(e);l(_,(a.submissions||[]).map(r=>({id:r.id??0,form_id:r.form_id??e,data:r.data||{},created_at:r.created_at??""})),!0)}catch{y({type:"error",message:"Failed to load entries"}),l(_,[],!0)}finally{l(g,!1)}}async function tt(){t(s)&&await J(t(s))}async function et(){if(t(s))try{const e=await Bt(t(s),"csv"),a=window.URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.download=`form-entries-${t(s)}.csv`,r.click(),window.URL.revokeObjectURL(a),y({type:"success",message:"Entries exported successfully"})}catch{y({type:"error",message:"Failed to export entries"})}}let at=T(()=>t(c).map(e=>({value:e.id,label:e.title})));var F=Vt();xt("1l9kf4z",e=>{bt(()=>{wt.title="Form Entries | Revolution Admin"})});var S=o(F),rt=n(o(S),2);{let e=T(()=>!t(s)||t(_).length===0);Ct(rt,{onclick:et,get disabled(){return t(e)},children:(a,r)=>{var v=zt(),P=$(v);yt(P,{size:20}),G(),d(a,v)},$$slots:{default:!0}})}i(S);var E=n(S,2),st=o(E);Lt(st,{label:"Select Form",get options(){return t(at)},onchange:tt,placeholder:"Choose a form...",get value(){return t(s)},set value(e){l(s,e,!0)}}),i(E);var ot=n(E,2);{var it=e=>{w(e,{children:(a,r)=>{var v=At();d(a,v)},$$slots:{default:!0}})},dt=e=>{var a=V(),r=$(a);{var v=u=>{w(u,{children:(h,q)=>{var k=Dt();d(h,k)},$$slots:{default:!0}})},P=u=>{var h=V(),q=$(h);{var k=m=>{w(m,{children:(C,nt)=>{var L=Nt();d(C,L)},$$slots:{default:!0}})},lt=m=>{w(m,{padding:!1,children:(C,nt)=>{jt(C,{headers:["ID","Status","Submitted","Preview","Actions"],children:(L,Jt)=>{var H=V(),ct=$(H);Ft(ct,17,()=>t(_),kt,(vt,f)=>{var R=Tt(),j=o(R),ut=o(j);i(j);var B=n(j),mt=o(B);{let A=T(()=>t(f).status==="complete"?"success":"warning");Rt(mt,{get variant(){return t(A)},children:(D,qt)=>{G();var M=St();W(()=>b(M,t(f).status)),d(D,M)},$$slots:{default:!0}})}i(B);var O=n(B),ft=o(O,!0);i(O);var U=n(O),pt=o(U);i(U);var I=n(U),K=o(I),z=o(K),_t=o(z);Et(_t,{size:18}),i(z),i(K),i(I),i(R),W((A,D)=>{b(ut,`#${t(f).id??""}`),b(ft,A),b(pt,`${D??""}...`),Pt(z,"href",`/admin/forms/${t(s)??""}/entries/${t(f).id??""}`)},[()=>new Date(t(f).created_at).toLocaleString(),()=>JSON.stringify(t(f).data).substring(0,100)]),d(vt,R)}),d(L,H)},$$slots:{default:!0}})},$$slots:{default:!0}})};N(q,m=>{t(_).length===0?m(k):m(lt,!1)},!0)}d(u,h)};N(r,u=>{t(s)?u(P,!1):u(v)},!0)}d(e,a)};N(ot,e=>{t(g)?e(it):e(dt,!1)})}i(F),d(X,F),$t()}export{Xt as component};
