import{z as Qe,p as Te,a3 as Ue,f as _,a9 as Xe,dA as be,N as fe,i as pe,w as U,q as s,e as r,bM as Ge,F as ue,D as Ie,bJ as y,g as a,bG as Ke,bO as Re,h as u,j as Ze,aX as n,aP as he,c as _e,as as Ee,x as b,at as Ve,H as h,r as t,Q as me,bH as f,bI as We,bK as X,al as Ye,Z as ea}from"../chunks/C_QN0JMx.js";var aa=_('<div class="feature-item svelte-1hqfyyb"><!> <span class="svelte-1hqfyyb"> </span></div>'),sa=_('<div class="empty-features svelte-1hqfyyb">Add features below</div>'),ta=_('<button type="button" class="remove-feature-btn svelte-1hqfyyb"><!></button>'),ra=_('<div class="feature-form svelte-1hqfyyb"><div class="feature-inputs svelte-1hqfyyb"><input type="text" placeholder="Feature name" class="feature-name-input svelte-1hqfyyb"/> <input type="text" placeholder="Description (optional)" class="feature-desc-input svelte-1hqfyyb"/></div> <!></div>'),ia=_('<div class="create-page svelte-1hqfyyb"><div class="page-header svelte-1hqfyyb"><div class="svelte-1hqfyyb"><h1 class="svelte-1hqfyyb"><!> Add New Membership Plan</h1> <p class="svelte-1hqfyyb">Create a premium membership plan for your subscribers</p></div></div> <div class="content-container svelte-1hqfyyb"><div class="preview-section svelte-1hqfyyb"><h3 class="svelte-1hqfyyb">Preview</h3> <div class="membership-card svelte-1hqfyyb"><div class="card-crown svelte-1hqfyyb"><!></div> <div class="card-header svelte-1hqfyyb"><h4 class="svelte-1hqfyyb"> </h4> <div class="pricing svelte-1hqfyyb"><span class="amount svelte-1hqfyyb"> </span> <span class="period svelte-1hqfyyb"> </span></div></div> <div class="card-description svelte-1hqfyyb"><p class="svelte-1hqfyyb"> </p></div> <div class="features-list svelte-1hqfyyb"><!> <!></div> <button class="subscribe-btn svelte-1hqfyyb" disabled>Subscribe Now</button></div></div> <div class="form-section svelte-1hqfyyb"><div class="form-card svelte-1hqfyyb"><h3 class="svelte-1hqfyyb">Membership Details</h3> <div class="form-group svelte-1hqfyyb"><label for="name" class="svelte-1hqfyyb">Plan Name *</label> <input id="name" type="text" placeholder="e.g., Pro Membership" class="svelte-1hqfyyb"/></div> <div class="form-group svelte-1hqfyyb"><label for="slug" class="svelte-1hqfyyb">URL Slug</label> <input id="slug" type="text" placeholder="pro-membership" class="svelte-1hqfyyb"/></div> <div class="form-group svelte-1hqfyyb"><label for="description" class="svelte-1hqfyyb">Description</label> <textarea id="description" placeholder="Describe the benefits of this membership plan..." rows="3" class="svelte-1hqfyyb"></textarea></div> <div class="form-row svelte-1hqfyyb"><div class="form-group svelte-1hqfyyb"><label for="price" class="svelte-1hqfyyb">Price (USD) *</label> <div class="price-input svelte-1hqfyyb"><span class="currency svelte-1hqfyyb">$</span> <input id="price" type="number" placeholder="29.99" step="0.01" min="0" class="svelte-1hqfyyb"/></div></div> <div class="form-group svelte-1hqfyyb"><label for="billing_cycle" class="svelte-1hqfyyb">Billing Cycle</label> <select id="billing_cycle" class="svelte-1hqfyyb"><option class="svelte-1hqfyyb">Monthly</option><option class="svelte-1hqfyyb">Quarterly</option><option class="svelte-1hqfyyb">Annual</option></select></div></div> <div class="features-section svelte-1hqfyyb"><div class="section-header svelte-1hqfyyb"><h4 class="svelte-1hqfyyb">Features</h4> <button type="button" class="add-feature-btn svelte-1hqfyyb"><!> Add Feature</button></div> <!></div> <div class="form-group svelte-1hqfyyb"><label class="checkbox-label svelte-1hqfyyb"><input type="checkbox" class="svelte-1hqfyyb"/> <span class="svelte-1hqfyyb">Active (visible to customers)</span></label></div> <div class="form-actions svelte-1hqfyyb"><button class="btn-secondary svelte-1hqfyyb">Cancel</button> <button class="btn-primary svelte-1hqfyyb"> </button></div></div></div></div></div>');function va(qe,ge){Te(ge,!1);let e=he({name:"",slug:"",description:"",price:"",billing_cycle:"monthly",is_active:!0,features:[{feature_code:"feature_1",feature_name:"",description:""}]}),m=he(!1);function xe(){!a(e).slug&&a(e).name&&n(e,a(e).slug=a(e).name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""))}function we(){n(e,a(e).features=[...a(e).features,{feature_code:`feature_${a(e).features.length+1}`,feature_name:"",description:""}])}function ke(i){n(e,a(e).features=a(e).features.filter((l,v)=>v!==i))}async function Pe(){if(!a(e).name||!a(e).price){alert("Please fill in name and price");return}const i=a(e).features.filter(l=>l.feature_name.trim());_e(m,!0);try{const l=await fetch("/api/admin/membership-plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...a(e),features:i})});if(l.ok)ue("/admin/memberships");else{const v=await l.json();alert(v.message||"Failed to create membership plan")}}catch{alert("Failed to save membership plan")}finally{_e(m,!1)}}function Fe(i){return{monthly:"/month",quarterly:"/quarter",annual:"/year"}[i]||"/month"}Ue();var x=ia();Xe("1hqfyyb",i=>{Ee(()=>{Ve.title="Add New Membership | Admin"})});var w=s(x),G=s(w),I=s(G),Ae=s(I);be(Ae,{size:32}),h(),t(I),h(2),t(G),t(w);var K=r(w,2),k=s(K),R=r(s(k),2),P=s(R),Ce=s(P);be(Ce,{size:32}),t(P);var F=r(P,2),A=s(F),Me=s(A,!0);t(A);var Z=r(A,2),C=s(Z),$e=s(C);t(C);var E=r(C,2),ze=s(E,!0);t(E),t(Z),t(F);var M=r(F,2),V=s(M),Ne=s(V,!0);t(V),t(M);var W=r(M,2),Y=s(W);fe(Y,1,()=>a(e).features.filter(i=>i.feature_name),me,(i,l)=>{var v=aa(),o=s(v);Ye(o,{size:18});var d=r(o,2),p=s(d,!0);t(d),t(v),U(()=>b(p,a(l).feature_name)),u(i,v)});var De=r(Y,2);{var Se=i=>{var l=sa();u(i,l)};pe(De,i=>{a(e).features.filter(l=>l.feature_name).length===0&&i(Se)})}t(W),h(2),t(R),t(k);var ee=r(k,2),ae=s(ee),$=r(s(ae),2),z=r(s($),2);f(z),t($);var N=r($,2),se=r(s(N),2);f(se),t(N);var D=r(N,2),te=r(s(D),2);We(te),t(D);var S=r(D,2),j=s(S),re=r(s(j),2),ie=r(s(re),2);f(ie),t(re),t(j);var le=r(j,2),L=r(s(le),2);U(()=>{a(e),X(()=>{})});var O=s(L);O.value=O.__value="monthly";var B=r(O);B.value=B.__value="quarterly";var ve=r(B);ve.value=ve.__value="annual",t(L),t(le),t(S);var H=r(S,2),J=s(H),Q=r(s(J),2);Q.__click=we;var je=s(Q);Ge(je,{size:16}),h(),t(Q),t(J);var Le=r(J,2);fe(Le,1,()=>a(e).features,me,(i,l,v)=>{var o=ra(),d=s(o),p=s(d);f(p);var ye=r(p,2);f(ye),t(d);var Be=r(d,2);{var He=c=>{var g=ta();g.__click=()=>ke(v);var Je=s(g);ea(Je,{size:16}),t(g),u(c,g)};pe(Be,c=>{a(e).features.length>1&&c(He)})}t(o),y(p,()=>a(l).feature_name,c=>(a(l).feature_name=c,X(()=>a(e)))),y(ye,()=>a(l).description,c=>(a(l).description=c,X(()=>a(e)))),u(i,o)}),t(H);var T=r(H,2),ne=s(T),ce=s(ne);f(ce),h(2),t(ne),t(T);var oe=r(T,2),de=s(oe);de.__click=()=>ue("/admin/memberships");var q=r(de,2);q.__click=Pe;var Oe=s(q,!0);t(q),t(oe),t(ae),t(ee),t(K),t(x),U(i=>{b(Me,a(e).name||"Plan Name"),b($e,`$${(a(e).price||"0")??""}`),b(ze,i),b(Ne,a(e).description||"Add a description..."),q.disabled=a(m),b(Oe,a(m)?"Creating...":"Create Membership Plan")},[()=>Fe(a(e).billing_cycle)]),Ie("blur",z,xe),y(z,()=>a(e).name,i=>n(e,a(e).name=i)),y(se,()=>a(e).slug,i=>n(e,a(e).slug=i)),y(te,()=>a(e).description,i=>n(e,a(e).description=i)),y(ie,()=>a(e).price,i=>n(e,a(e).price=i)),Ke(L,()=>a(e).billing_cycle,i=>n(e,a(e).billing_cycle=i)),Re(ce,()=>a(e).is_active,i=>n(e,a(e).is_active=i)),u(qe,x),Ze()}Qe(["click"]);export{va as component};
