import{z as wa,p as Da,s as b,A as Ne,o as Sa,f as _,a9 as Aa,q as t,R as Ta,bM as Re,aS as _e,U as ka,cJ as Fa,cY as La,ao as Ma,N as ye,i as E,w as m,bJ as Va,g as e,bG as Ue,h as c,j as Ba,c as u,as as Ea,e as l,n as Oe,x as n,at as Ia,r as a,H as S,bH as Na,Q as pe,k as He,d as Je,J as Ra,bU as Ua,bV as Oa,K as I,di as Ha}from"../chunks/C_QN0JMx.js";import{c as Pe}from"../chunks/L2eW2QSs.js";var Ja=_("<option> </option>"),Pa=_("<option> </option>"),Qa=_('<div class="loading-state svelte-ygigdv"><div class="spinner svelte-ygigdv"></div> <p>Loading companies...</p></div>'),ja=_('<div class="error-state svelte-ygigdv"><p> </p> <button>Try Again</button></div>'),qa=_('<div class="empty-state svelte-ygigdv"><!> <h3 class="svelte-ygigdv">No companies found</h3> <p class="svelte-ygigdv">Add your first company to start managing B2B accounts</p> <a href="/admin/crm/companies/new" class="btn-primary svelte-ygigdv"><!> Add Company</a></div>'),Ga=_('<img class="svelte-ygigdv"/>'),Ka=_('<a target="_blank" class="company-website svelte-ygigdv"><!> </a>'),Wa=_('<tr class="svelte-ygigdv"><td class="svelte-ygigdv"><div class="company-cell svelte-ygigdv"><div class="company-icon svelte-ygigdv"><!></div> <div class="company-info svelte-ygigdv"><span class="company-name svelte-ygigdv"> </span> <!></div></div></td><td class="svelte-ygigdv"><span class="industry-badge svelte-ygigdv"> </span></td><td class="svelte-ygigdv"> </td><td class="svelte-ygigdv"> </td><td class="svelte-ygigdv"> </td><td class="svelte-ygigdv"> </td><td class="svelte-ygigdv"><div class="action-buttons svelte-ygigdv"><a class="btn-icon svelte-ygigdv" title="View"><!></a> <a class="btn-icon svelte-ygigdv" title="Edit"><!></a> <button class="btn-icon danger svelte-ygigdv" title="Delete"><!></button></div></td></tr>'),Ya=_('<div class="table-container svelte-ygigdv"><table class="data-table svelte-ygigdv"><thead><tr><th class="svelte-ygigdv">Company</th><th class="svelte-ygigdv">Industry</th><th class="svelte-ygigdv">Size</th><th class="svelte-ygigdv">Contacts</th><th class="svelte-ygigdv">Deals</th><th class="svelte-ygigdv">Deal Value</th><th class="svelte-ygigdv">Actions</th></tr></thead><tbody class="svelte-ygigdv"></tbody></table></div>'),Xa=_('<div class="companies-page svelte-ygigdv"><div class="page-header svelte-ygigdv"><div><h1 class="svelte-ygigdv">CRM Companies</h1> <p class="page-description svelte-ygigdv">Manage B2B company accounts and their contacts</p></div> <div class="header-actions svelte-ygigdv"><button class="btn-refresh svelte-ygigdv"><!></button> <a href="/admin/crm/companies/new" class="btn-primary svelte-ygigdv"><!> New Company</a></div></div> <div class="stats-grid svelte-ygigdv"><div class="stat-card svelte-ygigdv"><div class="stat-icon blue svelte-ygigdv"><!></div> <div class="stat-content svelte-ygigdv"><span class="stat-value svelte-ygigdv"> </span> <span class="stat-label svelte-ygigdv">Total Companies</span></div></div> <div class="stat-card svelte-ygigdv"><div class="stat-icon green svelte-ygigdv"><!></div> <div class="stat-content svelte-ygigdv"><span class="stat-value svelte-ygigdv"> </span> <span class="stat-label svelte-ygigdv">Total Contacts</span></div></div> <div class="stat-card svelte-ygigdv"><div class="stat-icon purple svelte-ygigdv"><!></div> <div class="stat-content svelte-ygigdv"><span class="stat-value svelte-ygigdv"> </span> <span class="stat-label svelte-ygigdv">Total Deals</span></div></div> <div class="stat-card svelte-ygigdv"><div class="stat-icon amber svelte-ygigdv"><!></div> <div class="stat-content svelte-ygigdv"><span class="stat-value svelte-ygigdv"> </span> <span class="stat-label svelte-ygigdv">Total Deal Value</span></div></div></div> <div class="filters-bar svelte-ygigdv"><div class="search-box svelte-ygigdv"><!> <input type="text" placeholder="Search companies..." class="svelte-ygigdv"/></div> <select class="filter-select svelte-ygigdv"></select> <select class="filter-select svelte-ygigdv"></select></div> <!></div>');function et(Qe,je){Da(je,!0);let h=b(Ne([])),A=b(!0),T=b(""),f=b(""),C=b("all"),x=b("all"),k=b(Ne({total:0,totalContacts:0,totalDeals:0,totalDealValue:0}));const qe=[{value:"all",label:"All Industries"},{value:"technology",label:"Technology"},{value:"finance",label:"Finance"},{value:"healthcare",label:"Healthcare"},{value:"education",label:"Education"},{value:"retail",label:"Retail"},{value:"manufacturing",label:"Manufacturing"},{value:"consulting",label:"Consulting"},{value:"other",label:"Other"}],Ge=[{value:"all",label:"All Sizes"},{value:"1-10",label:"1-10 employees"},{value:"11-50",label:"11-50 employees"},{value:"51-200",label:"51-200 employees"},{value:"201-500",label:"201-500 employees"},{value:"501-1000",label:"501-1000 employees"},{value:"1001-5000",label:"1001-5000 employees"},{value:"5001+",label:"5001+ employees"}];async function N(){u(A,!0),u(T,"");try{const s={search:e(f)||void 0,industry:e(C)!=="all"?e(C):void 0,size:e(x)!=="all"?e(x):void 0},i=await Pe.getCompanies(s);u(h,i.data||[],!0),u(k,{total:e(h).length,totalContacts:e(h).reduce((v,r)=>v+r.contacts_count,0),totalDeals:e(h).reduce((v,r)=>v+r.deals_count,0),totalDealValue:e(h).reduce((v,r)=>v+r.total_deal_value,0)},!0)}catch(s){u(T,s instanceof Error?s.message:"Failed to load companies",!0)}finally{u(A,!1)}}async function Ke(s){if(confirm("Are you sure you want to delete this company? Associated contacts will NOT be deleted."))try{await Pe.deleteCompany(s),await N()}catch(i){u(T,i instanceof Error?i.message:"Failed to delete company",!0)}}function F(s){return s.toLocaleString()}function be(s){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(s)}let me=Oe(()=>e(h).filter(s=>{const i=!e(f)||s.name.toLowerCase().includes(e(f).toLowerCase())||s.website?.toLowerCase().includes(e(f).toLowerCase()),v=e(C)==="all"||s.industry===e(C),r=e(x)==="all"||s.size===e(x);return i&&v&&r}));Sa(()=>{N()});var J=Xa();Aa("ygigdv",s=>{Ea(()=>{Ia.title="CRM Companies - FluentCRM Pro"})});var P=t(J),he=l(t(P),2),L=t(he);L.__click=()=>N();var We=t(L);{let s=Oe(()=>e(A)?"spinning":"");Ta(We,{size:18,get class(){return e(s)}})}a(L);var fe=l(L,2),Ye=t(fe);Re(Ye,{size:18}),S(),a(fe),a(he),a(P);var Q=l(P,2),j=t(Q),q=t(j),Xe=t(q);_e(Xe,{size:24}),a(q);var Ce=l(q,2),xe=t(Ce),Ze=t(xe,!0);a(xe),S(2),a(Ce),a(j);var G=l(j,2),K=t(G),$e=t(K);ka($e,{size:24}),a(K);var ze=l(K,2),we=t(ze),ea=t(we,!0);a(we),S(2),a(ze),a(G);var W=l(G,2),Y=t(W),aa=t(Y);Fa(aa,{size:24}),a(Y);var De=l(Y,2),Se=t(De),ta=t(Se,!0);a(Se),S(2),a(De),a(W);var Ae=l(W,2),X=t(Ae),sa=t(X);La(sa,{size:24}),a(X);var Te=l(X,2),ke=t(Te),la=t(ke,!0);a(ke),S(2),a(Te),a(Ae),a(Q);var Z=l(Q,2),$=t(Z),Fe=t($);Ma(Fe,{size:18});var Le=l(Fe,2);Na(Le),a($);var R=l($,2);ye(R,21,()=>qe,pe,(s,i)=>{var v=Ja(),r=t(v,!0);a(v);var y={};m(()=>{n(r,e(i).label),y!==(y=e(i).value)&&(v.value=(v.__value=e(i).value)??"")}),c(s,v)}),a(R);var ee=l(R,2);ye(ee,21,()=>Ge,pe,(s,i)=>{var v=Pa(),r=t(v,!0);a(v);var y={};m(()=>{n(r,e(i).label),y!==(y=e(i).value)&&(v.value=(v.__value=e(i).value)??"")}),c(s,v)}),a(ee),a(Z);var va=l(Z,2);{var ia=s=>{var i=Qa();c(s,i)},ra=s=>{var i=He(),v=Je(i);{var r=z=>{var w=ja(),M=t(w),ae=t(M,!0);a(M);var te=l(M,2);te.__click=()=>N(),a(w),m(()=>n(ae,e(T))),c(z,w)},y=z=>{var w=He(),M=Je(w);{var ae=D=>{var p=qa(),V=t(p);_e(V,{size:48});var B=l(V,6),se=t(B);Re(se,{size:18}),S(),a(B),a(p),c(D,p)},te=D=>{var p=Ya(),V=t(p),B=l(t(V));ye(B,21,()=>e(me),pe,(se,d)=>{var le=Wa(),ve=t(le),Me=t(ve),ie=t(Me),da=t(ie);{var na=o=>{var g=Ga();m(()=>{I(g,"src",e(d).logo_url),I(g,"alt",e(d).name)}),c(o,g)},oa=o=>{_e(o,{size:20})};E(da,o=>{e(d).logo_url?o(na):o(oa,!1)})}a(ie);var Ve=l(ie,2),re=t(Ve),ca=t(re,!0);a(re);var ga=l(re,2);{var ua=o=>{var g=Ka(),H=t(g);Ha(H,{size:12});var xa=l(H);a(g),m(za=>{I(g,"href",e(d).website),n(xa,` ${za??""}`)},[()=>e(d).website.replace(/^https?:\/\//,"")]),c(o,g)};E(ga,o=>{e(d).website&&o(ua)})}a(Ve),a(Me),a(ve);var de=l(ve),Be=t(de),_a=t(Be,!0);a(Be),a(de);var ne=l(de),ya=t(ne,!0);a(ne);var oe=l(ne),pa=t(oe,!0);a(oe);var ce=l(oe),ba=t(ce,!0);a(ce);var ge=l(ce),ma=t(ge,!0);a(ge);var Ee=l(ge),Ie=t(Ee),U=t(Ie),ha=t(U);Ra(ha,{size:16}),a(U);var O=l(U,2),fa=t(O);Ua(fa,{size:16}),a(O);var ue=l(O,2);ue.__click=()=>Ke(e(d).id);var Ca=t(ue);Oa(Ca,{size:16}),a(ue),a(Ie),a(Ee),a(le),m((o,g,H)=>{n(ca,e(d).name),n(_a,e(d).industry||"-"),n(ya,e(d).size||"-"),n(pa,o),n(ba,g),n(ma,H),I(U,"href",`/admin/crm/companies/${e(d).id??""}`),I(O,"href",`/admin/crm/companies/${e(d).id??""}/edit`)},[()=>F(e(d).contacts_count),()=>F(e(d).deals_count),()=>be(e(d).total_deal_value)]),c(se,le)}),a(B),a(V),a(p),c(D,p)};E(M,D=>{e(me).length===0?D(ae):D(te,!1)},!0)}c(z,w)};E(v,z=>{e(T)?z(r):z(y,!1)},!0)}c(s,i)};E(va,s=>{e(A)?s(ia):s(ra,!1)})}a(J),m((s,i,v,r)=>{L.disabled=e(A),n(Ze,s),n(ea,i),n(ta,v),n(la,r)},[()=>F(e(k).total),()=>F(e(k).totalContacts),()=>F(e(k).totalDeals),()=>be(e(k).totalDealValue)]),Va(Le,()=>e(f),s=>u(f,s)),Ue(R,()=>e(C),s=>u(C,s)),Ue(ee,()=>e(x),s=>u(x,s)),c(Qe,J),Ba()}wa(["click"]);export{et as component};
