import{z as zt,p as Rt,s as C,A as Me,o as Nt,f as _,a9 as At,q as t,R as Dt,bM as Pe,dj as oe,bN as Et,M as kt,aH as Lt,ao as Ft,N as Te,i as U,w as L,bJ as Mt,g as a,bG as Pt,h as c,j as Tt,c as u,as as Ht,e as r,n as He,x as n,at as Ut,r as e,H as S,bH as $t,Q as Ue,k as $e,d as je,J as jt,bU as It,bZ as Jt,bV as Ot,O as Qt,K as Ie,v as Je}from"../chunks/C_QN0JMx.js";import{c as ge}from"../chunks/L2eW2QSs.js";var Vt=_("<option> </option>"),qt=_('<div class="loading-state svelte-xgus85"><div class="spinner svelte-xgus85"></div> <p>Loading campaigns...</p></div>'),Gt=_('<div class="error-state svelte-xgus85"><p> </p> <button>Try Again</button></div>'),Kt=_('<div class="empty-state svelte-xgus85"><!> <h3 class="svelte-xgus85">No recurring campaigns found</h3> <p class="svelte-xgus85">Create your first recurring campaign for automated newsletters</p> <a href="/admin/crm/recurring-campaigns/new" class="btn-primary svelte-xgus85"><!> Create Campaign</a></div>'),Zt=_('<tr class="svelte-xgus85"><td class="svelte-xgus85"><div class="campaign-cell svelte-xgus85"><div class="campaign-icon svelte-xgus85"><!></div> <div class="campaign-info svelte-xgus85"><span class="campaign-title svelte-xgus85"> </span> <span class="campaign-meta svelte-xgus85"> </span></div></div></td><td class="svelte-xgus85"><span> </span></td><td class="svelte-xgus85"><!></td><td class="svelte-xgus85"> </td><td class="svelte-xgus85"> </td><td class="svelte-xgus85"> </td><td class="svelte-xgus85"><div class="action-buttons svelte-xgus85"><a class="btn-icon svelte-xgus85" title="View"><!></a> <a class="btn-icon svelte-xgus85" title="Edit"><!></a> <button class="btn-icon svelte-xgus85" title="Duplicate"><!></button> <button class="btn-icon danger svelte-xgus85" title="Delete"><!></button></div></td></tr>'),Bt=_('<div class="table-container svelte-xgus85"><table class="data-table svelte-xgus85"><thead><tr><th class="svelte-xgus85">Campaign</th><th class="svelte-xgus85">Status</th><th class="svelte-xgus85">Schedule</th><th class="svelte-xgus85">Last Sent</th><th class="svelte-xgus85">Next Send</th><th class="svelte-xgus85">Emails Sent</th><th class="svelte-xgus85">Actions</th></tr></thead><tbody class="svelte-xgus85"></tbody></table></div>'),Wt=_('<div class="campaigns-page svelte-xgus85"><div class="page-header svelte-xgus85"><div><h1 class="svelte-xgus85">Recurring Campaigns</h1> <p class="page-description svelte-xgus85">Schedule automated recurring newsletters and campaigns</p></div> <div class="header-actions svelte-xgus85"><button class="btn-refresh svelte-xgus85"><!></button> <a href="/admin/crm/recurring-campaigns/new" class="btn-primary svelte-xgus85"><!> New Campaign</a></div></div> <div class="stats-grid svelte-xgus85"><div class="stat-card svelte-xgus85"><div class="stat-icon blue svelte-xgus85"><!></div> <div class="stat-content svelte-xgus85"><span class="stat-value svelte-xgus85"> </span> <span class="stat-label svelte-xgus85">Total Campaigns</span></div></div> <div class="stat-card svelte-xgus85"><div class="stat-icon green svelte-xgus85"><!></div> <div class="stat-content svelte-xgus85"><span class="stat-value svelte-xgus85"> </span> <span class="stat-label svelte-xgus85">Active</span></div></div> <div class="stat-card svelte-xgus85"><div class="stat-icon purple svelte-xgus85"><!></div> <div class="stat-content svelte-xgus85"><span class="stat-value svelte-xgus85"> </span> <span class="stat-label svelte-xgus85">Emails Sent</span></div></div> <div class="stat-card svelte-xgus85"><div class="stat-icon amber svelte-xgus85"><!></div> <div class="stat-content svelte-xgus85"><span class="stat-value svelte-xgus85"> </span> <span class="stat-label svelte-xgus85">Total Revenue</span></div></div></div> <div class="filters-bar svelte-xgus85"><div class="search-box svelte-xgus85"><!> <input type="text" placeholder="Search campaigns..." class="svelte-xgus85"/></div> <select class="filter-select svelte-xgus85"></select></div> <!></div>');function ea(Oe,Qe){Rt(Qe,!0);let p=C(Me([])),w=C(!0),x=C(""),z=C(""),m=C("all"),R=C(Me({total:0,active:0,totalSent:0,totalRevenue:0}));const Ve=[{value:"all",label:"All Campaigns"},{value:"draft",label:"Draft"},{value:"active",label:"Active"},{value:"paused",label:"Paused"}];async function N(){u(w,!0),u(x,"");try{const s={search:a(z)||void 0,status:a(m)!=="all"?a(m):void 0},l=await ge.getRecurringCampaigns(s);u(p,l.data||[],!0),u(R,{total:a(p).length,active:a(p).filter(v=>v.status==="active").length,totalSent:a(p).reduce((v,d)=>v+d.total_emails_sent,0),totalRevenue:a(p).reduce((v,d)=>v+d.total_revenue,0)},!0)}catch(s){u(x,s instanceof Error?s.message:"Failed to load campaigns",!0)}finally{u(w,!1)}}async function qe(s){try{await ge.duplicateRecurringCampaign(s),await N()}catch(l){u(x,l instanceof Error?l.message:"Failed to duplicate campaign",!0)}}async function Ge(s){if(confirm("Are you sure you want to delete this recurring campaign?"))try{await ge.deleteRecurringCampaign(s),await N()}catch(l){u(x,l instanceof Error?l.message:"Failed to delete campaign",!0)}}function F(s){return s.toLocaleString()}function Ke(s){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(s)}function _e(s){return s?new Date(s).toLocaleDateString():"Never"}function Ze(s){return{draft:"bg-slate-500/20 text-slate-400",active:"bg-emerald-500/20 text-emerald-400",paused:"bg-amber-500/20 text-amber-400"}[s]}let pe=He(()=>a(p).filter(s=>{const l=!a(z)||s.title.toLowerCase().includes(a(z).toLowerCase()),v=a(m)==="all"||s.status===a(m);return l&&v}));Nt(()=>{N()});var $=Wt();At("xgus85",s=>{Ht(()=>{Ut.title="Recurring Campaigns - FluentCRM Pro"})});var j=t($),xe=r(t(j),2),A=t(xe);A.__click=()=>N();var Be=t(A);{let s=He(()=>a(w)?"spinning":"");Dt(Be,{size:18,get class(){return a(s)}})}e(A);var me=r(A,2),We=t(me);Pe(We,{size:18}),S(),e(me),e(xe),e(j);var I=r(j,2),J=t(I),O=t(J),Xe=t(O);oe(Xe,{size:24}),e(O);var be=r(O,2),fe=t(be),Ye=t(fe,!0);e(fe),S(2),e(be),e(J);var Q=r(J,2),V=t(Q),et=t(V);Et(et,{size:24}),e(V);var he=r(V,2),ye=t(he),tt=t(ye,!0);e(ye),S(2),e(he),e(Q);var q=r(Q,2),G=t(q),at=t(G);kt(at,{size:24}),e(G);var Ce=r(G,2),Se=t(Ce),st=t(Se,!0);e(Se),S(2),e(Ce),e(q);var we=r(q,2),K=t(we),rt=t(K);Lt(rt,{size:24}),e(K);var ze=r(K,2),Re=t(ze),lt=t(Re,!0);e(Re),S(2),e(ze),e(we),e(I);var Z=r(I,2),B=t(Z),Ne=t(B);Ft(Ne,{size:18});var Ae=r(Ne,2);$t(Ae),e(B);var W=r(B,2);Te(W,21,()=>Ve,Ue,(s,l)=>{var v=Vt(),d=t(v,!0);e(v);var M={};L(()=>{n(d,a(l).label),M!==(M=a(l).value)&&(v.value=(v.__value=a(l).value)??"")}),c(s,v)}),e(W),e(Z);var vt=r(Z,2);{var it=s=>{var l=qt();c(s,l)},nt=s=>{var l=$e(),v=je(l);{var d=b=>{var f=Gt(),D=t(f),X=t(D,!0);e(D);var Y=r(D,2);Y.__click=()=>N(),e(f),L(()=>n(X,a(x))),c(b,f)},M=b=>{var f=$e(),D=je(f);{var X=h=>{var g=Kt(),E=t(g);oe(E,{size:48});var k=r(E,6),ee=t(k);Pe(ee,{size:18}),S(),e(k),e(g),c(h,g)},Y=h=>{var g=Bt(),E=t(g),k=r(t(E));Te(k,21,()=>a(pe),Ue,(ee,i)=>{var te=Zt(),ae=t(te),De=t(ae),se=t(De),ct=t(se);oe(ct,{size:20}),e(se);var Ee=r(se,2),re=t(Ee),ut=t(re,!0);e(re);var ke=r(re,2),dt=t(ke);e(ke),e(Ee),e(De),e(ae);var le=r(ae),ve=t(le),ot=t(ve,!0);e(ve),e(le);var ie=r(le),gt=t(ie);{var _t=o=>{var y=Je();L(()=>n(y,`${a(i).scheduling_settings.type??""}
									${a(i).scheduling_settings.time??""}`)),c(o,y)},pt=o=>{var y=Je("Not scheduled");c(o,y)};U(gt,o=>{a(i).scheduling_settings?o(_t):o(pt,!1)})}e(ie);var ne=r(ie),xt=t(ne,!0);e(ne);var ce=r(ne),mt=t(ce,!0);e(ce);var ue=r(ce),bt=t(ue,!0);e(ue);var Le=r(ue),Fe=t(Le),P=t(Fe),ft=t(P);jt(ft,{size:16}),e(P);var T=r(P,2),ht=t(T);It(ht,{size:16}),e(T);var H=r(T,2);H.__click=()=>qe(a(i).id);var yt=t(H);Jt(yt,{size:16}),e(H);var de=r(H,2);de.__click=()=>Ge(a(i).id);var Ct=t(de);Ot(Ct,{size:16}),e(de),e(Fe),e(Le),e(te),L((o,y,St,wt)=>{n(ut,a(i).title),n(dt,`${a(i).total_campaigns_sent??""} campaigns sent`),Qt(ve,1,`status-badge ${o??""}`,"svelte-xgus85"),n(ot,a(i).status),n(xt,y),n(mt,St),n(bt,wt),Ie(P,"href",`/admin/crm/recurring-campaigns/${a(i).id??""}`),Ie(T,"href",`/admin/crm/recurring-campaigns/${a(i).id??""}/edit`)},[()=>Ze(a(i).status),()=>_e(a(i).last_sent_at),()=>_e(a(i).next_scheduled_at),()=>F(a(i).total_emails_sent)]),c(ee,te)}),e(k),e(E),e(g),c(h,g)};U(D,h=>{a(pe).length===0?h(X):h(Y,!1)},!0)}c(b,f)};U(v,b=>{a(x)?b(d):b(M,!1)},!0)}c(s,l)};U(vt,s=>{a(w)?s(it):s(nt,!1)})}e($),L((s,l,v,d)=>{A.disabled=a(w),n(Ye,s),n(tt,l),n(st,v),n(lt,d)},[()=>F(a(R).total),()=>F(a(R).active),()=>F(a(R).totalSent),()=>Ke(a(R).totalRevenue)]),Mt(Ae,()=>a(z),s=>u(z,s)),Pt(W,()=>a(m),s=>u(m,s)),c(Oe,$),Tt()}zt(["click"]);export{ea as component};
