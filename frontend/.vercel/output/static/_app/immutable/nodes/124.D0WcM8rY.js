import{z as Me,p as Se,o as ze,f as x,a9 as Pe,q as e,aM as Ae,i as z,h as d,j as Be,E as Fe,F as Le,aN as Ue,e as r,c as p,s as P,g as a,n as Ee,at as Ie,H as K,r as t,B as Re,aa as qe,k as T,d as V,w as W,x as l,cY as He,aQ as Ne}from"../chunks/C_QN0JMx.js";import{c as Oe}from"../chunks/L2eW2QSs.js";var Qe=x('<div class="flex h-64 items-center justify-center text-slate-400">Loading deal…</div>'),Ye=x('<div class="rounded-xl border border-rose-700/60 bg-rose-950/40 px-4 py-3 text-sm text-rose-200"> </div>'),Ge=x('<div class="space-y-4"><div class="rounded-2xl border border-slate-800/80 bg-slate-900/70 p-5"><div class="flex items-start justify-between gap-4"><div><h1 class="text-xl font-semibold leading-tight"> </h1> <p class="mt-1 text-xs text-slate-400"> </p></div> <div class="rounded-xl bg-slate-800/80 px-3 py-2 text-right text-xs"><p class="flex items-center justify-end gap-1 text-slate-200"><!> </p> <p class="mt-1 text-[11px] text-slate-400"> </p></div></div> <div class="mt-4 grid gap-3 text-xs text-slate-300 md:grid-cols-3"><div><p class="text-[11px] uppercase tracking-wide text-slate-500">Contact</p> <p class="mt-1 text-slate-100"> </p></div> <div><p class="text-[11px] uppercase tracking-wide text-slate-500">Owner</p> <p class="mt-1 text-slate-100"> </p></div> <div><p class="text-[11px] uppercase tracking-wide text-slate-500">Expected Close</p> <p class="mt-1 text-slate-100"> </p></div></div></div> <div class="rounded-2xl border border-slate-800/80 bg-slate-900/70 p-5 text-xs"><div class="mb-3 flex items-center gap-2 text-sm font-medium text-slate-100"><!> Deal Metrics</div> <div class="grid gap-3 md:grid-cols-3"><div><p class="text-[11px] uppercase tracking-wide text-slate-500">Days in Stage</p> <p class="mt-1 text-lg font-semibold text-slate-50"> </p></div> <div><p class="text-[11px] uppercase tracking-wide text-slate-500">Days in Pipeline</p> <p class="mt-1 text-lg font-semibold text-slate-50"> </p></div> <div><p class="text-[11px] uppercase tracking-wide text-slate-500">Stage Changes</p> <p class="mt-1 text-lg font-semibold text-slate-50"> </p></div></div></div></div>'),Je=x('<div class="flex h-64 items-center justify-center text-slate-400">Deal not found.</div>'),Ke=x('<div class="min-h-screen bg-slate-950/95 text-slate-50"><div class="mx-auto max-w-5xl px-6 py-6"><button class="mb-4 inline-flex items-center gap-2 text-xs text-slate-400 hover:text-slate-200"><!> Back to deals</button> <!></div></div>');function We(X,Z){Se(Z,!0);const ee=()=>Re(qe,"$page",te),[te,ae]=Fe();let s=P(null),u=P(!0),_=P(null),se=Ee(()=>ee().params.id);ze(async()=>{await re()});async function re(){p(u,!0),p(_,null);try{p(s,await Oe.getDeal(a(se)),!0)}catch{p(_,"Failed to load deal. Please try again.")}finally{p(u,!1)}}function le(){Le("/crm/deals")}var f=Ke();Pe("1gnp2o7",i=>{Ue(()=>{Ie.title=a(s)?`${a(s).name} | CRM Deal`:"Deal | CRM"})});var A=e(f),g=e(A);g.__click=le;var ie=e(g);Ae(ie,{size:16}),K(),t(g);var de=r(g,2);{var ve=i=>{var m=Qe();d(i,m)},ce=i=>{var m=T(),ne=V(m);{var oe=v=>{var c=Ye(),b=e(c,!0);t(c),W(()=>l(b,a(_))),d(v,c)},pe=v=>{var c=T(),b=V(c);{var xe=n=>{var o=Ge(),y=e(o),h=e(y),w=e(h),k=e(w),ge=e(k,!0);t(k);var B=r(k,2),me=e(B);t(B),t(w);var F=r(w,2),D=e(F),L=e(D);He(L,{size:16});var ue=r(L);t(D);var U=r(D,2),fe=e(U);t(U),t(F),t(h);var E=r(h,2),$=e(E),I=r(e($),2),be=e(I,!0);t(I),t($);var C=r($,2),R=r(e(C),2),ye=e(R,!0);t(R),t(C);var q=r(C,2),H=r(e(q),2),he=e(H,!0);t(H),t(q),t(E),t(y);var N=r(y,2),j=e(N),we=e(j);Ne(we,{size:18,class:"text-sky-400"}),K(),t(j);var O=r(j,2),M=e(O),Q=r(e(M),2),ke=e(Q,!0);t(Q),t(M);var S=r(M,2),Y=r(e(S),2),De=e(Y,!0);t(Y),t(S);var G=r(S,2),J=r(e(G),2),$e=e(J,!0);t(J),t(G),t(O),t(N),t(o),W((Ce,je)=>{l(ge,a(s).name),l(me,`${a(s).pipeline?.name??""} · ${a(s).stage?.name??""}`),l(ue,` ${Ce??""}`),l(fe,`Probability: ${a(s).probability??""}%`),l(be,a(s).contact?.full_name??"Unassigned"),l(ye,a(s).owner?.name??"Unassigned"),l(he,je),l(ke,a(s).days_in_stage),l(De,a(s).days_in_pipeline),l($e,a(s).stage_changes_count)},[()=>a(s).amount.toLocaleString("en-US",{style:"currency",currency:a(s).currency}),()=>a(s).expected_close_date?new Date(a(s).expected_close_date).toLocaleDateString():"—"]),d(n,o)},_e=n=>{var o=Je();d(n,o)};z(b,n=>{a(s)?n(xe):n(_e,!1)},!0)}d(v,c)};z(ne,v=>{a(_)?v(oe):v(pe,!1)},!0)}d(i,m)};z(de,i=>{a(u)&&!a(s)?i(ve):i(ce,!1)})}t(A),t(f),d(X,f),Be(),ae()}Me(["click"]);export{We as component};
