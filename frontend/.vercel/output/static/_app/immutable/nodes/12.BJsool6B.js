import{z as le,p as ne,o as ce,f as n,a9 as xe,N as I,i as M,h as v,j as ue,as as ge,e as a,q as r,at as pe,g as t,s as E,H as _e,r as e,Q as J,c as C,w as T,O as be,x as d,k as zt,d as q,n as ft,_ as he}from"../chunks/C_QN0JMx.js";import{a as ye}from"../chunks/CCQSfPwG.js";import{A as me}from"../chunks/BPa9I0Q8.js";import{P as fe}from"../chunks/gQRjaVS-.js";import"../chunks/Cq_baTW3.js";var we=n('<button><div class="font-medium text-gray-900 mb-1"> </div> <div class="text-xs text-gray-500"> </div></button>'),Ae=n('<div class="flex items-center justify-center py-20"><div class="w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"></div></div>'),Ce=n('<div class="bg-red-50 border border-red-200 rounded-xl p-6 text-center"><p class="text-red-600"> </p> <button class="mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">Retry</button></div>'),Te=n('<tr class="hover:bg-gray-50"><td class="py-3 px-4"><span class="font-medium text-gray-900 capitalize"> </span></td><td class="py-3 px-4 text-right text-gray-600"> </td><td class="py-3 px-4 text-right text-gray-600"> </td><td class="py-3 px-4 text-right font-medium text-gray-900"> </td><td class="py-3 px-4 text-right"><div class="flex items-center justify-end gap-2"><div class="w-16 h-2 bg-gray-100 rounded-full overflow-hidden"><div class="h-full bg-blue-500 rounded-full"></div></div> <span class="text-gray-600"> </span></div></td><td class="py-3 px-4 text-right text-gray-600"> </td><td class="py-3 px-4 text-right text-gray-600"> </td></tr>'),Fe=n('<span class="text-gray-400">‚Üí</span>'),Le=n('<span class="px-2 py-1 bg-white border border-gray-200 rounded text-sm capitalize"> </span> <!>',1),Se=n('<div class="flex items-center gap-4 p-3 bg-gray-50 rounded-lg"><span class="text-sm text-gray-400 w-6"></span> <div class="flex-1 flex items-center gap-2 flex-wrap"></div> <div class="text-right"><div class="font-medium text-gray-900"> </div> <div class="text-sm text-gray-500"> </div></div></div>'),ke=n('<div class="bg-white rounded-xl border border-gray-200 p-6"><h3 class="text-lg font-semibold text-gray-900 mb-4">Top Conversion Paths</h3> <div class="space-y-3"></div></div>'),Me=n('<div class="mb-8"><!></div> <div class="bg-white rounded-xl border border-gray-200 overflow-hidden mb-8"><div class="p-4 border-b border-gray-100"><h3 class="font-semibold text-gray-900">Channel Performance</h3></div> <div class="overflow-x-auto"><table class="w-full text-sm"><thead class="bg-gray-50"><tr><th class="text-left py-3 px-4 font-medium text-gray-600">Channel</th><th class="text-right py-3 px-4 font-medium text-gray-600">Touchpoints</th><th class="text-right py-3 px-4 font-medium text-gray-600">Conversions</th><th class="text-right py-3 px-4 font-medium text-gray-600">Revenue</th><th class="text-right py-3 px-4 font-medium text-gray-600">Revenue Share</th><th class="text-right py-3 px-4 font-medium text-gray-600">Avg Order Value</th><th class="text-right py-3 px-4 font-medium text-gray-600">Assisted Conv.</th></tr></thead><tbody class="divide-y divide-gray-100"></tbody><tfoot class="bg-gray-50 font-medium"><tr><td class="py-3 px-4 text-gray-900">Total</td><td class="py-3 px-4 text-right text-gray-900"> </td><td class="py-3 px-4 text-right text-gray-900"> </td><td class="py-3 px-4 text-right text-gray-900"> </td><td class="py-3 px-4 text-right text-gray-900">100%</td><td class="py-3 px-4 text-right text-gray-900"> </td><td class="py-3 px-4 text-right text-gray-900"> </td></tr></tfoot></table></div></div> <!>',1),Pe=n('<div class="bg-white rounded-xl border border-gray-200 p-12 text-center"><div class="text-4xl mb-4">üìç</div> <h3 class="text-lg font-medium text-gray-900 mb-2">No Attribution Data</h3> <p class="text-gray-500">Attribution data will appear once conversions are tracked</p></div>'),Re=n('<div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8"><div class="bg-white rounded-xl border border-gray-200 p-6"><div class="text-sm text-gray-500 mb-1">Attributed Revenue</div> <div class="text-3xl font-bold text-gray-900"> </div></div> <div class="bg-white rounded-xl border border-gray-200 p-6"><div class="text-sm text-gray-500 mb-1">Total Conversions</div> <div class="text-3xl font-bold text-gray-900"> </div></div> <div class="bg-white rounded-xl border border-gray-200 p-6"><div class="text-sm text-gray-500 mb-1">Total Touchpoints</div> <div class="text-3xl font-bold text-gray-900"> </div></div> <div class="bg-white rounded-xl border border-gray-200 p-6"><div class="text-sm text-gray-500 mb-1">Avg Touchpoints/Conv</div> <div class="text-3xl font-bold text-gray-900"> </div></div></div> <!>',1),$e=n('<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="flex items-center justify-between mb-8"><div><h1 class="text-2xl font-bold text-gray-900">Attribution Analysis</h1> <p class="text-sm text-gray-500 mt-1">Multi-touch attribution across marketing channels</p></div> <div class="flex items-center gap-4"><!> <button class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm">Export Report</button></div></div> <div class="bg-white rounded-xl border border-gray-200 p-6 mb-8"><h3 class="text-lg font-semibold text-gray-900 mb-4">Attribution Model</h3> <div class="grid grid-cols-1 md:grid-cols-5 gap-4"></div></div> <!></div>');function Ne(Et,qt){ne(qt,!0);let l=E(null),U=E(!0),D=E(null),W=E("30d"),N=E("linear");const Dt=[{value:"first_touch",label:"First Touch",description:"Credits the first interaction"},{value:"last_touch",label:"Last Touch",description:"Credits the last interaction"},{value:"linear",label:"Linear",description:"Equal credit to all touchpoints"},{value:"time_decay",label:"Time Decay",description:"More credit to recent touchpoints"},{value:"position_based",label:"Position Based",description:"40% first, 40% last, 20% middle"}];async function O(){C(U,!0),C(D,null);try{C(l,await ye.getChannelAttribution(t(N),t(W)),!0)}catch(s){C(D,s instanceof Error?s.message:"Failed to load attribution data",!0)}finally{C(U,!1)}}function Nt(s){C(W,s,!0),O()}function Ot(){O()}function F(s){return s>=1e6?"$"+(s/1e6).toFixed(1)+"M":s>=1e3?"$"+(s/1e3).toFixed(1)+"K":"$"+s.toFixed(0)}ce(()=>{O()});const X=ft(()=>t(l)?.channels?.reduce((s,o)=>s+o.attributed_revenue,0)||0),L=ft(()=>t(l)?.channels?.reduce((s,o)=>s+o.attributed_conversions,0)||0),Y=ft(()=>t(l)?.channels?.reduce((s,o)=>s+o.touchpoints,0)||0);var Z=$e();xe("1fmswtx",s=>{ge(()=>{pe.title="Attribution Report | Analytics"})});var tt=r(Z),wt=a(r(tt),2),Bt=r(wt);fe(Bt,{get value(){return t(W)},onchange:Nt}),_e(2),e(wt),e(tt);var et=a(tt,2),At=a(r(et),2);I(At,21,()=>Dt,J,(s,o)=>{var b=we();b.__click=()=>{C(N,t(o).value,!0),Ot()};var P=r(b),rt=r(P,!0);e(P);var c=a(P,2),g=r(c,!0);e(c),e(b),T(()=>{be(b,1,`p-4 rounded-xl border-2 text-left transition-all
						${t(N)===t(o).value?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300"}`),d(rt,t(o).label),d(g,t(o).description)}),v(s,b)}),e(At),e(et);var Ht=a(et,2);{var Kt=s=>{var o=Ae();v(s,o)},Qt=s=>{var o=zt(),b=q(o);{var P=c=>{var g=Ce(),R=r(g),at=r(R,!0);e(R);var $=a(R,2);$.__click=O,e(g),T(()=>d(at,t(D))),v(c,g)},rt=c=>{var g=zt(),R=q(g);{var at=$=>{var Ct=Re(),st=q(Ct),dt=r(st),Tt=a(r(dt),2),Vt=r(Tt,!0);e(Tt),e(dt);var it=a(dt,2),Ft=a(r(it),2),Gt=r(Ft,!0);e(Ft),e(it);var ot=a(it,2),Lt=a(r(ot),2),It=r(Lt,!0);e(Lt),e(ot);var St=a(ot,2),kt=a(r(St),2),Jt=r(kt,!0);e(kt),e(St),e(st);var Ut=a(st,2);{var Wt=p=>{var S=Me(),j=q(S),vt=r(j);me(vt,{get channels(){return t(l).channels},get model(){return t(N)}}),e(j);var lt=a(j,2),Mt=a(r(lt),2),Pt=r(Mt),nt=a(r(Pt));I(nt,21,()=>t(l).channels,J,(x,i)=>{var _=Te(),h=r(_),u=r(h),pt=r(u,!0);e(u),e(h);var y=a(h),B=r(y,!0);e(y);var m=a(y),H=r(m,!0);e(m);var f=a(m),_t=r(f,!0);e(f);var k=a(f),K=r(k),w=r(K),bt=r(w);e(w);var Q=a(w,2),V=r(Q);e(Q),e(K),e(k);var A=a(k),ht=r(A,!0);e(A);var G=a(A),yt=r(G,!0);e(G),e(_),T((z,mt,de,ie,oe,ve)=>{d(pt,t(i).channel),d(B,z),d(H,mt),d(_t,de),he(bt,`width: ${t(i).revenue_share??""}%`),d(V,`${ie??""}%`),d(ht,oe),d(yt,ve)},[()=>t(i).touchpoints.toLocaleString(),()=>t(i).attributed_conversions.toFixed(1),()=>F(t(i).attributed_revenue),()=>t(i).revenue_share.toFixed(1),()=>t(i).attributed_conversions>0?F(t(i).attributed_revenue/t(i).attributed_conversions):"-",()=>t(i).assisted_conversions.toLocaleString()]),v(x,_)}),e(nt);var Rt=a(nt),$t=r(Rt),ct=a(r($t)),Yt=r(ct,!0);e(ct);var xt=a(ct),Zt=r(xt,!0);e(xt);var ut=a(xt),te=r(ut,!0);e(ut);var gt=a(ut,2),ee=r(gt,!0);e(gt);var jt=a(gt),re=r(jt,!0);e(jt),e($t),e(Rt),e(Pt),e(Mt),e(lt);var ae=a(lt,2);{var se=x=>{var i=ke(),_=a(r(i),2);I(_,21,()=>t(l).conversion_paths.slice(0,10),J,(h,u,pt)=>{var y=Se(),B=r(y);B.textContent=`${pt+1}.`;var m=a(B,2);I(m,21,()=>t(u).channels,J,(w,bt,Q)=>{var V=Le(),A=q(V),ht=r(A,!0);e(A);var G=a(A,2);{var yt=z=>{var mt=Fe();v(z,mt)};M(G,z=>{Q<t(u).channels.length-1&&z(yt)})}T(()=>d(ht,t(bt))),v(w,V)}),e(m);var H=a(m,2),f=r(H),_t=r(f);e(f);var k=a(f,2),K=r(k,!0);e(k),e(H),e(y),T(w=>{d(_t,`${t(u).conversions??""} conv`),d(K,w)},[()=>F(t(u).revenue)]),v(h,y)}),e(_),e(i),v(x,i)};M(ae,x=>{t(l).conversion_paths&&t(l).conversion_paths.length>0&&x(se)})}T((x,i,_,h,u)=>{d(Yt,x),d(Zt,i),d(te,_),d(ee,h),d(re,u)},[()=>t(Y).toLocaleString(),()=>t(L).toFixed(1),()=>F(t(X)),()=>t(L)>0?F(t(X)/t(L)):"-",()=>t(l).channels.reduce((x,i)=>x+i.assisted_conversions,0).toLocaleString()]),v(p,S)},Xt=p=>{var S=Pe();v(p,S)};M(Ut,p=>{t(l).channels&&t(l).channels.length>0?p(Wt):p(Xt,!1)})}T((p,S,j,vt)=>{d(Vt,p),d(Gt,S),d(It,j),d(Jt,vt)},[()=>F(t(X)),()=>t(L).toLocaleString(),()=>t(Y).toLocaleString(),()=>t(L)>0?(t(Y)/t(L)).toFixed(1):"0"]),v($,Ct)};M(R,$=>{t(l)&&$(at)},!0)}v(c,g)};M(b,c=>{t(D)?c(P):c(rt,!1)},!0)}v(s,o)};M(Ht,s=>{t(U)?s(Kt):s(Qt,!1)})}e(Z),v(Et,Z),ue()}le(["click"]);export{Ne as component};
