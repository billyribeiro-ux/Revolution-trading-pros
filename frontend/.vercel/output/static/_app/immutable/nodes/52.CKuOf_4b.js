import{p as Ea,s as R,A as Fa,o as Oa,c as j,f as u,q as t,i as $,g as a,r as e,h as b,j as Ca,d as Y,e as s,H as G,w as M,n as La,x as o,_ as A,N as Aa,K as Xa,Q as Ra,z as Ya,a9 as Za,F as ua,E as ae,as as ee,at as te,B as se,aa as ie,k as Ta}from"../chunks/C_QN0JMx.js";import{c as ve,e as re,f as le}from"../chunks/C9E1rr7k.js";const de=!1,Se=Object.freeze(Object.defineProperty({__proto__:null,prerender:de},Symbol.toStringTag,{value:"Module"}));var ce=u('<div class="loading svelte-169ab8q">Loading analytics...</div>'),oe=u('<div class="trend-bar svelte-169ab8q"><div class="bar svelte-169ab8q"></div> <div class="bar-label svelte-169ab8q"> </div></div>'),ne=u('<div class="chart-card svelte-169ab8q"><h3 class="svelte-169ab8q">Submission Trend (Last 30 Days)</h3> <div class="trend-chart svelte-169ab8q"></div> <div class="trend-summary svelte-169ab8q"> </div></div>'),be=u('<div class="completion-row svelte-169ab8q"><div class="field-name svelte-169ab8q"> </div> <div class="completion-bar svelte-169ab8q"><div class="completion-fill svelte-169ab8q"></div> <div class="completion-percentage svelte-169ab8q"> </div></div></div>'),_e=u('<div class="chart-card svelte-169ab8q"><h3 class="svelte-169ab8q">Field Completion Rates</h3> <div class="field-completion svelte-169ab8q"></div></div>'),ue=u('<div class="analytics-grid svelte-169ab8q"><div class="metric-card primary svelte-169ab8q"><div class="metric-icon svelte-169ab8q">ğŸ“Š</div> <div class="metric-content"><div class="metric-value svelte-169ab8q"> </div> <div class="metric-label svelte-169ab8q">Total Submissions</div></div></div> <div class="metric-card svelte-169ab8q"><div class="metric-icon svelte-169ab8q">ğŸ“ˆ</div> <div class="metric-content"><div class="metric-value svelte-169ab8q"> </div> <div class="metric-label svelte-169ab8q">Last 7 Days</div></div></div> <div class="metric-card svelte-169ab8q"><div class="metric-icon svelte-169ab8q">âœ‰ï¸</div> <div class="metric-content"><div class="metric-value svelte-169ab8q"> </div> <div class="metric-label svelte-169ab8q">Unread</div></div></div> <div class="metric-card svelte-169ab8q"><div class="metric-icon svelte-169ab8q">â­</div> <div class="metric-content"><div class="metric-value svelte-169ab8q"> </div> <div class="metric-label svelte-169ab8q">Starred</div></div></div></div> <div class="chart-card svelte-169ab8q"><h3 class="svelte-169ab8q">Status Breakdown</h3> <div class="status-bars svelte-169ab8q"><div class="status-bar svelte-169ab8q"><div class="status-label svelte-169ab8q"><span class="status-dot unread svelte-169ab8q"></span> </div> <div class="bar-track svelte-169ab8q"><div class="bar-fill unread svelte-169ab8q"></div></div></div> <div class="status-bar svelte-169ab8q"><div class="status-label svelte-169ab8q"><span class="status-dot read svelte-169ab8q"></span> </div> <div class="bar-track svelte-169ab8q"><div class="bar-fill read svelte-169ab8q"></div></div></div> <div class="status-bar svelte-169ab8q"><div class="status-label svelte-169ab8q"><span class="status-dot starred svelte-169ab8q"></span> </div> <div class="bar-track svelte-169ab8q"><div class="bar-fill starred svelte-169ab8q"></div></div></div> <div class="status-bar svelte-169ab8q"><div class="status-label svelte-169ab8q"><span class="status-dot archived svelte-169ab8q"></span> </div> <div class="bar-track svelte-169ab8q"><div class="bar-fill archived svelte-169ab8q"></div></div></div></div></div> <!> <!> <div class="performance-grid svelte-169ab8q"><div class="performance-card svelte-169ab8q"><div class="performance-label svelte-169ab8q">Read Rate</div> <div class="performance-value svelte-169ab8q"> </div> <div class="performance-chart"><div class="circle-progress"></div></div></div> <div class="performance-card svelte-169ab8q"><div class="performance-label svelte-169ab8q">Avg. Completion Time</div> <div class="performance-value svelte-169ab8q"> </div> <div class="performance-note svelte-169ab8q">Estimated</div></div></div>',1),me=u('<div class="analytics-container svelte-169ab8q"><!></div>');function fe(Z,S){Ea(S,!0);let i=R(null),z=R(!0),k=R(Fa([])),m=R(Fa([]));Oa(async()=>{await J()});async function J(){j(z,!0);try{if(S.form.id){j(i,await ve(S.form.id),!0);const l=await re(S.form.id,1,100);j(k,B(l.submissions),!0),j(m,K(l.submissions),!0)}}catch{}finally{j(z,!1)}}function B(l){const c=new Date;c.setDate(c.getDate()-30);const v={};for(let d=0;d<30;d++){const _=new Date(c);_.setDate(_.getDate()+d);const p=_.toISOString().split("T")[0];v[p]=0}return l.forEach(d=>{const _=new Date(d.created_at);if(_>=c){const p=_.toISOString().split("T")[0];v[p]=(v[p]||0)+1}}),Object.entries(v).map(([d,_])=>({date:d,count:_}))}function K(l){if(!S.form.fields||l.length===0)return[];const c={};return S.form.fields.forEach(v=>{c[v.name]={filled:0,total:l.length,field:v}}),l.forEach(v=>{v.data?.forEach(d=>{d.value&&d.value.trim()!==""&&c[d.field_name]&&c[d.field_name].filled++})}),Object.values(c).map(v=>({label:v.field.label,name:v.field.name,completionRate:v.total>0?v.filled/v.total*100:0,filled:v.filled,total:v.total}))}function U(){return"2m 34s"}let T=La(()=>a(i)&&a(i).total_submissions>0?a(i).read_count/a(i).total_submissions*100:0);var D=me(),W=t(D);{var aa=l=>{var c=ce();b(l,c)},ea=l=>{var c=ue(),v=Y(c),d=t(v),_=s(t(d),2),p=t(_),r=t(p,!0);e(p),G(2),e(_),e(d);var n=s(d,2),g=s(t(n),2),E=t(g),ta=t(E,!0);e(E),G(2),e(g),e(n);var f=s(n,2),h=s(t(f),2),F=t(h),H=t(F,!0);e(F),G(2),e(h),e(f);var O=s(f,2),ma=s(t(O),2),fa=t(ma),Ia=t(fa,!0);e(fa),G(2),e(ma),e(O),e(v);var sa=s(v,2),qa=s(t(sa),2),ia=t(qa),va=t(ia),Ma=s(t(va));e(va);var pa=s(va,2),za=t(pa);e(pa),e(ia);var ra=s(ia,2),la=t(ra),Ba=s(t(la));e(la);var ga=s(la,2),Ka=t(ga);e(ga),e(ra);var da=s(ra,2),ca=t(da),Ua=s(t(ca));e(ca);var ha=s(ca,2),Ha=t(ha);e(ha),e(da);var ya=s(da,2),oa=t(ya),Na=s(t(oa));e(oa);var xa=s(oa,2),Pa=t(xa);e(xa),e(ya),e(qa),e(sa);var wa=s(sa,2);{var Qa=y=>{var x=ne(),C=s(t(x),2);Aa(C,21,()=>a(k).slice(-7),Ra,(w,q)=>{var P=oe(),I=t(P),Q=s(I,2),X=t(Q,!0);e(Q),e(P),M((V,_a)=>{A(I,`height: ${V??""}%`),Xa(I,"title",`${a(q).count??""} submissions`),o(X,_a)},[()=>a(q).count>0?Math.max(a(q).count/Math.max(...a(k).map(V=>V.count))*100,10):5,()=>new Date(a(q).date).getDate()]),b(w,P)}),e(C);var L=s(C,2),N=t(L);e(L),e(x),M(w=>o(N,`Last 7 days: ${w??""} submissions`),[()=>a(k).slice(-7).reduce((w,q)=>w+q.count,0)]),b(y,x)};$(wa,y=>{a(k).length>0&&y(Qa)})}var Sa=s(wa,2);{var Va=y=>{var x=_e(),C=s(t(x),2);Aa(C,21,()=>a(m).filter(L=>L.completionRate>0).slice(0,10),Ra,(L,N)=>{var w=be(),q=t(w),P=t(q,!0);e(q);var I=s(q,2),Q=t(I),X=s(Q,2),V=t(X);e(X),e(I),e(w),M(_a=>{o(P,a(N).label),A(Q,`width: ${a(N).completionRate??""}%`),o(V,`${_a??""}%`)},[()=>a(N).completionRate.toFixed(0)]),b(L,w)}),e(C),e(x),b(y,x)};$(Sa,y=>{a(m).length>0&&y(Va)})}var ja=s(Sa,2),na=t(ja),ba=s(t(na),2),Ga=t(ba);e(ba);var $a=s(ba,2),Ja=t($a);e($a),e(na);var ka=s(na,2),Da=s(t(ka),2),Wa=t(Da,!0);e(Da),G(2),e(ka),e(ja),M((y,x)=>{o(r,a(i)?.total_submissions||0),o(ta,a(i)?.recent_submissions||0),o(H,a(i)?.unread_count||0),o(Ia,a(i)?.starred_count||0),o(Ma,` Unread (${(a(i)?.unread_count||0)??""})`),A(za,`width: ${a(i)&&a(i).total_submissions>0?a(i).unread_count/a(i).total_submissions*100:0}%`),o(Ba,` Read (${(a(i)?.read_count||0)??""})`),A(Ka,`width: ${a(i)&&a(i).total_submissions>0?a(i).read_count/a(i).total_submissions*100:0}%`),o(Ua,` Starred (${(a(i)?.starred_count||0)??""})`),A(Ha,`width: ${a(i)&&a(i).total_submissions>0?a(i).starred_count/a(i).total_submissions*100:0}%`),o(Na,` Archived (${(a(i)?.archived_count||0)??""})`),A(Pa,`width: ${a(i)&&a(i).total_submissions>0?a(i).archived_count/a(i).total_submissions*100:0}%`),o(Ga,`${y??""}%`),A(Ja,`--progress: ${a(T)??""}`),o(Wa,x)},[()=>a(T).toFixed(1),U]),b(l,c)};$(W,l=>{a(z)?l(aa):l(ea,!1)})}e(D),b(Z,D),Ca()}var qe=u('<p class="page-description svelte-17e51jt"> </p>'),pe=u('<button class="btn-action svelte-17e51jt">âœï¸ Edit Form</button> <button class="btn-action svelte-17e51jt">ğŸ“Š View Submissions</button>',1),ge=u('<div class="loading-state svelte-17e51jt"><p>Loading analytics...</p></div>'),he=u('<div class="error-state svelte-17e51jt"><p> </p></div>'),ye=u('<div class="analytics-page svelte-17e51jt"><div class="page-header svelte-17e51jt"><div><button class="btn-back svelte-17e51jt">â† Back to Forms</button> <h1 class="svelte-17e51jt">Form Analytics</h1> <!></div> <div class="header-actions svelte-17e51jt"><!></div></div> <!></div>');function je(Z,S){Ea(S,!0);const i=()=>se(ie,"$page",z),[z,k]=ae();let m=R(null),J=R(!0),B=R(""),K=La(()=>parseInt(i().params.id));Oa(async()=>{try{j(m,await le(a(K)),!0)}catch(r){j(B,r instanceof Error?r.message:"Failed to load form",!0)}finally{j(J,!1)}});var U=ye();Za("17e51jt",r=>{ee(()=>{te.title="Form Analytics - Admin Dashboard"})});var T=t(U),D=t(T),W=t(D);W.__click=()=>ua("/admin/forms");var aa=s(W,4);{var ea=r=>{var n=qe(),g=t(n,!0);e(n),M(()=>o(g,a(m).title)),b(r,n)};$(aa,r=>{a(m)&&r(ea)})}e(D);var l=s(D,2),c=t(l);{var v=r=>{var n=pe(),g=Y(n);g.__click=()=>ua(`/admin/forms/${a(K)}/edit`);var E=s(g,2);E.__click=()=>ua(`/admin/forms/${a(K)}/submissions`),b(r,n)};$(c,r=>{a(m)&&r(v)})}e(l),e(T);var d=s(T,2);{var _=r=>{var n=ge();b(r,n)},p=r=>{var n=Ta(),g=Y(n);{var E=f=>{var h=he(),F=t(h),H=t(F,!0);e(F),e(h),M(()=>o(H,a(B))),b(f,h)},ta=f=>{var h=Ta(),F=Y(h);{var H=O=>{fe(O,{get form(){return a(m)}})};$(F,O=>{a(m)&&O(H)},!0)}b(f,h)};$(g,f=>{a(B)?f(E):f(ta,!1)},!0)}b(r,n)};$(d,r=>{a(J)?r(_):r(p,!1)})}e(U),b(Z,U),Ca(),k()}Ya(["click"]);export{je as component,Se as universal};
