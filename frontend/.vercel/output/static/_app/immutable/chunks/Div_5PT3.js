import{ab as Ke,ac as Bt,F as tt,d1 as Lt,z as ct,p as vt,a as $t,s as $e,A as aa,b as Wt,g as t,o as sa,C as ia,k as Ue,d as le,i as E,h as m,j as dt,c as K,f as w,q as a,ao as Jt,r as e,e as i,bH as ca,m as va,H as G,n as L,d3 as da,d4 as Rt,bE as ua,bJ as pa,af as Y,am as at,ai as Nt,bq as Me,aL as ga,aH as fa,bt as _a,aQ as At,bD as Qt,aC as ma,aD as ha,L as ba,U as Ft,M as Pt,a2 as ya,d5 as wa,aq as qt,S as na,bT as Ht,bC as ka,R as ft,be as Sa,V as Ca,w as V,x as D,N as Ie,Q as He,l as Ot,O as ze,D as ra,ah as Ye,d0 as _t,E as zt,ap as Yt,B as Ve,Z as Tt,bV as Aa,al as xt,_ as Se,cZ as qa,aj as xa,bx as Ut,P as Gt,d6 as oa,ar as $a,I as Na,$ as Oa,aZ as Kt,b1 as za,bA as Vt,d7 as Ta,ak as Ct,d8 as Xt}from"./C_QN0JMx.js";import{w as Da}from"./BpAP-whW.js";import{c as Ma,d as Ia}from"./KfBlM_pv.js";const Zt="rtp_notifications",ea=100;function Ra(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function Pa(){const r=()=>{try{const s=localStorage.getItem(Zt);if(s){const n=JSON.parse(s);return{notifications:n.notifications.map(u=>({...u,timestamp:new Date(u.timestamp)})),isLoading:!1,hasNewNotifications:n.notifications.some(u=>!u.read)}}}catch{}return{notifications:[],isLoading:!1,hasNewNotifications:!1}},{subscribe:g,set:p,update:l}=Bt(r());function h(s){try{const n={notifications:s.notifications.slice(0,ea)};localStorage.setItem(Zt,JSON.stringify(n))}catch{}}let k=null;function v(s){s&&(k=Da.subscribeToNotifications(s,n=>{S({id:n.id,type:n.type,priority:n.priority,title:n.title,message:n.message,timestamp:new Date(n.timestamp),read:n.read,dismissed:n.dismissed,action:n.action?{label:n.action.label,href:n.action.href}:void 0,metadata:n.metadata})}))}function f(){k&&(k(),k=null)}function S(s){const n={id:s.id||Ra(),type:s.type||"info",priority:s.priority||"normal",title:s.title,message:s.message,timestamp:s.timestamp||new Date,read:s.read??!1,dismissed:s.dismissed??!1,action:s.action,metadata:s.metadata};return l(u=>{const d={...u,notifications:[n,...u.notifications].slice(0,ea),hasNewNotifications:!0};return h(d),d}),(s.priority==="high"||s.priority==="urgent")&&ae(),s.priority==="urgent"&&J(n),n.id}function b(s){l(n=>{const u={...n,notifications:n.notifications.map(d=>d.id===s?{...d,read:!0}:d),hasNewNotifications:n.notifications.some(d=>d.id!==s&&!d.read)};return h(u),u})}function ce(){l(s=>{const n={...s,notifications:s.notifications.map(u=>({...u,read:!0})),hasNewNotifications:!1};return h(n),n})}function ne(s){l(n=>{const u={...n,notifications:n.notifications.map(d=>d.id===s?{...d,dismissed:!0,read:!0}:d)};return h(u),u})}function $(s){l(n=>{const u={...n,notifications:n.notifications.filter(d=>d.id!==s),hasNewNotifications:n.notifications.some(d=>d.id!==s&&!d.read)};return h(u),u})}function B(){const s={notifications:[],isLoading:!1,hasNewNotifications:!1};p(s),h(s)}function ae(){try{const s=new(window.AudioContext||window.webkitAudioContext),n=s.createOscillator(),u=s.createGain();n.connect(u),u.connect(s.destination),n.frequency.value=800,n.type="sine",u.gain.value=.1,n.start(),n.stop(s.currentTime+.1)}catch{}}async function J(s){"Notification"in window&&(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission==="granted"&&new Notification(s.title,{body:s.message,icon:"/favicon.png",tag:s.id}))}return{subscribe:g,add:S,markAsRead:b,markAllAsRead:ce,dismiss:ne,remove:$,clear:B,initWebSocket:v,destroyWebSocket:f,info:(s,n,u)=>S({...u,type:"info",title:s,message:n}),success:(s,n,u)=>S({...u,type:"success",title:s,message:n}),warning:(s,n,u)=>S({...u,type:"warning",title:s,message:n}),error:(s,n,u)=>S({...u,type:"error",title:s,message:n}),system:(s,n,u)=>S({...u,type:"system",title:s,message:n})}}const st=Pa(),Ea=Ke(st,r=>r.notifications),ja=Ke(st,r=>r.notifications.filter(g=>!g.read&&!g.dismissed)),La=Ke(ja,r=>r.length);Ke(st,r=>r.hasNewNotifications);Ke(st,r=>r.notifications.filter(g=>g.priority==="urgent"&&!g.dismissed));const Ha=[{id:"goto-dashboard",keys:["g","d"],description:"Go to Dashboard",category:"Navigation",global:!0},{id:"goto-analytics",keys:["g","a"],description:"Go to Analytics",category:"Navigation",global:!0},{id:"goto-blog",keys:["g","b"],description:"Go to Blog",category:"Navigation",global:!0},{id:"goto-crm",keys:["g","c"],description:"Go to CRM",category:"Navigation",global:!0},{id:"goto-email",keys:["g","e"],description:"Go to Email",category:"Navigation",global:!0},{id:"goto-media",keys:["g","m"],description:"Go to Media",category:"Navigation",global:!0},{id:"goto-settings",keys:["g","s"],description:"Go to Settings",category:"Navigation",global:!0},{id:"search",keys:["Meta","k"],description:"Open Command Palette",category:"Actions",global:!0},{id:"search-alt",keys:["Control","k"],description:"Open Command Palette",category:"Actions",global:!0},{id:"notifications",keys:["Meta","n"],description:"Toggle Notifications",category:"Actions",global:!0},{id:"refresh",keys:["Meta","r"],description:"Refresh Data",category:"Actions",global:!0},{id:"new-item",keys:["n"],description:"Create New Item",category:"Actions",global:!0},{id:"save",keys:["Meta","s"],description:"Save Changes",category:"Actions",global:!0},{id:"help",keys:["Shift","?"],description:"Show Shortcuts",category:"Help",global:!0},{id:"escape",keys:["Escape"],description:"Close Modal/Panel",category:"UI",global:!0},{id:"toggle-sidebar",keys:["Meta","b"],description:"Toggle Sidebar",category:"UI",global:!0},{id:"toggle-theme",keys:["Meta","Shift","t"],description:"Toggle Theme",category:"UI",global:!0}],Ua={shortcuts:[],isHelpOpen:!1,activeContext:"global"},xe=Bt(Ua);let pt=[],gt=null,Et=!1;function ta(r){const g=r.target;if((g.tagName==="INPUT"||g.tagName==="TEXTAREA"||g.isContentEditable)&&r.key!=="Escape"&&!(r.metaKey||r.ctrlKey))return;const p=Lt(xe),l=r.key,h=[];if(r.metaKey&&h.push("Meta"),r.ctrlKey&&h.push("Control"),r.shiftKey&&h.push("Shift"),r.altKey&&h.push("Alt"),h.length>0){const k=p.shortcuts.find(v=>{if(!v.enabled)return!1;const f=v.keys.filter(b=>["Meta","Control","Shift","Alt"].includes(b)),S=v.keys.find(b=>!["Meta","Control","Shift","Alt"].includes(b));return f.every(b=>h.includes(b))&&h.every(b=>f.includes(b))&&S?.toLowerCase()===l.toLowerCase()});if(k){r.preventDefault(),k.action();return}}if(h.length===0&&l.length===1){gt&&clearTimeout(gt),pt.push(l.toLowerCase()),gt=setTimeout(()=>{pt=[]},500);const k=p.shortcuts.find(v=>!v.enabled||v.keys.some(f=>["Meta","Control","Shift","Alt"].includes(f))?!1:v.keys.length===pt.length&&v.keys.every((f,S)=>f.toLowerCase()===pt[S]));k&&(r.preventDefault(),pt=[],gt&&clearTimeout(gt),k.action())}if(l==="Escape"){const k=p.shortcuts.find(v=>v.id==="escape"&&v.enabled);k&&k.action()}l==="?"&&r.shiftKey&&(r.preventDefault(),xe.update(k=>({...k,isHelpOpen:!k.isHelpOpen})))}const jt={subscribe:xe.subscribe,init(r={}){if(Et)return;const g=Ha.map(p=>({...p,enabled:!0,action:r[p.id]||(()=>{if(p.id.startsWith("goto-")){const l=p.id.replace("goto-",""),h={dashboard:"/admin",analytics:"/admin/analytics",blog:"/admin/blog",crm:"/admin/crm",email:"/admin/email/campaigns",media:"/admin/media",settings:"/admin/settings"};h[l]&&tt(h[l])}})}));xe.update(p=>({...p,shortcuts:g})),window.addEventListener("keydown",ta),Et=!0},destroy(){window.removeEventListener("keydown",ta),Et=!1},register(r){xe.update(g=>({...g,shortcuts:[...g.shortcuts.filter(p=>p.id!==r.id),{...r,enabled:!0}]}))},registerAction(r,g){xe.update(p=>({...p,shortcuts:p.shortcuts.map(l=>l.id===r?{...l,action:g,enabled:!0}:l)}))},unregister(r){xe.update(g=>({...g,shortcuts:g.shortcuts.filter(p=>p.id!==r)}))},setEnabled(r,g){xe.update(p=>({...p,shortcuts:p.shortcuts.map(l=>l.id===r?{...l,enabled:g}:l)}))},setContext(r){xe.update(g=>({...g,activeContext:r}))},toggleHelp(){xe.update(r=>({...r,isHelpOpen:!r.isHelpOpen}))},openHelp(){xe.update(r=>({...r,isHelpOpen:!0}))},closeHelp(){xe.update(r=>({...r,isHelpOpen:!1}))},formatKeys(r){const g={Meta:navigator?.platform?.includes("Mac")?"⌘":"Ctrl",Control:"Ctrl",Shift:"⇧",Alt:navigator?.platform?.includes("Mac")?"⌥":"Alt",Escape:"Esc",ArrowUp:"↑",ArrowDown:"↓",ArrowLeft:"←",ArrowRight:"→"};return r.map(p=>g[p]||p.toUpperCase()).join(" + ")}};var Ka=w('<div class="no-results svelte-wh9uu8"><!> <p class="svelte-wh9uu8"> </p></div>'),Ba=w('<div class="item-action svelte-wh9uu8"><!></div>'),Wa=w('<button><div class="item-icon svelte-wh9uu8"><!></div> <span class="item-label svelte-wh9uu8"> </span> <!></button>'),Ga=w('<div class="results-group svelte-wh9uu8"><div class="group-label svelte-wh9uu8"> </div> <!></div>'),Ja=w('<div class="command-palette-overlay svelte-wh9uu8" role="dialog" aria-modal="true" aria-label="Command Palette" tabindex="-1"><div class="command-palette svelte-wh9uu8"><div class="search-header svelte-wh9uu8"><div class="search-icon svelte-wh9uu8"><!></div> <input type="text" placeholder="Search pages, actions, or type a command..." class="search-input svelte-wh9uu8" autocomplete="off" spellcheck="false"/> <div class="keyboard-hint svelte-wh9uu8"><kbd class="svelte-wh9uu8">esc</kbd></div></div> <div class="results-container svelte-wh9uu8"><!></div> <div class="palette-footer svelte-wh9uu8"><div class="footer-hints svelte-wh9uu8"><span class="hint svelte-wh9uu8"><kbd class="svelte-wh9uu8"><!></kbd> <kbd class="svelte-wh9uu8"><!></kbd> Navigate</span> <span class="hint svelte-wh9uu8"><kbd class="svelte-wh9uu8"><!></kbd> Select</span> <span class="hint svelte-wh9uu8"><kbd class="svelte-wh9uu8">esc</kbd> Close</span></div> <div class="footer-shortcut svelte-wh9uu8"><kbd class="svelte-wh9uu8"><!></kbd> <kbd class="svelte-wh9uu8">K</kbd></div></div></div></div>');function Ls(r,g){vt(g,!0);let p=$t(g,"isOpen",15,!1),l=$e(""),h=$e(0),k=$e(null),v=$e(aa([]));const f=[{id:"dashboard",label:"Dashboard",path:"/admin",icon:ga,category:"Navigation"},{id:"analytics",label:"Analytics",path:"/admin/analytics",icon:fa,category:"Navigation"},{id:"seo",label:"SEO Settings",path:"/admin/seo",icon:_a,category:"Navigation"},{id:"behavior",label:"Behavior Tracking",path:"/admin/behavior",icon:At,category:"Navigation"},{id:"blog",label:"Blog Posts",path:"/admin/blog",icon:Qt,category:"Content"},{id:"media",label:"Media Library",path:"/admin/media",icon:ma,category:"Content"},{id:"videos",label:"Videos",path:"/admin/videos",icon:ha,category:"Content"},{id:"forms",label:"Forms",path:"/admin/forms",icon:ba,category:"Content"},{id:"members",label:"Members",path:"/admin/members",icon:Ft,category:"Users"},{id:"crm",label:"CRM",path:"/admin/crm",icon:Ft,category:"Users"},{id:"campaigns",label:"Email Campaigns",path:"/admin/email/campaigns",icon:Pt,category:"Marketing"},{id:"templates",label:"Email Templates",path:"/admin/email/templates",icon:Pt,category:"Marketing"},{id:"products",label:"Products",path:"/admin/products",icon:ya,category:"Commerce"},{id:"subscriptions",label:"Subscriptions",path:"/admin/subscriptions",icon:wa,category:"Commerce"},{id:"connections",label:"API Connections",path:"/admin/connections",icon:qt,category:"Settings"},{id:"site-health",label:"Site Health",path:"/admin/site-health",icon:At,category:"Settings"},{id:"settings",label:"Settings",path:"/admin/settings",icon:na,category:"Settings"}],S=[{id:"new-post",label:"Create New Post",action:()=>tt("/admin/blog/new"),icon:Qt,category:"Quick Actions"},{id:"new-campaign",label:"Create Email Campaign",action:()=>tt("/admin/email/campaigns?new=true"),icon:Pt,category:"Quick Actions"},{id:"upload-media",label:"Upload Media",action:()=>tt("/admin/media?upload=true"),icon:Ht,category:"Quick Actions"},{id:"export-data",label:"Export Data",action:()=>tt("/admin/settings?export=true"),icon:ka,category:"Quick Actions"},{id:"refresh-all",label:"Refresh All Data",action:()=>window.location.reload(),icon:ft,category:"Quick Actions"},{id:"clear-cache",label:"Clear Cache",action:()=>{localStorage.clear(),window.location.reload()},icon:Sa,category:"Quick Actions"},{id:"logout",label:"Logout",action:()=>tt("/logout"),icon:Ca,category:"Quick Actions"}];function b(c,C){const o=c.toLowerCase(),_=C.toLowerCase();let y=0;for(let T=0;T<o.length&&y<_.length;T++)o[T]===_[y]&&y++;return y===_.length}let ce=L(()=>t(l).trim()===""?[...f.slice(0,5),...S.slice(0,3)]:[...f.filter(c=>b(c.label,t(l))||b(c.category,t(l))),...S.filter(c=>b(c.label,t(l))||b(c.category,t(l)))]),ne=L(()=>t(ce).reduce((c,C)=>(c[C.category]||(c[C.category]=[]),c[C.category].push(C),c),{})),$=L(()=>Object.values(t(ne)).flat());function B(c){if(p())switch(c.key){case"ArrowDown":c.preventDefault(),K(h,Math.min(t(h)+1,t($).length-1),!0);break;case"ArrowUp":c.preventDefault(),K(h,Math.max(t(h)-1,0),!0);break;case"Enter":c.preventDefault(),ae(t($)[t(h)]);break;case"Escape":c.preventDefault(),n();break}}function ae(c){t(l).trim()&&J(t(l)),"path"in c?tt(c.path):"action"in c&&c.action(),n()}function J(c){const C=JSON.parse(localStorage.getItem("recentSearches")||"[]"),o=[c,...C.filter(_=>_!==c)].slice(0,5);localStorage.setItem("recentSearches",JSON.stringify(o)),K(v,o,!0)}function s(){K(v,JSON.parse(localStorage.getItem("recentSearches")||"[]"),!0)}function n(){p(!1),K(l,""),K(h,0),g.onclose?.()}function u(c){c.target===c.currentTarget&&n()}function d(c){(c.metaKey||c.ctrlKey)&&c.key==="k"&&(c.preventDefault(),p(!p()))}Wt(()=>{p()&&t(k)&&setTimeout(()=>t(k)?.focus(),50)}),sa(()=>{s(),window.addEventListener("keydown",d)}),ia(()=>{window.removeEventListener("keydown",d)});var x=Ue(),A=le(x);{var R=c=>{var C=Ja();C.__click=u,C.__keydown=B;var o=a(C),_=a(o),y=a(_),T=a(y);Jt(T,{size:20}),e(y);var q=i(y,2);ca(q),va(q,M=>K(k,M),()=>t(k)),G(2),e(_);var P=i(_,2),Z=a(P);{var H=M=>{var ie=Ka(),Ne=a(ie);Jt(Ne,{size:32});var Te=i(Ne,2),we=a(Te);e(Te),e(ie),V(()=>D(we,`No results found for "${t(l)??""}"`)),Y(1,ie,()=>Me,()=>({duration:150})),m(M,ie)},N=M=>{var ie=Ue(),Ne=le(ie);Ie(Ne,17,()=>Object.entries(t(ne)),He,(Te,we,Be)=>{var We=L(()=>_t(t(we),2));let Ce=()=>t(We)[0],Xe=()=>t(We)[1];var Ge=Ga(),Ze=a(Ge),Je=a(Ze,!0);e(Ze);var pe=i(Ze,2);Ie(pe,17,Xe,He,(it,Ae)=>{const I=L(()=>t($).indexOf(t(Ae))),Q=L(()=>t(Ae).icon);var de=Wa();let qe;de.__click=()=>ae(t(Ae));var ge=a(de),F=a(ge);Ot(F,()=>t(Q),(me,he)=>{he(me,{size:18})}),e(ge);var W=i(ge,2),U=a(W,!0);e(W);var Re=i(W,2);{var _e=me=>{var he=Ba(),et=a(he);Rt(et,{size:14}),e(he),m(me,he)};E(Re,me=>{t(h)===t(I)&&me(_e)})}e(de),V(()=>{qe=ze(de,1,"result-item svelte-wh9uu8",null,qe,{selected:t(h)===t(I)}),D(U,t(Ae).label)}),ra("mouseenter",de,()=>K(h,t(I),!0)),m(it,de)}),e(Ge),V(()=>D(Je,Ce())),Y(1,Ge,()=>Ye,()=>({y:10,duration:200,delay:Be*50})),m(Te,Ge)}),m(M,ie)};E(Z,M=>{t($).length===0?M(H):M(N,!1)})}e(P);var O=i(P,2),ee=a(O),oe=a(ee),se=a(oe),re=a(se);da(re,{size:12}),e(se);var X=i(se,2),fe=a(X);Rt(fe,{size:12}),e(X),G(),e(oe);var ue=i(oe,2),be=a(ue),ye=a(be);Rt(ye,{size:12}),e(be),G(),e(ue),G(2),e(ee);var ve=i(ee,2),z=a(ve),j=a(z);ua(j,{size:12}),e(z),G(2),e(ve),e(O),e(o),e(C),pa(q,()=>t(l),M=>K(l,M)),Y(3,o,()=>Nt,()=>({duration:200,start:.95,easing:at})),Y(3,C,()=>Me,()=>({duration:150})),m(c,C)};E(A,c=>{p()&&c(R)})}m(r,x),dt()}ct(["click","keydown"]);var Qa=w('<span class="unread-badge svelte-1qus79u"> </span>'),Fa=w('<span class="tab-count svelte-1qus79u"> </span>'),Ya=w('<div class="actions-bar svelte-1qus79u"><button class="action-btn svelte-1qus79u"><!> Mark all as read</button></div>'),Va=w(`<div class="empty-state svelte-1qus79u"><!> <h3 class="svelte-1qus79u">No notifications</h3> <p class="svelte-1qus79u">You're all caught up!</p></div>`),Xa=w('<div class="item-action svelte-1qus79u"><span> </span> <!></div>'),Za=w('<div class="unread-dot svelte-1qus79u"></div>'),es=w('<button><div class="item-icon svelte-1qus79u"><!></div> <div class="item-content svelte-1qus79u"><div class="item-header svelte-1qus79u"><span class="item-title svelte-1qus79u"> </span> <span class="item-time svelte-1qus79u"> </span></div> <p class="item-message svelte-1qus79u"> </p> <!></div> <!></button>'),ts=w('<div class="notification-group svelte-1qus79u"><div class="group-label svelte-1qus79u"> </div> <!></div>'),as=w('<div class="notification-overlay svelte-1qus79u" role="button" tabindex="0" aria-label="Close notification center"><div class="notification-panel svelte-1qus79u" role="presentation"><div class="panel-header svelte-1qus79u"><div class="header-left svelte-1qus79u"><!> <h2 class="svelte-1qus79u">Notifications</h2> <!></div> <button class="close-btn svelte-1qus79u"><!></button></div> <div class="filter-tabs svelte-1qus79u"><button>All</button> <button>Unread <!></button></div> <!> <div class="notifications-list svelte-1qus79u"><!></div> <div class="panel-footer svelte-1qus79u"><button class="footer-btn svelte-1qus79u"><!> Clear all</button></div></div></div>');function Hs(r,g){vt(g,!0);const p=()=>Ve(Ea,"$notifications",h),l=()=>Ve(La,"$unreadCount",h),[h,k]=zt();let v=$t(g,"isOpen",15,!1),f=$e("all"),S=L(()=>t(f)==="unread"?p().filter(d=>!d.read&&!d.dismissed):p().filter(d=>!d.dismissed));function b(d){const x={Today:[],Yesterday:[],"This Week":[],Older:[]},A=new Date,R=new Date(A.getFullYear(),A.getMonth(),A.getDate()),c=new Date(R);c.setDate(c.getDate()-1);const C=new Date(R);C.setDate(C.getDate()-7);for(const o of d){const _=new Date(o.timestamp);_>=R?x.Today.push(o):_>=c?x.Yesterday.push(o):_>=C?x["This Week"].push(o):x.Older.push(o)}return Object.entries(x).filter(([o,_])=>_.length>0)}let ce=L(()=>b(t(S)));function ne(d){switch(d){case"success":return oa;case"warning":return Gt;case"error":return Ut;case"system":return na;default:return xa}}function $(d){switch(d){case"success":return"#10b981";case"warning":return"#f59e0b";case"error":return"#ef4444";case"system":return"#8b5cf6";default:return"#3b82f6"}}function B(d){const x=new Date(d),R=new Date().getTime()-x.getTime(),c=Math.floor(R/6e4),C=Math.floor(R/36e5);return c<1?"Just now":c<60?`${c}m ago`:C<24?`${C}h ago`:x.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function ae(d){st.markAsRead(d.id),d.action?.href?window.location.href=d.action.href:d.action?.onClick&&d.action.onClick()}function J(){v(!1),g.onclose?.()}var s=Ue(),n=le(s);{var u=d=>{var x=as();x.__click=J,x.__keydown=z=>z.key==="Enter"&&J();var A=a(x);A.__click=z=>z.stopPropagation(),A.__keydown=z=>z.stopPropagation();var R=a(A),c=a(R),C=a(c);Yt(C,{size:20});var o=i(C,4);{var _=z=>{var j=Qa(),M=a(j,!0);e(j),V(()=>D(M,l())),m(z,j)};E(o,z=>{l()>0&&z(_)})}e(c);var y=i(c,2);y.__click=J;var T=a(y);Tt(T,{size:20}),e(y),e(R);var q=i(R,2),P=a(q);let Z;P.__click=()=>K(f,"all");var H=i(P,2);let N;H.__click=()=>K(f,"unread");var O=i(a(H));{var ee=z=>{var j=Fa(),M=a(j,!0);e(j),V(()=>D(M,l())),m(z,j)};E(O,z=>{l()>0&&z(ee)})}e(H),e(q);var oe=i(q,2);{var se=z=>{var j=Ya(),M=a(j);M.__click=()=>st.markAllAsRead();var ie=a(M);xt(ie,{size:16}),G(),e(M),e(j),Y(1,j,()=>Me,()=>({duration:150})),m(z,j)};E(oe,z=>{l()>0&&z(se)})}var re=i(oe,2),X=a(re);{var fe=z=>{var j=Va(),M=a(j);Yt(M,{size:48}),G(4),e(j),Y(1,j,()=>Nt,()=>({duration:200})),m(z,j)},ue=z=>{var j=Ue(),M=le(j);Ie(M,17,()=>t(ce),He,(ie,Ne,Te)=>{var we=L(()=>_t(t(Ne),2));let Be=()=>t(we)[0],We=()=>t(we)[1];var Ce=ts(),Xe=a(Ce),Ge=a(Xe,!0);e(Xe);var Ze=i(Xe,2);Ie(Ze,17,We,Je=>Je.id,(Je,pe)=>{const it=L(()=>ne(t(pe).type));var Ae=es();let I;Ae.__click=()=>ae(t(pe));var Q=a(Ae),de=a(Q);Ot(de,()=>t(it),(te,ke)=>{ke(te,{size:20})}),e(Q);var qe=i(Q,2),ge=a(qe),F=a(ge),W=a(F,!0);e(F);var U=i(F,2),Re=a(U,!0);e(U),e(ge);var _e=i(ge,2),me=a(_e,!0);e(_e);var he=i(_e,2);{var et=te=>{var ke=Xa(),De=a(ke),ut=a(De,!0);e(De);var Ee=i(De,2);qa(Ee,{size:14}),e(ke),V(()=>D(ut,t(pe).action.label)),m(te,ke)};E(he,te=>{t(pe).action&&te(et)})}e(qe);var Qe=i(qe,2);{var Pe=te=>{var ke=Za();m(te,ke)};E(Qe,te=>{t(pe).read||te(Pe)})}e(Ae),V((te,ke)=>{I=ze(Ae,1,"notification-item svelte-1qus79u",null,I,{unread:!t(pe).read}),Se(Q,`color: ${te??""}`),D(W,t(pe).title),D(Re,ke),D(me,t(pe).message)},[()=>$(t(pe).type),()=>B(t(pe).timestamp)]),m(Je,Ae)}),e(Ce),V(()=>D(Ge,Be())),Y(1,Ce,()=>Ye,()=>({y:20,duration:200,delay:Te*50})),m(ie,Ce)}),m(z,j)};E(X,z=>{t(S).length===0?z(fe):z(ue,!1)})}e(re);var be=i(re,2),ye=a(be);ye.__click=()=>st.clear();var ve=a(ye);Aa(ve,{size:16}),G(),e(ye),e(be),e(A),e(x),V(()=>{Z=ze(P,1,"filter-tab svelte-1qus79u",null,Z,{active:t(f)==="all"}),N=ze(H,1,"filter-tab svelte-1qus79u",null,N,{active:t(f)==="unread"})}),Y(3,A,()=>Ye,()=>({x:320,duration:300,easing:at})),Y(3,x,()=>Me,()=>({duration:150})),m(d,x)};E(n,d=>{v()&&d(u)})}m(r,s),dt(),k()}ct(["click","keydown"]);var ss=w('<span class="key-separator svelte-1wy194f">+</span>'),is=w('<!> <kbd class="svelte-1wy194f"> </kbd>',1),ns=w('<div class="shortcut-item svelte-1wy194f"><span class="shortcut-description svelte-1wy194f"> </span> <div class="shortcut-keys svelte-1wy194f"></div></div>'),rs=w('<div class="shortcut-group svelte-1wy194f"><h3 class="group-title svelte-1wy194f"> </h3> <div class="shortcuts-list svelte-1wy194f"></div></div>'),os=w('<div class="shortcuts-overlay svelte-1wy194f" role="dialog" aria-modal="true" tabindex="-1"><div class="shortcuts-modal svelte-1wy194f"><div class="modal-header svelte-1wy194f"><div class="header-title svelte-1wy194f"><!> <h2 class="svelte-1wy194f">Keyboard Shortcuts</h2></div> <button class="close-btn svelte-1wy194f"><!></button></div> <div class="modal-content svelte-1wy194f"></div> <div class="modal-footer svelte-1wy194f"><span class="footer-hint svelte-1wy194f">Press <kbd class="svelte-1wy194f">?</kbd> to toggle this help</span></div></div></div>');function Us(r,g){vt(g,!0);const p=()=>Ve(jt,"$keyboard",l),[l,h]=zt();let k=$t(g,"isOpen",15,!1),v=L(()=>p().shortcuts.filter($=>$.enabled).reduce(($,B)=>($[B.category]||($[B.category]=[]),$[B.category].push(B),$),{}));function f(){k(!1),jt.closeHelp(),g.onclose?.()}function S($){$.target===$.currentTarget&&f()}Wt(()=>{p().isHelpOpen!==k()&&k(p().isHelpOpen)});var b=Ue(),ce=le(b);{var ne=$=>{var B=os();B.__click=S,B.__keydown=A=>A.key==="Escape"&&f();var ae=a(B),J=a(ae),s=a(J),n=a(s);$a(n,{size:24}),G(2),e(s);var u=i(s,2);u.__click=f;var d=a(u);Tt(d,{size:20}),e(u),e(J);var x=i(J,2);Ie(x,21,()=>Object.entries(t(v)),He,(A,R)=>{var c=L(()=>_t(t(R),2));let C=()=>t(c)[0],o=()=>t(c)[1];var _=rs(),y=a(_),T=a(y,!0);e(y);var q=i(y,2);Ie(q,21,o,He,(P,Z)=>{var H=ns(),N=a(H),O=a(N,!0);e(N);var ee=i(N,2);Ie(ee,21,()=>t(Z).keys,He,(oe,se,re)=>{var X=is(),fe=le(X);{var ue=ve=>{var z=ss();m(ve,z)};E(fe,ve=>{re>0&&ve(ue)})}var be=i(fe,2),ye=a(be,!0);e(be),V(ve=>D(ye,ve),[()=>jt.formatKeys([t(se)])]),m(oe,X)}),e(ee),e(H),V(()=>D(O,t(Z).description)),m(P,H)}),e(q),e(_),V(()=>D(T,C())),m(A,_)}),e(x),G(2),e(ae),e(B),Y(3,ae,()=>Nt,()=>({duration:200,start:.95,easing:at})),Y(3,B,()=>Me,()=>({duration:150})),m($,B)};E(ce,$=>{k()&&$(ne)})}m(r,b),dt(),h()}ct(["click","keydown"]);var ls=w('<div class="limit-item svelte-gh415e"><div class="limit-header svelte-gh415e"><span class="service-name svelte-gh415e"> </span> <span class="limit-status svelte-gh415e"> </span></div> <div class="limit-bar-container svelte-gh415e"><div class="limit-bar svelte-gh415e"></div></div> <div class="limit-footer svelte-gh415e"><span class="reset-time svelte-gh415e"><!> </span> <span class="percentage svelte-gh415e"> </span></div></div>'),cs=w('<div class="rate-limit-dropdown svelte-gh415e" role="menu" tabindex="-1"><div class="dropdown-header svelte-gh415e"><h4 class="svelte-gh415e">API Rate Limits</h4> <span class="header-status svelte-gh415e"><!> </span></div> <div class="limits-list svelte-gh415e"></div> <div class="dropdown-footer svelte-gh415e"><span class="footer-note svelte-gh415e">Rate limits refresh every minute</span></div></div>'),vs=w('<div class="rate-limit-container svelte-gh415e"><button title="API Rate Limits"><!> <span class="limit-percentage"> </span> <span><!></span></button> <!></div>');function Ks(r,g){vt(g,!0);let p=$e(!1),l=$e(aa([])),h=$e(void 0);async function k(){try{const o=localStorage.getItem("access_token"),_=await fetch("/api/admin/connections/status",{headers:{Authorization:o?`Bearer ${o}`:"",Accept:"application/json"}});if(!_.ok)return v();const y=await _.json(),T=[];if(y.connections&&Array.isArray(y.connections)){for(const q of y.connections)if(q.status==="connected"&&q.rate_limit){const P=q.rate_limit.limit||1e3,Z=q.rate_limit.remaining??P,H=Z/P*100;let N="ok";H<10?N="critical":H<25&&(N="warning"),T.push({service:q.name||q.key,limit:P,remaining:Z,percentage:H,status:N,resetsAt:q.rate_limit.resets_at?new Date(q.rate_limit.resets_at):null})}}return T.length>0?T:v()}catch{return v()}}function v(){return[{service:"API",limit:1e3,remaining:1e3,percentage:100,status:"ok",resetsAt:null}]}let f=L(()=>t(l).some(o=>o.status==="critical")?"critical":t(l).some(o=>o.status==="warning")?"warning":"ok"),S=L(()=>t(l).length>0?Math.min(...t(l).map(o=>o.percentage)):100);function b(o){switch(o){case"critical":return"#ef4444";case"warning":return"#f59e0b";default:return"#10b981"}}function ce(o){switch(o){case"critical":return Gt;case"warning":return Kt;default:return oa}}function ne(o){if(!o)return"N/A";const _=o.getTime()-Date.now();if(_<=0)return"Now";const y=Math.floor(_/6e4);return y<60?`${y}m`:`${Math.floor(y/60)}h ${y%60}m`}function $(){K(p,!t(p))}function B(){K(p,!1)}sa(async()=>{K(l,await k(),!0),K(h,setInterval(async()=>{K(l,await k(),!0)},6e4),!0)}),ia(()=>{t(h)&&clearInterval(t(h))});var ae=vs();ra("click",Oa,B);var J=a(ae);let s;J.__click=o=>{o.stopPropagation(),$()};var n=a(J);qt(n,{size:18});var u=i(n,2),d=a(u);e(u);var x=i(u,2);let A;var R=a(x);Na(R,{size:14}),e(x),e(J);var c=i(J,2);{var C=o=>{const _=L(()=>ce(t(f)));var y=cs();y.__click=N=>N.stopPropagation(),y.__keydown=N=>N.stopPropagation();var T=a(y),q=i(a(T),2),P=a(q);Ot(P,()=>t(_),(N,O)=>{O(N,{size:14})});var Z=i(P);e(q),e(T);var H=i(T,2);Ie(H,21,()=>t(l),He,(N,O)=>{var ee=ls(),oe=a(ee),se=a(oe),re=a(se,!0);e(se);var X=i(se,2),fe=a(X);e(X),e(oe);var ue=i(oe,2),be=a(ue);e(ue);var ye=i(ue,2),ve=a(ye),z=a(ve);Kt(z,{size:12});var j=i(z);e(ve);var M=i(ve,2),ie=a(M);e(M),e(ye),e(ee),V((Ne,Te,we,Be,We,Ce)=>{D(re,t(O).service),Se(X,`color: ${Ne??""}`),D(fe,`${Te??""} / ${we??""}`),Se(be,`width: ${t(O).percentage??""}%; background: ${Be??""}`),D(j,` Resets in ${We??""}`),D(ie,`${Ce??""}% remaining`)},[()=>b(t(O).status),()=>t(O).remaining.toLocaleString(),()=>t(O).limit.toLocaleString(),()=>b(t(O).status),()=>ne(t(O).resetsAt),()=>Math.round(t(O).percentage)]),m(N,ee)}),e(H),G(2),e(y),V(N=>{Se(q,`color: ${N??""}`),D(Z,` ${t(f)==="ok"?"All services healthy":t(f)==="warning"?"Some limits low":"Critical limits reached"}`)},[()=>b(t(f))]),Y(3,y,()=>Nt,()=>({duration:200,start:.95})),m(o,y)};E(c,o=>{t(p)&&o(C)})}e(ae),V(o=>{s=ze(J,1,"rate-limit-btn svelte-gh415e",null,s,{warning:t(f)==="warning",critical:t(f)==="critical"}),D(d,`${o??""}%`),A=ze(x,1,"chevron svelte-gh415e",null,A,{rotated:t(p)})},[()=>Math.round(t(S))]),m(r,ae),dt()}ct(["click","keydown"]);var ds=w("<!> <span>All Systems Operational</span>",1),us=w("<!> <span>Some Services Degraded</span>",1),ps=w("<!> <span>Services Unavailable</span>",1),gs=w('<div class="quick-metrics svelte-qu7w3o"><span class="metric svelte-qu7w3o"><!> </span> <span class="metric svelte-qu7w3o"><!> </span></div>'),fs=w('<div><div class="service-status svelte-qu7w3o"><!></div> <div class="service-info svelte-qu7w3o"><div class="service-header svelte-qu7w3o"><span class="service-name svelte-qu7w3o"> </span> <span class="status-badge svelte-qu7w3o"> </span></div> <p class="service-description svelte-qu7w3o"> </p> <!></div> <div class="service-actions svelte-qu7w3o"><button class="action-btn svelte-qu7w3o" title="Refresh connection"><!></button> <a href="/admin/connections" class="action-btn svelte-qu7w3o" title="Configure"><!></a></div></div>'),_s=w('<div class="services-list svelte-qu7w3o"></div>'),ms=w('<div class="metrics-card svelte-qu7w3o"><div class="metrics-header svelte-qu7w3o"><span class="service-name svelte-qu7w3o"> </span> <span class="status-dot svelte-qu7w3o"></span></div> <div class="metrics-grid svelte-qu7w3o"><div class="metric-item svelte-qu7w3o"><span class="metric-label svelte-qu7w3o">Response Time</span> <span class="metric-value svelte-qu7w3o"> </span> <div class="metric-bar svelte-qu7w3o"><div class="metric-bar-fill svelte-qu7w3o"></div></div></div> <div class="metric-item svelte-qu7w3o"><span class="metric-label svelte-qu7w3o">Uptime</span> <span class="metric-value svelte-qu7w3o"> </span> <div class="metric-bar svelte-qu7w3o"><div class="metric-bar-fill svelte-qu7w3o"></div></div></div> <div class="metric-item svelte-qu7w3o"><span class="metric-label svelte-qu7w3o">Error Rate</span> <span class="metric-value svelte-qu7w3o"> </span> <div class="metric-bar svelte-qu7w3o"><div class="metric-bar-fill error svelte-qu7w3o"></div></div></div></div></div>'),hs=w('<div class="metrics-view svelte-qu7w3o"></div>'),bs=w('<div class="health-overlay svelte-qu7w3o" role="button" tabindex="0" aria-label="Close connection health panel"><div class="health-panel svelte-qu7w3o" role="presentation"><div class="panel-header svelte-qu7w3o"><div class="header-left svelte-qu7w3o"><div><!></div> <div class="header-info svelte-qu7w3o"><h2 class="svelte-qu7w3o">Connection Health</h2> <span class="connection-summary svelte-qu7w3o"> </span></div></div> <div class="header-actions svelte-qu7w3o"><button class="refresh-all-btn svelte-qu7w3o"><!> Refresh All</button> <button class="close-btn svelte-qu7w3o"><!></button></div></div> <div><div class="status-indicator svelte-qu7w3o"><!></div> <span class="last-check svelte-qu7w3o">Last checked: Just now</span></div> <div class="panel-tabs svelte-qu7w3o"><button><!> Overview</button> <button><!> Metrics</button></div> <div class="panel-content svelte-qu7w3o"><!></div> <div class="panel-footer svelte-qu7w3o"><a href="/admin/site-health" class="view-all-link svelte-qu7w3o"><!> View Full Site Health Dashboard <!></a></div></div></div>');function Bs(r,g){vt(g,!0);const p=()=>Ve(Ia,"$allConnectionStatuses",l),[l,h]=zt();let k=$t(g,"isOpen",15,!1),v=$e(null),f=$e("overview");const S={wordpress:{responseTime:145,uptime:99.9,errorRate:.1},analytics:{responseTime:220,uptime:99.5,errorRate:.3},seo:{responseTime:180,uptime:99.8,errorRate:.2},email:{responseTime:95,uptime:99.95,errorRate:.05},crm:{responseTime:310,uptime:98.5,errorRate:1.2},behavior:{responseTime:125,uptime:99.7,errorRate:.15}},b={wordpress:"WordPress",analytics:"Analytics",seo:"SEO",email:"Email",crm:"CRM",behavior:"Behavior"},ce={wordpress:"Blog posts, pages, and media management",analytics:"Traffic and user engagement tracking",seo:"Search engine optimization settings",email:"Email campaigns and templates",crm:"Customer relationship management",behavior:"User behavior and session tracking"};function ne(o){switch(o){case"connected":return xt;case"connecting":return Ct;case"error":return Ut;default:return Ta}}function $(o){switch(o){case"connected":return"#10b981";case"connecting":return"#f59e0b";case"error":return"#ef4444";default:return"#64748b"}}function B(o){switch(o){case"connected":return"Connected";case"connecting":return"Connecting...";case"error":return"Error";default:return"Disconnected"}}function ae(o){return o<200?"#10b981":o<500?"#f59e0b":"#ef4444"}function J(o){return o>=99.5?"#10b981":o>=98?"#f59e0b":"#ef4444"}async function s(o){K(v,o,!0);try{await Ma.load(!0)}finally{K(v,null)}}async function n(){for(const o of Object.keys(b))await s(o)}function u(){k(!1),g.onclose?.()}let d=L(()=>Object.values(p()).filter(o=>o==="connected").length),x=L(()=>Object.keys(p()).length),A=L(()=>t(d)===t(x)?"healthy":t(d)>0?"partial":"unhealthy");var R=Ue(),c=le(R);{var C=o=>{var _=bs();_.__click=u,_.__keydown=I=>I.key==="Enter"&&u();var y=a(_);y.__click=I=>I.stopPropagation(),y.__keydown=I=>I.stopPropagation();var T=a(y),q=a(T),P=a(q);let Z;var H=a(P);qt(H,{size:20}),e(P);var N=i(P,2),O=i(a(N),2),ee=a(O);e(O),e(N),e(q);var oe=i(q,2),se=a(oe);se.__click=n;var re=a(se);{let I=L(()=>t(v)?"spinning":"");ft(re,{size:16,get class(){return t(I)}})}G(),e(se);var X=i(se,2);X.__click=u;var fe=a(X);Tt(fe,{size:20}),e(X),e(oe),e(T);var ue=i(T,2);let be;var ye=a(ue),ve=a(ye);{var z=I=>{var Q=ds(),de=le(Q);xt(de,{size:18}),G(2),m(I,Q)},j=I=>{var Q=Ue(),de=le(Q);{var qe=F=>{var W=us(),U=le(W);Gt(U,{size:18}),G(2),m(F,W)},ge=F=>{var W=ps(),U=le(W);Ut(U,{size:18}),G(2),m(F,W)};E(de,F=>{t(A)==="partial"?F(qe):F(ge,!1)},!0)}m(I,Q)};E(ve,I=>{t(A)==="healthy"?I(z):I(j,!1)})}e(ye),G(2),e(ue);var M=i(ue,2),ie=a(M);let Ne;ie.__click=()=>K(f,"overview");var Te=a(ie);qt(Te,{size:16}),G(),e(ie);var we=i(ie,2);let Be;we.__click=()=>K(f,"details");var We=a(we);za(We,{size:16}),G(),e(we),e(M);var Ce=i(M,2),Xe=a(Ce);{var Ge=I=>{var Q=_s();Ie(Q,5,()=>Object.entries(p()),He,(de,qe)=>{var ge=L(()=>_t(t(qe),2));let F=()=>t(ge)[0],W=()=>t(ge)[1];const U=L(()=>S[F()]||{responseTime:0,uptime:0,errorRate:0}),Re=L(()=>ne(W()));var _e=fs();let me;var he=a(_e),et=a(he);{let Oe=L(()=>W()==="connecting"?"spinning":"");Ot(et,()=>t(Re),(je,Le)=>{Le(je,{size:20,get class(){return t(Oe)}})})}e(he);var Qe=i(he,2),Pe=a(Qe),te=a(Pe),ke=a(te,!0);e(te);var De=i(te,2),ut=a(De,!0);e(De),e(Pe);var Ee=i(Pe,2),nt=a(Ee,!0);e(Ee);var Dt=i(Ee,2);{var mt=Oe=>{var je=gs(),Le=a(je),ot=a(Le);Kt(ot,{size:12});var Mt=i(ot);e(Le);var wt=i(Le,2),kt=a(wt);At(kt,{size:12});var It=i(kt);e(wt),e(je),V(()=>{D(Mt,` ${t(U).responseTime??""}ms`),D(It,` ${t(U).uptime??""}% uptime`)}),m(Oe,je)};E(Dt,Oe=>{W()==="connected"&&Oe(mt)})}e(Qe);var ht=i(Qe,2),Fe=a(ht);Fe.__click=()=>s(F());var rt=a(Fe);{let Oe=L(()=>t(v)===F()?"spinning":"");ft(rt,{size:16,get class(){return t(Oe)}})}e(Fe);var bt=i(Fe,2),yt=a(bt);Vt(yt,{size:16}),e(bt),e(ht),e(_e),V((Oe,je,Le,ot)=>{me=ze(_e,1,"service-card svelte-qu7w3o",null,me,{connected:W()==="connected",error:W()==="error"}),Se(he,`color: ${Oe??""}`),D(ke,b[F()]),Se(De,`background: ${je??""}20; color: ${Le??""}`),D(ut,ot),D(nt,ce[F()]),Fe.disabled=t(v)===F()},[()=>$(W()),()=>$(W()),()=>$(W()),()=>B(W())]),m(de,_e)}),e(Q),Y(1,Q,()=>Me,()=>({duration:150})),m(I,Q)},Ze=I=>{var Q=hs();Ie(Q,5,()=>Object.entries(p()),He,(de,qe)=>{var ge=L(()=>_t(t(qe),2));let F=()=>t(ge)[0],W=()=>t(ge)[1];const U=L(()=>S[F()]||{responseTime:0,uptime:0,errorRate:0});var Re=ms(),_e=a(Re),me=a(_e),he=a(me,!0);e(me);var et=i(me,2);e(_e);var Qe=i(_e,2),Pe=a(Qe),te=i(a(Pe),2),ke=a(te);e(te);var De=i(te,2),ut=a(De);e(De),e(Pe);var Ee=i(Pe,2),nt=i(a(Ee),2),Dt=a(nt);e(nt);var mt=i(nt,2),ht=a(mt);e(mt),e(Ee);var Fe=i(Ee,2),rt=i(a(Fe),2),bt=a(rt);e(rt);var yt=i(rt,2),Oe=a(yt);e(yt),e(Fe),e(Qe),e(Re),V((je,Le,ot,Mt,wt,kt,It)=>{D(he,b[F()]),Se(et,`background: ${je??""}`),Se(te,`color: ${Le??""}`),D(ke,`${t(U).responseTime??""}ms`),Se(ut,`width: ${ot??""}%; background: ${Mt??""}`),Se(nt,`color: ${wt??""}`),D(Dt,`${t(U).uptime??""}%`),Se(ht,`width: ${t(U).uptime??""}%; background: ${kt??""}`),Se(rt,`color: ${t(U).errorRate>1?"#ef4444":t(U).errorRate>.5?"#f59e0b":"#10b981"}`),D(bt,`${t(U).errorRate??""}%`),Se(Oe,`width: ${It??""}%`)},[()=>$(W()),()=>ae(t(U).responseTime),()=>Math.min(t(U).responseTime/5,100),()=>ae(t(U).responseTime),()=>J(t(U).uptime),()=>J(t(U).uptime),()=>Math.min(t(U).errorRate*10,100)]),m(de,Re)}),e(Q),Y(1,Q,()=>Me,()=>({duration:150})),m(I,Q)};E(Xe,I=>{t(f)==="overview"?I(Ge):I(Ze,!1)})}e(Ce);var Je=i(Ce,2),pe=a(Je),it=a(pe);At(it,{size:16});var Ae=i(it,2);Vt(Ae,{size:14}),e(pe),e(Je),e(y),e(_),V(()=>{Z=ze(P,1,"header-icon svelte-qu7w3o",null,Z,{healthy:t(A)==="healthy",partial:t(A)==="partial",unhealthy:t(A)==="unhealthy"}),D(ee,`${t(d)??""}/${t(x)??""} services connected`),se.disabled=t(v)!==null,be=ze(ue,1,"status-bar svelte-qu7w3o",null,be,{healthy:t(A)==="healthy",partial:t(A)==="partial",unhealthy:t(A)==="unhealthy"}),Ne=ze(ie,1,"tab svelte-qu7w3o",null,Ne,{active:t(f)==="overview"}),Be=ze(we,1,"tab svelte-qu7w3o",null,Be,{active:t(f)==="details"})}),Y(3,y,()=>Ye,()=>({x:400,duration:300,easing:at})),Y(3,_,()=>Me,()=>({duration:150})),m(o,_)};E(c,o=>{k()&&o(C)})}m(r,R),dt(),h()}ct(["click","keydown"]);const la="rtp_pending_actions";function ys(){try{const r=localStorage.getItem(la);return r?JSON.parse(r):[]}catch{return[]}}function St(r){try{localStorage.setItem(la,JSON.stringify(r))}catch{}}function ws(){const r={isOnline:navigator.onLine,lastOnline:null,serviceWorkerStatus:null,cacheSize:0,pendingActions:ys(),syncInProgress:!1},{subscribe:g,set:p,update:l}=Bt(r);window.addEventListener("online",()=>{l(v=>({...v,isOnline:!0,lastOnline:Date.now()})),h()}),window.addEventListener("offline",()=>{l(v=>({...v,isOnline:!1}))}),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(()=>{l(v=>({...v,serviceWorkerStatus:"activated"}))}).catch(()=>{l(v=>({...v,serviceWorkerStatus:"error"}))});async function h(){const v=Lt({subscribe:g});if(!v.isOnline||v.syncInProgress||v.pendingActions.length===0)return;l(b=>({...b,syncInProgress:!0}));const f=[...v.pendingActions],S=[];for(const b of f)try{await k(b)}catch{b.retryCount<3&&S.push({...b,retryCount:b.retryCount+1})}l(b=>({...b,pendingActions:S,syncInProgress:!1})),St(S)}async function k(v){return new Promise((f,S)=>{setTimeout(()=>{Math.random()>.1?f():S(new Error("Sync failed"))},500)})}return{subscribe:g,queueAction(v,f,S){const b={id:crypto.randomUUID(),type:v,resource:f,data:S,timestamp:Date.now(),retryCount:0};l(ne=>{const $=[...ne.pendingActions,b];return St($),{...ne,pendingActions:$}}),Lt({subscribe:g}).isOnline&&h()},removeAction(v){l(f=>{const S=f.pendingActions.filter(b=>b.id!==v);return St(S),{...f,pendingActions:S}})},clearPendingActions(){l(v=>(St([]),{...v,pendingActions:[]}))},sync:h,updateCacheSize(v){l(f=>({...f,cacheSize:v}))},async clearCache(){if("caches"in window)try{const v=await caches.keys();await Promise.all(v.map(f=>caches.delete(f))),l(f=>({...f,cacheSize:0}))}catch{}}}}const lt=ws(),ks=Ke(lt,r=>r.isOnline),Ss=Ke(lt,r=>r.pendingActions.length>0),Cs=Ke(lt,r=>r.pendingActions.length),As=Ke(lt,r=>r.syncInProgress);var qs=w('<div class="pending-badge svelte-1cjtxgc"><!> </div>'),xs=w(`<div class="offline-banner svelte-1cjtxgc"><div class="banner-content svelte-1cjtxgc"><div class="banner-icon svelte-1cjtxgc"><!></div> <div class="banner-text svelte-1cjtxgc"><span class="banner-title svelte-1cjtxgc">You're offline</span> <span class="banner-subtitle svelte-1cjtxgc">Changes will sync when you're back online</span></div> <!></div></div>`),$s=w('<div class="syncing-indicator svelte-1cjtxgc"><!> Syncing...</div>'),Ns=w('<button class="sync-btn svelte-1cjtxgc"><!> Sync now</button>'),Os=w('<div class="synced-indicator svelte-1cjtxgc"><!> All synced</div>'),zs=w('<div class="online-banner svelte-1cjtxgc"><div class="banner-content svelte-1cjtxgc"><div class="banner-icon online svelte-1cjtxgc"><!></div> <span class="banner-title svelte-1cjtxgc">Back online</span> <!></div></div>'),Ts=w("<!> Syncing...",1),Ds=w("<!> Sync Now",1),Ms=w('<div class="sync-details svelte-1cjtxgc"><div class="details-header svelte-1cjtxgc"><span>Pending Changes</span> <button class="close-details svelte-1cjtxgc"><!></button></div> <div class="details-content svelte-1cjtxgc"><p class="svelte-1cjtxgc"> </p> <button class="sync-all-btn svelte-1cjtxgc"><!></button></div></div>'),Is=w('<button class="sync-float-btn svelte-1cjtxgc"><!> <span> </span></button> <!>',1),Rs=w("<!> <!>",1);function Ws(r,g){vt(g,!0);const p=()=>Ve(ks,"$isOnline",v),l=()=>Ve(Ss,"$hasPendingActions",v),h=()=>Ve(Cs,"$pendingActionsCount",v),k=()=>Ve(As,"$isSyncing",v),[v,f]=zt();let S=$e(!1),b=$e(!1);Wt(()=>{p()&&l()&&(K(b,!0),setTimeout(()=>{K(b,!1)},3e3))});var ce=Rs(),ne=le(ce);{var $=s=>{var n=xs(),u=a(n),d=a(u),x=a(d);Xt(x,{size:18}),e(d);var A=i(d,4);{var R=c=>{var C=qs(),o=a(C);Ht(o,{size:14});var _=i(o);e(C),V(()=>D(_,` ${h()??""} pending`)),m(c,C)};E(A,c=>{l()&&c(R)})}e(u),e(n),Y(1,n,()=>Ye,()=>({y:-50,duration:300,easing:at})),Y(2,n,()=>Me,()=>({duration:150})),m(s,n)},B=s=>{var n=Ue(),u=le(n);{var d=x=>{var A=zs(),R=a(A),c=a(R),C=a(c);Xt(C,{size:18}),e(c);var o=i(c,4);{var _=T=>{var q=$s(),P=a(q);Ct(P,{size:14,class:"spinning"}),G(),e(q),m(T,q)},y=T=>{var q=Ue(),P=le(q);{var Z=N=>{var O=Ns();O.__click=()=>lt.sync();var ee=a(O);ft(ee,{size:14}),G(),e(O),m(N,O)},H=N=>{var O=Os(),ee=a(O);xt(ee,{size:14}),G(),e(O),m(N,O)};E(P,N=>{l()?N(Z):N(H,!1)},!0)}m(T,q)};E(o,T=>{k()?T(_):T(y,!1)})}e(R),e(A),Y(1,A,()=>Ye,()=>({y:-50,duration:300,easing:at})),Y(2,A,()=>Me,()=>({duration:150})),m(x,A)};E(u,x=>{t(b)&&x(d)},!0)}m(s,n)};E(ne,s=>{p()?s(B,!1):s($)})}var ae=i(ne,2);{var J=s=>{var n=Is(),u=le(n);u.__click=()=>K(S,!t(S));var d=a(u);{var x=_=>{Ct(_,{size:18,class:"spinning"})},A=_=>{Ht(_,{size:18})};E(d,_=>{k()?_(x):_(A,!1)})}var R=i(d,2),c=a(R,!0);e(R),e(u);var C=i(u,2);{var o=_=>{var y=Ms(),T=a(y),q=i(a(T),2);q.__click=()=>K(S,!1);var P=a(q);Tt(P,{size:14}),e(q),e(T);var Z=i(T,2),H=a(Z),N=a(H);e(H);var O=i(H,2);O.__click=()=>lt.sync();var ee=a(O);{var oe=re=>{var X=Ts(),fe=le(X);Ct(fe,{size:14,class:"spinning"}),G(),m(re,X)},se=re=>{var X=Ds(),fe=le(X);ft(fe,{size:14}),G(),m(re,X)};E(ee,re=>{k()?re(oe):re(se,!1)})}e(O),e(Z),e(y),V(()=>{D(N,`${h()??""} changes waiting to sync`),O.disabled=k()}),Y(3,y,()=>Ye,()=>({y:10,duration:200,easing:at})),m(_,y)};E(C,_=>{t(S)&&_(o)})}V(()=>D(c,h())),Y(1,u,()=>Ye,()=>({y:20,duration:200})),m(s,n)};E(ae,s=>{p()&&l()&&!t(b)&&s(J)})}m(r,ce),dt(),f()}ct(["click"]);export{Ls as C,Us as K,Hs as N,Ws as O,Ks as R,Bs as a,jt as k,La as u};
