import{p as vt,a as z,f as v,q as a,r as s,e as n,N as k,w as m,x,g as e,h as l,Q as T,n as M,i as $,O as B,K as ct,H as gt,j as xt}from"./C_QN0JMx.js";var ut=v('<th class="px-2 py-2 text-center font-medium text-gray-600 min-w-[60px]"> </th>'),pt=v("<div> </div>"),ft=v('<div class="w-full h-8 rounded bg-gray-50"></div>'),yt=v('<td class="px-1 py-1"><!></td>'),_t=v('<tr class="border-t border-gray-100 hover:bg-gray-50/50"><td class="px-3 py-2 font-medium text-gray-900 sticky left-0 bg-white z-10"> </td><td class="px-3 py-2 text-center text-gray-600"> </td><!></tr>'),bt=v("<div> </div>"),ht=v('<div class="w-full h-8 rounded bg-gray-100"></div>'),mt=v('<td class="px-1 py-1"><!></td>'),wt=v('<div class="bg-white rounded-xl border border-gray-200 overflow-hidden"><div class="p-4 border-b border-gray-100"><h3 class="text-lg font-semibold text-gray-900"> </h3> <p class="text-sm text-gray-500 mt-1"> </p></div> <div class="overflow-x-auto"><table class="w-full text-sm"><thead><tr class="bg-gray-50"><th class="px-3 py-2 text-left font-medium text-gray-600 sticky left-0 bg-gray-50 z-10">Cohort</th><th class="px-3 py-2 text-center font-medium text-gray-600">Size</th><!></tr></thead><tbody><!><tr class="border-t-2 border-gray-200 bg-gray-50"><td class="px-3 py-2 font-semibold text-gray-900 sticky left-0 bg-gray-50 z-10">Average</td><td class="px-3 py-2 text-center text-gray-600"> </td><!></tr></tbody></table></div> <div class="p-4 border-t border-gray-100 flex items-center gap-4 text-xs"><span class="text-gray-500">Retention:</span> <div class="flex items-center gap-2"><div class="flex items-center gap-1"><div class="w-4 h-4 rounded bg-green-500"></div> <span>80%+</span></div> <div class="flex items-center gap-1"><div class="w-4 h-4 rounded bg-green-400"></div> <span>60-80%</span></div> <div class="flex items-center gap-1"><div class="w-4 h-4 rounded bg-yellow-400"></div> <span>40-60%</span></div> <div class="flex items-center gap-1"><div class="w-4 h-4 rounded bg-orange-400"></div> <span>20-40%</span></div> <div class="flex items-center gap-1"><div class="w-4 h-4 rounded bg-red-400"></div> <span>&lt;20%</span></div></div></div></div>');function kt(E,f){vt(f,!0);let w=z(f,"data",19,()=>[]),G=z(f,"title",3,"Cohort Retention"),C=z(f,"metricType",3,"retention"),I=z(f,"maxPeriods",3,12);function N(t){return t>=80?"bg-green-500":t>=60?"bg-green-400":t>=40?"bg-yellow-400":t>=20?"bg-orange-400":t>0?"bg-red-400":"bg-gray-100"}function P(t){return t>=40?"text-white":"text-gray-700"}function J(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric"})}let D=M(()=>Array.from({length:I()},(t,r)=>r)),V=M(()=>e(D).map(t=>{const r=w().filter(d=>d.periods&&d.periods[t]).map(d=>{const o=d.periods[t];return typeof o=="number"?o:o.retention_rate});return r.length===0?null:r.reduce((d,o)=>d+o,0)/r.length}));var F=wt(),S=a(F),j=a(S),X=a(j,!0);s(j);var U=n(j,2),Y=a(U,!0);s(U),s(S);var q=n(S,2),H=a(q),R=a(H),K=a(R),Z=n(a(K),2);k(Z,17,()=>e(D),T,(t,r)=>{var d=ut(),o=a(d,!0);s(d),m(()=>x(o,e(r)===0?"Day 0":`Week ${e(r)}`)),l(t,d)}),s(K),s(R);var O=n(R),Q=a(O);k(Q,19,w,t=>t.cohort_date,(t,r)=>{var d=_t(),o=a(d),L=a(o,!0);s(o);var y=n(o),c=a(y,!0);s(y);var g=n(y);k(g,17,()=>e(D),T,(_,b)=>{const i=M(()=>e(r).periods?e(r).periods[e(b)]:null);var h=yt(),rt=a(h);{var at=p=>{var u=pt(),dt=a(u,!0);s(u),m((ot,it,nt,lt)=>{B(u,1,`w-full h-8 rounded flex items-center justify-center text-xs font-medium
											${ot??""}
											${it??""}`),ct(u,"title",nt),x(dt,lt)},[()=>N(e(i).retention_rate),()=>P(e(i).retention_rate),()=>C()==="retention"?`${e(i).active_users} users (${e(i).retention_rate.toFixed(1)}%)`:`$${e(i).total_revenue.toFixed(0)}`,()=>C()==="retention"?`${e(i).retention_rate.toFixed(0)}%`:`$${e(i).total_revenue.toFixed(0)}`]),l(p,u)},st=p=>{var u=ft();l(p,u)};$(rt,p=>{e(i)&&typeof e(i)=="object"?p(at):p(st,!1)})}s(h),l(_,h)}),s(d),m((_,b)=>{x(L,_),x(c,b)},[()=>J(e(r).cohort_date),()=>e(r).cohort_size.toLocaleString()]),l(t,d)});var W=n(Q),A=n(a(W)),tt=a(A,!0);s(A);var et=n(A);k(et,17,()=>e(V),T,(t,r)=>{var d=mt(),o=a(d);{var L=c=>{var g=bt(),_=a(g);s(g),m((b,i,h)=>{B(g,1,`w-full h-8 rounded flex items-center justify-center text-xs font-bold
										${b??""} ${i??""}`),x(_,`${h??""}%`)},[()=>N(e(r)),()=>P(e(r)),()=>e(r).toFixed(0)]),l(c,g)},y=c=>{var g=ht();l(c,g)};$(o,c=>{e(r)!==null?c(L):c(y,!1)})}s(d),l(t,d)}),s(W),s(O),s(H),s(q),gt(2),s(F),m(t=>{x(X,G()),x(Y,C()==="retention"?"User retention by cohort week":"Revenue by cohort"),x(tt,t)},[()=>Math.round(w().reduce((t,r)=>t+(r.cohort_size||r.size||0),0)/w().length).toLocaleString()]),l(E,F),xt()}export{kt as C};
