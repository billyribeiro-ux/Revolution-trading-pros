import{p as Ke,a as b,o as Ie,c as H,s as ce,f as v,q as a,i as f,e as d,r as e,m as Oe,w as K,O as Q,g as t,n as O,x,h as n,j as Se,d9 as Pe,K as Re,z as ze,k as be,d as te,N as ge,D as Te,Q as Me,H as ye}from"./C_QN0JMx.js";import"./l0sNRNKZ.js";import{a as Ae}from"./CCQSfPwG.js";var Fe=v('<div class="absolute -top-2 -right-2 bg-red-500 text-white text-xs px-2 py-0.5 rounded-full">Anomaly</div>'),Ue=v('<span class="text-lg"> </span>'),Ee=v('<span class="text-xs bg-white/20 px-2 py-0.5 rounded-full">Primary</span>'),Ne=v('<div class="mt-3 opacity-60"><svg width="80" height="24" class="overflow-visible"><path fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>'),Le=v('<div class="mt-2"><span> </span></div>'),Ve=v('<div><!> <div class="flex items-center justify-between mb-2"><div class="flex items-center gap-2"><!> <span class="text-sm font-medium opacity-80"> </span></div> <!></div> <div class="flex items-end gap-3"><span> </span> <div><span class="text-sm font-medium"> </span> <span class="text-sm font-semibold"> </span></div></div> <!> <!></div>');function De(ae,r){Ke(r,!0);let J=b(r,"showSparkline",3,!1),z=b(r,"sparklineData",19,()=>[]),o=b(r,"size",3,"md"),X=b(r,"clickable",3,!1),m=b(r,"animateOnMount",3,!0),P=b(r,"animationDelay",3,0),h,A=ce(!1);Ie(()=>{if(!h||!m()){H(A,!0);return}const s=new IntersectionObserver(l=>{l.forEach(p=>{p.isIntersecting&&!t(A)&&(H(A,!0),Pe.fromTo(h,{opacity:0,y:20,scale:.95},{opacity:1,y:0,scale:1,duration:.6,delay:P(),ease:"power3.out"}))})},{threshold:.2});return s.observe(h),()=>s.disconnect()});const S={"currency-dollar":"ðŸ’°","shopping-cart":"ðŸ›’",users:"ðŸ‘¥",clock:"â±ï¸",target:"ðŸŽ¯","trending-up":"ðŸ“ˆ","user-plus":"âž•","check-circle":"âœ…",heart:"â¤ï¸",crown:"ðŸ‘‘",star:"â­"},Y={green:"bg-green-500/10 text-green-600 border-green-500/20",blue:"bg-blue-500/10 text-blue-600 border-blue-500/20",purple:"bg-purple-500/10 text-purple-600 border-purple-500/20",orange:"bg-orange-500/10 text-orange-600 border-orange-500/20",red:"bg-red-500/10 text-red-600 border-red-500/20",pink:"bg-pink-500/10 text-pink-600 border-pink-500/20",cyan:"bg-cyan-500/10 text-cyan-600 border-cyan-500/20",gold:"bg-yellow-500/10 text-yellow-600 border-yellow-500/20",gray:"bg-gray-500/10 text-gray-600 border-gray-500/20"};let re=O(()=>r.kpi.trend==="up"?"text-green-500":r.kpi.trend==="down"?"text-red-500":"text-gray-500"),N=O(()=>r.kpi.trend==="up"?"â†‘":r.kpi.trend==="down"?"â†“":"â†’"),L=O(()=>({sm:"p-3",md:"p-4",lg:"p-6"})[o()]),ie=O(()=>({sm:"text-xl",md:"text-2xl",lg:"text-4xl"})[o()]);function c(s){if(s.length<2)return"";const l=80,p=24,E=Math.min(...s),W=Math.max(...s)-E||1;return`M ${s.map(($,ve)=>{const ke=ve/(s.length-1)*l,we=p-($-E)/W*p;return`${ke},${we}`}).join(" L ")}`}var g=Ve();let T;var D=a(g);{var i=s=>{var l=Fe();n(s,l)};f(D,s=>{r.kpi.is_anomaly&&s(i)})}var u=d(D,2),k=a(u),F=a(k);{var se=s=>{var l=Ue(),p=a(l,!0);e(l),K(()=>x(p,S[r.kpi.icon]||"ðŸ“Š")),n(s,l)};f(F,s=>{r.kpi.icon&&s(se)})}var _=d(F,2),w=a(_,!0);e(_),e(k);var I=d(k,2);{var V=s=>{var l=Ee();n(s,l)};f(I,s=>{r.kpi.is_primary&&s(V)})}e(u);var C=d(u,2),M=a(C),j=a(M,!0);e(M);var y=d(M,2),U=a(y),R=a(U,!0);e(U);var Z=d(U,2),ue=a(Z);e(Z),e(y),e(C);var xe=d(C,2);{var ne=s=>{var l=Ne(),p=a(l),E=a(p);e(p),e(l),K(pe=>Re(E,"d",pe),[()=>c(z())]),n(s,l)};f(xe,s=>{J()&&z().length>1&&s(ne)})}var _e=d(xe,2);{var he=s=>{var l=Le(),p=a(l),E=a(p,!0);e(p),e(l),K(()=>{Q(p,1,`text-xs px-2 py-0.5 rounded-full ${r.kpi.target_status==="on_track"?"bg-green-500/20 text-green-600":r.kpi.target_status==="at_risk"?"bg-yellow-500/20 text-yellow-600":"bg-red-500/20 text-red-600"}`),x(E,r.kpi.target_status==="on_track"?"On Track":r.kpi.target_status==="at_risk"?"At Risk":"Behind")}),n(s,l)};f(_e,s=>{r.kpi.target_status&&s(he)})}e(g),Oe(g,s=>h=s,()=>h),K(s=>{T=Q(g,1,`relative rounded-xl border ${Y[r.kpi.color||"blue"]??""} ${t(L)??""}
		transition-all duration-200 ${X()?"cursor-pointer hover:scale-[1.02] hover:shadow-lg":""}
		${m()?"opacity-0":""}`,null,T,{"ring-2":r.kpi.is_anomaly,"ring-red-500":r.kpi.is_anomaly}),x(w,r.kpi.name),Q(M,1,`${t(ie)??""} font-bold tracking-tight`),x(j,r.kpi.formatted_value),Q(y,1,`flex items-center gap-1 pb-1 ${t(re)??""}`),x(R,t(N)),x(ue,`${s??""}%`)},[()=>Math.abs(r.kpi.change_percentage).toFixed(1)]),n(ae,g),Se()}var We=v('<div role="button" tabindex="0"><!></div>'),qe=v('<div><h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3 capitalize"> </h3> <div></div></div>'),Be=v('<div role="button" tabindex="0"><!></div>'),Ge=v("<div></div>"),He=v('<div class="text-center py-12 text-gray-500"><p>No KPIs available</p></div>'),Qe=v('<div class="space-y-6"><!> <!></div>');function vt(ae,r){Ke(r,!0);let J=b(r,"kpis",19,()=>[]),z=b(r,"showPrimaryOnly",3,!1),o=b(r,"category",3,null),X=b(r,"columns",3,4),m=b(r,"onKpiClick",3,null),P=O(()=>J().filter(c=>!(z()&&!c.is_primary||o()&&c.category!==o()))),h=O(()=>({2:"grid-cols-1 sm:grid-cols-2",3:"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",4:"grid-cols-1 sm:grid-cols-2 lg:grid-cols-4",5:"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5"})[X()]),A=O(()=>[...new Set(J().map(c=>c.category))]);var S=Qe(),Y=a(S);{var re=c=>{var g=be(),T=te(g);ge(T,17,()=>t(A),Me,(D,i)=>{const u=O(()=>t(P).filter(_=>_.category===t(i)));var k=be(),F=te(k);{var se=_=>{var w=qe(),I=a(w),V=a(I,!0);e(I);var C=d(I,2);ge(C,21,()=>t(u),M=>M.kpi_key,(M,j)=>{var y=We();y.__click=R=>{R.preventDefault(),m()?.(t(j))};var U=a(y);{let R=O(()=>!!m());De(U,{get kpi(){return t(j)},get clickable(){return t(R)}})}e(y),Te("keypress",y,R=>{R.preventDefault(),m()?.(t(j))}),n(M,y)}),e(C),e(w),K(()=>{x(V,t(i)),Q(C,1,`grid ${t(h)??""} gap-4`)}),n(_,w)};f(F,_=>{t(u).length>0&&_(se)})}n(D,k)}),n(c,g)},N=c=>{var g=Ge();ge(g,21,()=>t(P),T=>T.kpi_key,(T,D)=>{var i=Be();i.__click=()=>m()?.(t(D));var u=a(i);{let k=O(()=>!!m());De(u,{get kpi(){return t(D)},get clickable(){return t(k)}})}e(i),Te("keypress",i,()=>m()?.(t(D))),n(T,i)}),e(g),K(()=>Q(g,1,`grid ${t(h)??""} gap-4`)),n(c,g)};f(Y,c=>{o()===null&&!z()?c(re):c(N,!1)})}var L=d(Y,2);{var ie=c=>{var g=He();n(c,g)};f(L,c=>{t(P).length===0&&c(ie)})}e(S),n(ae,S),Se()}ze(["click"]);var Je=v('<span class="text-xs text-gray-400"> </span>'),Xe=v('<div class="flex items-center justify-center py-8"><div class="w-6 h-6 border-2 border-white/20 border-t-white rounded-full animate-spin"></div></div>'),Ye=v('<div class="text-center py-4 text-red-400"><p> </p></div>'),Ze=v('<div class="flex items-center justify-between text-sm"><span class="text-gray-300 truncate max-w-[200px]"> </span> <span class="text-gray-400"> </span></div>'),$e=v('<div class="border-t border-gray-700 pt-4"><h4 class="text-xs font-medium text-gray-400 mb-2">Top Pages (30m)</h4> <div class="space-y-2"></div></div>'),et=v('<span class="px-2 py-1 bg-gray-700 rounded text-xs"> <span class="text-gray-400 ml-1"> </span></span>'),tt=v('<div class="border-t border-gray-700 pt-4 mt-4"><h4 class="text-xs font-medium text-gray-400 mb-2">Top Events (30m)</h4> <div class="flex flex-wrap gap-2"></div></div>'),at=v("<!> <!>",1),rt=v('<div><div class="text-center"><div class="text-2xl font-bold text-green-400"> </div> <div class="text-xs text-gray-400">Active Users</div></div> <div class="text-center"><div class="text-2xl font-bold text-blue-400"> </div> <div class="text-xs text-gray-400">Page Views</div></div> <div class="text-center"><div class="text-2xl font-bold text-purple-400"> </div> <div class="text-xs text-gray-400">Conversions</div></div> <div class="text-center"><div class="text-2xl font-bold text-yellow-400"> </div> <div class="text-xs text-gray-400">Revenue</div></div></div> <!>',1),it=v('<div class="bg-gradient-to-br from-slate-900 to-slate-800 rounded-xl p-4 text-white"><div class="flex items-center justify-between mb-4"><div class="flex items-center gap-2"><div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div> <span class="text-sm font-medium">Real-Time</span></div> <!></div> <!></div>');function dt(ae,r){Ke(r,!0);let J=b(r,"refreshInterval",3,3e4),z=b(r,"compact",3,!1),o=ce(null),X=ce(!0),m=ce(null),P=ce(null),h;async function A(){try{const i=await Ae.getRealTimeMetrics();H(o,i.metrics,!0),H(P,new Date,!0),H(m,null)}catch(i){H(m,i instanceof Error?i.message:"Failed to load metrics",!0)}finally{H(X,!1)}}Ie(()=>(A(),h=setInterval(A,J()),()=>{h&&clearInterval(h)}));function S(i){return i>=1e6?(i/1e6).toFixed(1)+"M":i>=1e3?(i/1e3).toFixed(1)+"K":i.toString()}function Y(i){return"$"+S(i)}function re(i){return i.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}var N=it(),L=a(N),ie=d(a(L),2);{var c=i=>{var u=Je(),k=a(u);e(u),K(F=>x(k,`Updated ${F??""}`),[()=>re(t(P))]),n(i,u)};f(ie,i=>{t(P)&&i(c)})}e(L);var g=d(L,2);{var T=i=>{var u=Xe();n(i,u)},D=i=>{var u=be(),k=te(u);{var F=_=>{var w=Ye(),I=a(w),V=a(I,!0);e(I),e(w),K(()=>x(V,t(m))),n(_,w)},se=_=>{var w=be(),I=te(w);{var V=C=>{var M=rt(),j=te(M),y=a(j),U=a(y),R=a(U,!0);e(U),ye(2),e(y);var Z=d(y,2),ue=a(Z),xe=a(ue,!0);e(ue),ye(2),e(Z);var ne=d(Z,2),_e=a(ne),he=a(_e,!0);e(_e),ye(2),e(ne);var s=d(ne,2),l=a(s),p=a(l,!0);e(l),ye(2),e(s),e(j);var E=d(j,2);{var pe=W=>{var le=at(),$=te(le);{var ve=q=>{var B=$e(),de=d(a(B),2);ge(de,21,()=>t(o).top_pages.slice(0,5),Me,(Ce,oe)=>{var G=Ze(),ee=a(G),fe=a(ee,!0);e(ee);var me=d(ee,2),je=a(me,!0);e(me),e(G),K(()=>{x(fe,t(oe).page_path),x(je,t(oe).views)}),n(Ce,G)}),e(de),e(B),n(q,B)};f($,q=>{t(o).top_pages&&t(o).top_pages.length>0&&q(ve)})}var ke=d($,2);{var we=q=>{var B=tt(),de=d(a(B),2);ge(de,21,()=>t(o).top_events.slice(0,8),Me,(Ce,oe)=>{var G=et(),ee=a(G),fe=d(ee),me=a(fe,!0);e(fe),e(G),K(()=>{x(ee,`${t(oe).event_name??""} `),x(me,t(oe).count)}),n(Ce,G)}),e(de),e(B),n(q,B)};f(ke,q=>{t(o).top_events&&t(o).top_events.length>0&&q(we)})}n(W,le)};f(E,W=>{z()||W(pe)})}K((W,le,$,ve)=>{Q(j,1,`grid ${z()?"grid-cols-2":"grid-cols-2 md:grid-cols-4"} gap-4 mb-4`),x(R,W),x(xe,le),x(he,$),x(p,ve)},[()=>S(t(o).active_users),()=>S(t(o).page_views),()=>S(t(o).conversions),()=>Y(t(o).revenue)]),n(C,M)};f(I,C=>{t(o)&&C(V)},!0)}n(_,w)};f(k,_=>{t(m)?_(F):_(se,!1)},!0)}n(i,u)};f(g,i=>{t(X)?i(T):i(D,!1)})}e(N),n(ae,N),Se()}export{vt as K,dt as R};
