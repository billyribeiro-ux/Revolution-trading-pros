import{z as me,p as oe,a as Y,b as ne,c as t,f as C,a9 as ue,i as $,q as s,Z as fe,w as ee,D as _e,bJ as d,g as a,bO as pe,h as S,j as ye,s as c,F as ae,aN as ze,e as l,at as xe,bH as f,r as i,bI as H,H as B,x as ge,v as he,d as Se,cQ as we}from"./C_QN0JMx.js";import{e as te,A as Te}from"./BIaWRQrO.js";var je=C('<p class="alert alert-error svelte-bm2zc8"> </p>'),Ee=C("<!> Save",1),Ne=C('<div class="template-form svelte-bm2zc8"><!> <form><div class="grid svelte-bm2zc8"><div class="field svelte-bm2zc8"><label for="name" class="svelte-bm2zc8">Name</label> <input id="name" type="text" required class="svelte-bm2zc8"/></div> <div class="field svelte-bm2zc8"><label for="slug" class="svelte-bm2zc8">Slug</label> <input id="slug" type="text" placeholder="auto-generated if empty" class="svelte-bm2zc8"/></div> <div class="field full svelte-bm2zc8"><label for="subject" class="svelte-bm2zc8">Subject</label> <input id="subject" type="text" required class="svelte-bm2zc8"/></div> <div class="field full svelte-bm2zc8"><label for="email_type" class="svelte-bm2zc8">Email Type</label> <input id="email_type" type="text" required placeholder="e.g. welcome, order_confirmation" class="svelte-bm2zc8"/></div> <div class="field full svelte-bm2zc8"><label for="body_html" class="svelte-bm2zc8">HTML Body</label> <textarea id="body_html" rows="8" required class="svelte-bm2zc8"></textarea></div> <div class="field full svelte-bm2zc8"><label for="body_text" class="svelte-bm2zc8">Plain Text Body (optional)</label> <textarea id="body_text" rows="4" class="svelte-bm2zc8"></textarea></div> <div class="field full svelte-bm2zc8"><label for="variables" class="svelte-bm2zc8">Variables (JSON)</label> <textarea id="variables" rows="4" placeholder="Enter JSON variables" class="svelte-bm2zc8"></textarea></div> <div class="field svelte-bm2zc8"><label for="is-active" class="inline svelte-bm2zc8"><input id="is-active" type="checkbox" class="svelte-bm2zc8"/> Active</label></div></div> <div class="actions svelte-bm2zc8"><button type="button" class="btn-secondary svelte-bm2zc8" title="Cancel"><!> Cancel</button> <button type="submit" class="btn-primary svelte-bm2zc8" title="Save"><!></button></div></form></div>');function qe(le,b){oe(b,!0);let v=Y(b,"template",3,null),P=Y(b,"isEdit",3,!1),_=c(""),p=c(""),y=c(""),z=c(""),x=c(""),g=c(""),m=c(""),h=c(!0);ne(()=>{v()&&(t(_,v().name??"",!0),t(p,v().slug??"",!0),t(y,v().subject??"",!0),t(z,v().email_type??"",!0),t(x,v().body_html??"",!0),t(g,v().body_text??"",!0),t(m,v().variables?JSON.stringify(v().variables,null,2):"",!0),t(h,v().is_active??!0,!0))});let o=c(!1),n=c("");async function se(){t(o,!0),t(n,"");const e={name:a(_),slug:a(p),subject:a(y),email_type:a(z),body_html:a(x),body_text:a(g)||null,variables:a(m)?JSON.parse(a(m)):null,is_active:a(h)};try{if(P())await te.update(v().id,e),b.onsaved?.({id:v().id});else{const r=await te.create(e);b.onsaved?.({id:r.id})}ae("/admin/email/templates")}catch(r){r instanceof Te?t(n,r.message,!0):t(n,"Failed to save template")}finally{t(o,!1)}}function ie(){ae("/admin/email/templates")}var w=Ne();ue("bm2zc8",e=>{ze(()=>{xe.title=`${P()?"Edit":"New"} Email Template | Admin | Revolution Trading Pros`})});var I=s(w);{var re=e=>{var r=je(),D=s(r,!0);i(r),ee(()=>ge(D,a(n))),S(e,r)};$(I,e=>{a(n)&&e(re)})}var T=l(I,2),j=s(T),E=s(j),L=l(s(E),2);f(L),i(E);var N=l(E,2),M=l(s(N),2);f(M),i(N);var A=l(N,2),Q=l(s(A),2);f(Q),i(A);var k=l(A,2),R=l(s(k),2);f(R),i(k);var q=l(k,2),V=l(s(q),2);H(V),i(q);var J=l(q,2),X=l(s(J),2);H(X),i(J);var O=l(J,2),Z=l(s(O),2);H(Z),i(O);var G=l(O,2),K=s(G),U=s(K);f(U),B(),i(K),i(G),i(j);var W=l(j,2),u=s(W);u.__click=ie;var ve=s(u);fe(ve,{size:18}),B(),i(u);var F=l(u,2),ce=s(F);{var de=e=>{var r=he("Saving...");S(e,r)},be=e=>{var r=Ee(),D=Se(r);we(D,{size:18}),B(),S(e,r)};$(ce,e=>{a(o)?e(de):e(be,!1)})}i(F),i(W),i(T),i(w),ee(()=>{u.disabled=a(o),F.disabled=a(o)}),_e("submit",T,e=>{e.preventDefault(),se()}),d(L,()=>a(_),e=>t(_,e)),d(M,()=>a(p),e=>t(p,e)),d(Q,()=>a(y),e=>t(y,e)),d(R,()=>a(z),e=>t(z,e)),d(V,()=>a(x),e=>t(x,e)),d(X,()=>a(g),e=>t(g,e)),d(Z,()=>a(m),e=>t(m,e)),pe(U,()=>a(h),e=>t(h,e)),S(le,w),ye()}me(["click"]);export{qe as T};
