# Windsurf AI Rules - Revolution Trading Pros v4

## Apple Principal Engineer ICT Level 7 | Feb 2026

# üö® ZERO ERRORS TOLERANCE

Every change MUST result in 0 errors, 0 warnings, 0 regressions.

## üì¶ STACK

* SvelteKit 2.x + Svelte 5.x
* Tailwind CSS v4.x
* Rust/Axum 0.7 + PostgreSQL

## üìñ REQUIRED CONTEXT REVIEW (IF FILES EXIST)

Before changes, read:

* `RULES-VERIFICATION.md`
* `RULES-SVELTE5.md`
* `RULES-TAILWIND-RESPONSIVE.md`
* `RULES-SSR-HYDRATION-SEO.md`
* `RULES-BACKEND.md`
* `RULES-REMOTE-FUNCTIONS.md` (MANDATORY)

## üéØ BEFORE ANY CHANGE

1. Read complete target file(s), no blind partial edits.
2. Trace imports/exports and call graph.
3. Map blast radius (all affected files/routes/components).
4. Run baseline validation:

   * `npm run check`
5. Choose data boundary:

   * Internal app flow => Remote Functions
   * External/public/webhook => `+server.ts`

## ‚ö° SVELTE 5 ONLY (MANDATORY)

Use:

```svelte
let count = $state(0);
let doubled = $derived(count * 2);
let { title, onClose }: Props = $props();
$effect(() => { /* side effect */ });
{@render children?.()}
<button onclick={handler}>Click</button>
```

## ‚ùå BANNED (SVELTE 4 PATTERNS)

* `export let` (use `$props`)
* `$:` reactive statements (use `$derived` / `$effect`)
* `<slot />` (use `{@render}`)
* `on:click` (use `onclick`)
* `createEventDispatcher` (use callback props)

## ‚ö° REMOTE FUNCTIONS POLICY (DEFAULT FOR INTERNAL FLOWS)

* `query` => read operations
* `query.batch` => batched reads/list hydration
* `form` => validated form submissions
* `command` => mutations/actions

Rules:

* Validate all input at server boundary
* Enforce authN/authZ for privileged actions
* Keep typed request/response contracts
* Use consistent domain error shapes
* Do not duplicate business logic across remote/API layers

## üåê API POLICY (`+server.ts`)

Use endpoints only when:

* Third parties consume the API
* Webhook receiver is required
* Raw HTTP semantics or explicit versioned contracts are required

## üîí SECURITY GUARDRAILS

* Never expose secrets in client bundle
* No direct DB access from client code
* Validate/sanitize all external input
* Rate-limit sensitive mutation surfaces
* Log security-relevant failures with request IDs
* Patch known ecosystem advisories promptly

## üß™ TESTING STANDARD

For every behavior change, include:

* Unit tests (logic + validation)
* Auth allow/deny tests
* Integration tests at remote/API boundary
* Regression tests for touched route/component

## ‚úÖ AFTER EVERY CHANGE (HARD GATE)

Run all:

```bash
npm run check
npm run lint
npm run build
npm run test
```

All must pass before completion.

## ENFORCEMENT MODE: HARD GATE

A task is NOT complete unless all 4 commands pass.

Required completion output:

1. Changed files list with reason per file
2. Verification evidence summary for:

   * `npm run check`
   * `npm run lint`
   * `npm run build`
   * `npm run test`
3. Regression risk assessment
4. Boundary decision note (Remote Functions vs `+server.ts`)
5. Final status: `COMPLETE` or `INCOMPLETE`

If any gate fails:

* Status MUST be `INCOMPLETE`
* Continue remediation until green

## 2026 PLATFORM NOTES (VERIFIED)

1. Remote Functions are official in SvelteKit (available since 2.27).
2. Track and patch Svelte/SvelteKit ecosystem security advisories promptly.
3. SvelteKit SEO requires explicit sitemap strategy.
4. Use official migration tooling/docs for Svelte 5 + SvelteKit upgrades.

## SEO + REMOTE + SECURITY CHANGE CHECKLIST

* [ ] Svelte 5 runes syntax only
* [ ] Correct server boundary chosen (Remote vs API)
* [ ] Input validated on server boundary
* [ ] Auth enforced for sensitive operations
* [ ] No duplicate SEO head ownership
* [ ] Sitemap strategy updated for new indexable routes
* [ ] check/lint/build/test all green
* [ ] Changed files + verification evidence included

## üö® MANTRA

"Zero errors. Trace dependencies. Use the right server boundary. Verify with evidence."
